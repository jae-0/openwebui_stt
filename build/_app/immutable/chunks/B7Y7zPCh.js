var lr=Object.defineProperty;var sr=(n,e,t)=>e in n?lr(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var pt=(n,e,t)=>sr(n,typeof e!="symbol"?e+"":e,t);import{s as Te,e as M,k as j,c as E,a as w,d as g,o as A,f as h,i as V,g as p,n as ve,t as W,b as q,S as Ue,B as rt,u as ue,h as Z,P as qe,H as Qe,j as Ee,p as Fe,F as gt,q as bt,y as Ae,A as Ze,r as nr,v as rr,w as ir,x as or,D as ke,E as we,l as ce,R as St,C as Ne,M as ar,an as ul,V as Ot,O as Tt,T as fr,U as ur}from"./vexCXLX9.js";import{S as Le,i as Pe,b as $,d as x,m as ee,t as b,a as D,e as te,f as Ke,g as ne,c as re,j as Bt}from"./Cdll-xsj.js";import{e as De,u as Gt,o as In,d as cr}from"./DNXpXRYa.js";import{m as jt,d as cl,i as Mn,h as dr,G as hr,H as mr,a as At,c as En,T as dl,u as zt,l as Zt,e as Lt,W as gr,b as hl,z as ml,C as _r}from"./BukaNoIw.js";import{t as je}from"./DMk2eJ1b.js";import{f as pr,u as vr,i as br}from"./B-5IdZ8W.js";import{d as Jt,n as Nn,x as kr,h as vt,t as Pt,l as Dn,v as gl}from"./Czj-sgwA.js";import{d as it}from"./aTHIJebK.js";import{u as _l,c as wr}from"./Qas6dQh7.js";import{b as yr}from"./CDcqp4_E.js";import{s as Ir}from"./Bv32LYOs.js";import{i as Mr,E as Er}from"./C9ixBG4r.js";import{P as Vn,N as Kt}from"./3MBy-zZd.js";import{ae as Cn,ah as Nr,af as yt,ai as Dr,ag as Tn,aj as Vr}from"./B82-hoyY.js";import{T as Be}from"./DzHlmjPS.js";import{T as Cr}from"./BPFKsglW.js";import{S as Ut}from"./Cmi_MrK3.js";import{C as Bn}from"./Cux5bsOp.js";import{C as Rn}from"./D8_ibWhm.js";import{M as Tr}from"./BoacWIEu.js";import{C as Sn}from"./CzvQehHf.js";import{I as Br}from"./E_9Yx2fg.js";import{M as On}from"./r_-JQrIr.js";import{B as Qt}from"./B2_kFBW1.js";import{C as Rr}from"./BfKRbBRz.js";import{X as Sr}from"./4edIpoVY.js";import{E as Or}from"./BbEqRSGc.js";import{m as Ht}from"./_0_gBwjO.js";import{c as pl}from"./CP0bUBgf.js";import{F as Lr}from"./B-ayMCb0.js";import{L as Pr}from"./Ql21FIhE.js";import{f as Rt}from"./DOlMLN9E.js";import{F as Hr}from"./CU2r43ac.js";function jr(n){return new Worker(""+new URL("../workers/kokoro.worker-Cev3ZHQt.js",import.meta.url).href,{type:"module",name:n==null?void 0:n.name})}class Ar{constructor(e="fp32"){pt(this,"worker",null);pt(this,"initialized",!1);pt(this,"dtype");pt(this,"requestQueue",[]);pt(this,"processing",!1);this.dtype=e}async init(){if(this.worker){console.warn("KokoroWorker is already initialized.");return}return this.worker=new jr,this.worker.onmessage=e=>{const{status:t,error:l,audioUrl:s}=e.data;if(t==="init:complete")this.initialized=!0;else if(t==="init:error")console.error(l),this.initialized=!1;else if(t==="generate:complete"){const r=this.requestQueue.shift();r&&(r.resolve(s),this.processNextRequest())}else if(t==="generate:error"){const r=this.requestQueue.shift();r&&(r.reject(new Error(l)),this.processNextRequest())}},new Promise((e,t)=>{this.worker.postMessage({type:"init",payload:{dtype:this.dtype}});const l=s=>{s.data.status==="init:complete"?(this.worker.removeEventListener("message",l),this.initialized=!0,e()):s.data.status==="init:error"&&(this.worker.removeEventListener("message",l),t(new Error(s.data.error)))};this.worker.addEventListener("message",l)})}async generate({text:e,voice:t}){if(!this.initialized||!this.worker)throw new Error("KokoroTTS Worker is not initialized yet.");return new Promise((l,s)=>{this.requestQueue.push({text:e,voice:t,resolve:l,reject:s}),this.processing||this.processNextRequest()})}processNextRequest(){if(this.requestQueue.length===0){this.processing=!1;return}this.processing=!0;const{text:e,voice:t}=this.requestQueue[0];this.worker.postMessage({type:"generate",payload:{text:e,voice:t}})}terminate(){this.worker&&(this.worker.terminate(),this.worker=null,this.initialized=!1,this.requestQueue=[],this.processing=!1)}}function zr(n){let e,t,l,s,r,i,o,a,f,u,c,m,d,_,k,v,N,y,T,P,R,I,B,S,L,C;return{c(){e=M("div"),t=M("div"),l=M("div"),s=M("div"),i=j(),o=M("div"),a=M("div"),u=j(),c=M("div"),d=j(),_=M("div"),k=M("div"),N=j(),y=M("div"),P=j(),R=M("div"),B=j(),S=M("div"),this.h()},l(O){e=E(O,"DIV",{class:!0});var z=w(e);t=E(z,"DIV",{class:!0});var le=w(t);l=E(le,"DIV",{class:!0});var me=w(l);s=E(me,"DIV",{class:!0}),w(s).forEach(g),i=A(me),o=E(me,"DIV",{class:!0});var ie=w(o);a=E(ie,"DIV",{class:!0}),w(a).forEach(g),u=A(ie),c=E(ie,"DIV",{class:!0}),w(c).forEach(g),ie.forEach(g),d=A(me),_=E(me,"DIV",{class:!0});var se=w(_);k=E(se,"DIV",{class:!0}),w(k).forEach(g),N=A(se),y=E(se,"DIV",{class:!0}),w(y).forEach(g),P=A(se),R=E(se,"DIV",{class:!0}),w(R).forEach(g),se.forEach(g),B=A(me),S=E(me,"DIV",{class:!0}),w(S).forEach(g),me.forEach(g),le.forEach(g),z.forEach(g),this.h()},h(){h(s,"class",r=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14"),h(a,"class",f=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(c,"class",m=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(o,"class","grid grid-cols-3 gap-4"),h(k,"class",v=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1"),h(y,"class",T=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2"),h(R,"class",I=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4"),h(_,"class","grid grid-cols-4 gap-4"),h(S,"class",L=(n[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm"),h(l,"class",C=(n[0]==="md"?"space-y-2":"space-y-1.5")+" w-full"),h(t,"class","animate-pulse flex w-full"),h(e,"class","w-full mt-2 mb-2")},m(O,z){V(O,e,z),p(e,t),p(t,l),p(l,s),p(l,i),p(l,o),p(o,a),p(o,u),p(o,c),p(l,d),p(l,_),p(_,k),p(_,N),p(_,y),p(_,P),p(_,R),p(l,B),p(l,S)},p(O,[z]){z&1&&r!==(r=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm mr-14")&&h(s,"class",r),z&1&&f!==(f=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(a,"class",f),z&1&&m!==(m=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(c,"class",m),z&1&&v!==(v=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1")&&h(k,"class",v),z&1&&T!==(T=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-2")&&h(y,"class",T),z&1&&I!==(I=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm col-span-1 mr-4")&&h(R,"class",I),z&1&&L!==(L=(O[0]==="md"?"h-2":"h-1.5")+" bg-gray-200 dark:bg-gray-600 rounded-sm")&&h(S,"class",L),z&1&&C!==(C=(O[0]==="md"?"space-y-2":"space-y-1.5")+" w-full")&&h(l,"class",C)},i:ve,o:ve,d(O){O&&g(e)}}}function Ur(n,e,t){let{size:l="md"}=e;return n.$$set=s=>{"size"in s&&t(0,l=s.size)},[l]}class Yt extends Le{constructor(e){super(),Pe(this,e,Ur,zr,Te,{size:0})}}function vl(n,e,t){const l=n.slice();return l[23]=e[t],l}function bl(n,e,t){const l=n.slice();return l[26]=e[t],l}function kl(n){var s;let e,t=n[8].t('This response was generated by "{{model}}"',{model:n[7]?((s=n[7])==null?void 0:s.name)??n[7].id:n[1].selectedModelId})+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=w(e);l=q(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-xs font-medium pt-1.5 -mb-0.5")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i&386&&t!==(t=r[8].t('This response was generated by "{{model}}"',{model:r[7]?((o=r[7])==null?void 0:o.name)??r[7].id:r[1].selectedModelId})+"")&&Z(l,t)},d(r){r&&g(e)}}}function wl(n){let e,t=n[26]+"",l,s,r,i,o,a;function f(){return n[12](n[26])}return{c(){e=M("button"),l=W(t),s=j(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var c=w(e);l=q(c,t),s=A(c),c.forEach(g),this.h()},h(){var u,c;h(e,"class",r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900"),e.disabled=i=((c=(u=n[1])==null?void 0:u.annotation)==null?void 0:c.rating)===-1?n[26]>5:n[26]<6},m(u,c){V(u,e,c),p(e,l),p(e,s),o||(a=ue(e,"click",f),o=!0)},p(u,c){var m,d;n=u,c&64&&r!==(r="size-7 text-sm border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[6]===n[26]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-full disabled:cursor-not-allowed disabled:text-gray-500 disabled:bg-white dark:disabled:bg-gray-900")&&h(e,"class",r),c&2&&i!==(i=((d=(m=n[1])==null?void 0:m.annotation)==null?void 0:d.rating)===-1?n[26]>5:n[26]<6)&&(e.disabled=i)},d(u){u&&g(e),o=!1,a()}}}function yl(n){let e,t=n[8].t("Why?")+"",l,s,r,i=De(n[3]),o=[];for(let a=0;a<i.length;a+=1)o[a]=Il(vl(n,i,a));return{c(){e=M("div"),l=W(t),s=j(),r=M("div");for(let a=0;a<o.length;a+=1)o[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(g),s=A(a),r=E(a,"DIV",{class:!0});var u=w(r);for(let c=0;c<o.length;c+=1)o[c].l(u);u.forEach(g),this.h()},h(){h(e,"class","text-sm mt-1.5 font-medium"),h(r,"class","flex flex-wrap gap-1.5 text-sm mt-1.5")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(r,null)},p(a,f){if(f&256&&t!==(t=a[8].t("Why?")+"")&&Z(l,t),f&280){i=De(a[3]);let u;for(u=0;u<i.length;u+=1){const c=vl(a,i,u);o[u]?o[u].p(c,f):(o[u]=Il(c),o[u].c(),o[u].m(r,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(a){a&&(g(e),g(s),g(r)),qe(o,a)}}}function Wr(n){let e=n[23]+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&8&&e!==(e=l[23]+"")&&Z(t,e)},d(l){l&&g(t)}}}function qr(n){let e=n[8].t("Other")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Other")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Fr(n){let e=n[8].t("Being lazy")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Being lazy")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Jr(n){let e=n[8].t("Refused when it shouldn't have")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Refused when it shouldn't have")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Gr(n){let e=n[8].t("Didn't fully follow instructions")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Didn't fully follow instructions")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Zr(n){let e=n[8].t("Not factually correct")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not factually correct")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Kr(n){let e=n[8].t("Not helpful")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Not helpful")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Qr(n){let e=n[8].t("Too verbose")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Too verbose")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Yr(n){let e=n[8].t("Don't like the style")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Don't like the style")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Xr(n){let e=n[8].t("Thorough explanation")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Thorough explanation")+"")&&Z(t,e)},d(l){l&&g(t)}}}function $r(n){let e=n[8].t("Attention to detail")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Attention to detail")+"")&&Z(t,e)},d(l){l&&g(t)}}}function xr(n){let e=n[8].t("Positive attitude")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Positive attitude")+"")&&Z(t,e)},d(l){l&&g(t)}}}function ei(n){let e=n[8].t("Showcased creativity")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Showcased creativity")+"")&&Z(t,e)},d(l){l&&g(t)}}}function ti(n){let e=n[8].t("Followed instructions perfectly")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Followed instructions perfectly")+"")&&Z(t,e)},d(l){l&&g(t)}}}function li(n){let e=n[8].t("Accurate information")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&256&&e!==(e=l[8].t("Accurate information")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Il(n){let e,t,l,s,r;function i(u,c){return u[23]==="accurate_information"?li:u[23]==="followed_instructions_perfectly"?ti:u[23]==="showcased_creativity"?ei:u[23]==="positive_attitude"?xr:u[23]==="attention_to_detail"?$r:u[23]==="thorough_explanation"?Xr:u[23]==="dont_like_the_style"?Yr:u[23]==="too_verbose"?Qr:u[23]==="not_helpful"?Kr:u[23]==="not_factually_correct"?Zr:u[23]==="didnt_fully_follow_instructions"?Gr:u[23]==="refused_when_it_shouldnt_have"?Jr:u[23]==="being_lazy"?Fr:u[23]==="other"?qr:Wr}let o=i(n),a=o(n);function f(){return n[13](n[23])}return{c(){e=M("button"),a.c(),t=j(),this.h()},l(u){e=E(u,"BUTTON",{class:!0});var c=w(e);a.l(c),t=A(c),c.forEach(g),this.h()},h(){h(e,"class",l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")},m(u,c){V(u,e,c),a.m(e,null),p(e,t),s||(r=ue(e,"click",f),s=!0)},p(u,c){n=u,o===(o=i(n))&&a?a.p(n,c):(a.d(1),a=o(n),a&&(a.c(),a.m(e,t))),c&24&&l!==(l="px-3 py-0.5 border border-gray-100 dark:border-gray-850 hover:bg-gray-50 dark:hover:bg-gray-850 "+(n[4]===n[23]?"bg-gray-100 dark:bg-gray-800":"")+" transition rounded-xl")&&h(e,"class",l)},d(u){u&&g(e),a.d(),s=!1,r()}}}function si(n){var Y;let e,t,l,s,r=n[8].t("How would you rate this response?")+"",i,o,a,f='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path></svg>',u,c,m,d,_,k,v,N,y=n[8].t("Awful")+"",T,P,R,I,B=n[8].t("Amazing")+"",S,L,C,O,z,le,me,ie,se,_e,ge,Ie,Q,J=n[8].t("Save")+"",oe,ye,U,fe,de,he=((Y=n[1])==null?void 0:Y.arena)&&kl(n),be=De(Array.from({length:10}).map(Ml)),H=[];for(let G=0;G<be.length;G+=1)H[G]=wl(bl(n,be,G));let K=n[3].length>0&&yl(n);return ge=new Cr({props:{tags:n[2]}}),ge.$on("delete",n[15]),ge.$on("add",n[16]),{c(){he&&he.c(),e=j(),t=M("div"),l=M("div"),s=M("div"),i=W(r),o=j(),a=M("button"),a.innerHTML=f,u=j(),c=M("div"),m=M("div"),d=M("div");for(let G=0;G<H.length;G+=1)H[G].c();_=j(),k=M("div"),v=M("div"),N=W("1 - "),T=W(y),P=j(),R=M("div"),I=W("10 - "),S=W(B),L=j(),C=M("div"),K&&K.c(),O=j(),z=M("div"),le=M("textarea"),ie=j(),se=M("div"),_e=M("div"),$(ge.$$.fragment),Ie=j(),Q=M("button"),oe=W(J),this.h()},l(G){he&&he.l(G),e=A(G),t=E(G,"DIV",{class:!0,id:!0});var ae=w(t);l=E(ae,"DIV",{class:!0});var pe=w(l);s=E(pe,"DIV",{class:!0});var Ce=w(s);i=q(Ce,r),Ce.forEach(g),o=A(pe),a=E(pe,"BUTTON",{"data-svelte-h":!0}),Ue(a)!=="svelte-1ew22ui"&&(a.innerHTML=f),pe.forEach(g),u=A(ae),c=E(ae,"DIV",{class:!0});var X=w(c);m=E(X,"DIV",{class:!0});var Se=w(m);d=E(Se,"DIV",{class:!0});var He=w(d);for(let st=0;st<H.length;st+=1)H[st].l(He);He.forEach(g),_=A(Se),k=E(Se,"DIV",{class:!0});var ze=w(k);v=E(ze,"DIV",{});var Ye=w(v);N=q(Ye,"1 - "),T=q(Ye,y),Ye.forEach(g),P=A(ze),R=E(ze,"DIV",{});var lt=w(R);I=q(lt,"10 - "),S=q(lt,B),lt.forEach(g),ze.forEach(g),Se.forEach(g),X.forEach(g),L=A(ae),C=E(ae,"DIV",{});var ot=w(C);K&&K.l(ot),ot.forEach(g),O=A(ae),z=E(ae,"DIV",{class:!0});var at=w(z);le=E(at,"TEXTAREA",{class:!0,placeholder:!0,rows:!0}),w(le).forEach(g),at.forEach(g),ie=A(ae),se=E(ae,"DIV",{class:!0});var tt=w(se);_e=E(tt,"DIV",{class:!0});var ft=w(_e);x(ge.$$.fragment,ft),ft.forEach(g),Ie=A(tt),Q=E(tt,"BUTTON",{class:!0});var ut=w(Q);oe=q(ut,J),ut.forEach(g),tt.forEach(g),ae.forEach(g),this.h()},h(){h(s,"class","text-sm font-medium"),h(l,"class","flex justify-between items-center"),h(d,"class","mt-1.5 w-fit flex gap-1 pb-5"),h(k,"class","absolute bottom-0 left-0 right-0 flex justify-between text-xs"),h(m,"class","relative w-fit"),h(c,"class","w-full flex justify-center"),h(le,"class","w-full text-sm px-1 py-2 bg-transparent outline-hidden resize-none rounded-xl"),h(le,"placeholder",me=n[8].t("Feel free to add specific details")),h(le,"rows","3"),h(z,"class","mt-2"),h(_e,"class","flex items-end group"),h(Q,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(se,"class","mt-2 gap-1.5 flex justify-between"),h(t,"class","my-2.5 rounded-xl px-4 py-3 border border-gray-100 dark:border-gray-850"),h(t,"id",ye="message-feedback-"+n[1].id)},m(G,ae){he&&he.m(G,ae),V(G,e,ae),V(G,t,ae),p(t,l),p(l,s),p(s,i),p(l,o),p(l,a),p(t,u),p(t,c),p(c,m),p(m,d);for(let pe=0;pe<H.length;pe+=1)H[pe]&&H[pe].m(d,null);p(m,_),p(m,k),p(k,v),p(v,N),p(v,T),p(k,P),p(k,R),p(R,I),p(R,S),p(t,L),p(t,C),K&&K.m(C,null),p(t,O),p(t,z),p(z,le),rt(le,n[5]),p(t,ie),p(t,se),p(se,_e),ee(ge,_e,null),p(se,Ie),p(se,Q),p(Q,oe),U=!0,fe||(de=[ue(a,"click",n[11]),ue(le,"input",n[14]),ue(Q,"click",n[17])],fe=!0)},p(G,[ae]){var Ce;if((Ce=G[1])!=null&&Ce.arena?he?he.p(G,ae):(he=kl(G),he.c(),he.m(e.parentNode,e)):he&&(he.d(1),he=null),(!U||ae&256)&&r!==(r=G[8].t("How would you rate this response?")+"")&&Z(i,r),ae&66){be=De(Array.from({length:10}).map(Ml));let X;for(X=0;X<be.length;X+=1){const Se=bl(G,be,X);H[X]?H[X].p(Se,ae):(H[X]=wl(Se),H[X].c(),H[X].m(d,null))}for(;X<H.length;X+=1)H[X].d(1);H.length=be.length}(!U||ae&256)&&y!==(y=G[8].t("Awful")+"")&&Z(T,y),(!U||ae&256)&&B!==(B=G[8].t("Amazing")+"")&&Z(S,B),G[3].length>0?K?K.p(G,ae):(K=yl(G),K.c(),K.m(C,null)):K&&(K.d(1),K=null),(!U||ae&256&&me!==(me=G[8].t("Feel free to add specific details")))&&h(le,"placeholder",me),ae&32&&rt(le,G[5]);const pe={};ae&4&&(pe.tags=G[2]),ge.$set(pe),(!U||ae&256)&&J!==(J=G[8].t("Save")+"")&&Z(oe,J),(!U||ae&2&&ye!==(ye="message-feedback-"+G[1].id))&&h(t,"id",ye)},i(G){U||(b(ge.$$.fragment,G),U=!0)},o(G){D(ge.$$.fragment,G),U=!1},d(G){G&&(g(e),g(t)),he&&he.d(G),qe(H,G),K&&K.d(),te(ge),fe=!1,Qe(de)}}}const Ml=(n,e)=>e+1;function ni(n,e,t){let l,s;Ee(n,jt,C=>t(18,s=C));const r=Fe("i18n");Ee(n,r,C=>t(8,l=C));const i=gt();let{message:o}=e,{show:a=!1}=e,f=["accurate_information","followed_instructions_perfectly","showcased_creativity","positive_attitude","attention_to_detail","thorough_explanation","other"],u=["dont_like_the_style","too_verbose","not_helpful","not_factually_correct","didnt_fully_follow_instructions","refused_when_it_shouldnt_have","being_lazy","other"],c=[],m=[],d=null,_="",k=null,v=null;const N=()=>{var C,O,z,le,me;d||t(4,d=((C=o==null?void 0:o.annotation)==null?void 0:C.reason)??""),_||t(5,_=((O=o==null?void 0:o.annotation)==null?void 0:O.comment)??""),t(2,c=(((z=o==null?void 0:o.annotation)==null?void 0:z.tags)??[]).map(ie=>({name:ie}))),k||t(6,k=((me=(le=o==null?void 0:o.annotation)==null?void 0:le.details)==null?void 0:me.rating)??null)};bt(()=>{o!=null&&o.arena&&(t(7,v=s.find(C=>C.id===o.selectedModelId)),je.success(l.t('This response was generated by "{{model}}"',{model:v?(v==null?void 0:v.name)??v.id:o.selectedModelId})))});const y=()=>{console.log("saveHandler"),i("save",{reason:d,comment:_,tags:c.map(C=>C.name),details:{rating:k}}),je.success(l.t("Thanks for your feedback!")),t(0,a=!1)},T=()=>{t(0,a=!1)},P=C=>{t(6,k=C)},R=C=>{t(4,d=C)};function I(){_=this.value,t(5,_)}const B=C=>{t(2,c=c.filter(O=>O.name.replaceAll(" ","_").toLowerCase()!==C.detail.replaceAll(" ","_").toLowerCase()))},S=C=>{t(2,c=[...c,{name:C.detail}])},L=()=>{y()};return n.$$set=C=>{"message"in C&&t(1,o=C.message),"show"in C&&t(0,a=C.show)},n.$$.update=()=>{var C,O;n.$$.dirty&2&&(((C=o==null?void 0:o.annotation)==null?void 0:C.rating)===1?t(3,m=f):((O=o==null?void 0:o.annotation)==null?void 0:O.rating)===-1&&t(3,m=u)),n.$$.dirty&2&&o&&N()},[a,o,c,m,d,_,k,v,l,r,y,T,P,R,I,B,S,L]}class ri extends Le{constructor(e){super(),Pe(this,e,ni,si,Te,{message:1,show:0})}}function El(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function ii(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function oi(n){let e,t;return e=new Rn({props:{strokeWidth:"3.5",className:"size-3.5 "}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ai(n){let e,t,l,s,r;const i=n[2].default,o=nr(i,n,n[4],null),a=[oi,ii],f=[];function u(c,m){return c[1]?0:1}return l=u(n),s=f[l]=a[l](n),{c(){e=M("div"),o&&o.c(),t=j(),s.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);o&&o.l(m),t=A(m),s.l(m),m.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition")},m(c,m){V(c,e,m),o&&o.m(e,null),p(e,t),f[l].m(e,null),r=!0},p(c,m){o&&o.p&&(!r||m&16)&&rr(o,i,c,c[4],r?or(i,c[4],m,null):ir(c[4]),null);let d=l;l=u(c),l!==d&&(ne(),D(f[d],1,1,()=>{f[d]=null}),re(),s=f[l],s||(s=f[l]=a[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(o,c),b(s),r=!0)},o(c){D(o,c),D(s),r=!1},d(c){c&&g(e),o&&o.d(c),f[l].d()}}}function Nl(n){let e,t,l,s,r,i=n[0].query+"",o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',c,m;return l=new Tr({}),{c(){e=M("a"),t=M("div"),$(l.$$.fragment),s=j(),r=M("div"),o=W(i),a=j(),f=M("div"),f.innerHTML=u,this.h()},l(d){e=E(d,"A",{href:!0,target:!0,class:!0});var _=w(e);t=E(_,"DIV",{class:!0});var k=w(t);x(l.$$.fragment,k),s=A(k),r=E(k,"DIV",{class:!0});var v=w(r);o=q(v,i),v.forEach(g),k.forEach(g),a=A(_),f=E(_,"DIV",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-14xjows"&&(f.innerHTML=u),_.forEach(g),this.h()},h(){h(r,"class","line-clamp-1"),h(t,"class","flex gap-2 items-center"),h(f,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",c="https://www.google.com/search?q="+n[0].query),h(e,"target","_blank"),h(e,"class","flex w-full items-center p-3 px-4 border-b border-gray-300/30 dark:border-gray-700/50 group/item justify-between font-normal text-gray-800 dark:text-gray-300 no-underline")},m(d,_){V(d,e,_),p(e,t),ee(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),m=!0},p(d,_){(!m||_&1)&&i!==(i=d[0].query+"")&&Z(o,i),(!m||_&1&&c!==(c="https://www.google.com/search?q="+d[0].query))&&h(e,"href",c)},i(d){m||(b(l.$$.fragment,d),m=!0)},o(d){D(l.$$.fragment,d),m=!1},d(d){d&&g(e),te(l)}}}function Dl(n){let e,t,l=n[5]+"",s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor" class="size-4"><path fill-rule="evenodd" d="M4.22 11.78a.75.75 0 0 1 0-1.06L9.44 5.5H5.75a.75.75 0 0 1 0-1.5h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V6.56l-5.22 5.22a.75.75 0 0 1-1.06 0Z" clip-rule="evenodd"></path></svg>',a,f,u;return{c(){e=M("a"),t=M("div"),s=W(l),r=j(),i=M("div"),i.innerHTML=o,a=j(),this.h()},l(c){e=E(c,"A",{href:!0,target:!0,class:!0});var m=w(e);t=E(m,"DIV",{class:!0});var d=w(t);s=q(d,l),d.forEach(g),r=A(m),i=E(m,"DIV",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-14xjows"&&(i.innerHTML=o),a=A(m),m.forEach(g),this.h()},h(){h(t,"class","line-clamp-1"),h(i,"class","ml-1 text-white dark:text-gray-900 group-hover/item:text-gray-600 dark:group-hover/item:text-white transition"),h(e,"href",f=n[5]),h(e,"target","_blank"),h(e,"class",u="flex w-full items-center p-3 px-4 "+(n[7]===n[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(e,a)},p(c,m){m&1&&l!==(l=c[5]+"")&&Z(s,l),m&1&&f!==(f=c[5])&&h(e,"href",f),m&1&&u!==(u="flex w-full items-center p-3 px-4 "+(c[7]===c[0].urls.length-1?"":"border-b border-gray-300/30 dark:border-gray-700/50")+" group/item justify-between font-normal text-gray-800 dark:text-gray-300")&&h(e,"class",u)},d(c){c&&g(e)}}}function fi(n){var o;let e,t,l,s=((o=n[0])==null?void 0:o.query)&&Nl(n),r=De(n[0].urls),i=[];for(let a=0;a<r.length;a+=1)i[a]=Dl(El(n,r,a));return{c(){e=M("div"),s&&s.c(),t=j();for(let a=0;a<i.length;a+=1)i[a].c();this.h()},l(a){e=E(a,"DIV",{class:!0,slot:!0});var f=w(e);s&&s.l(f),t=A(f);for(let u=0;u<i.length;u+=1)i[u].l(f);f.forEach(g),this.h()},h(){h(e,"class","text-sm border border-gray-300/30 dark:border-gray-700/50 rounded-xl mb-1.5"),h(e,"slot","content")},m(a,f){V(a,e,f),s&&s.m(e,null),p(e,t);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(e,null);l=!0},p(a,f){var u;if((u=a[0])!=null&&u.query?s?(s.p(a,f),f&1&&b(s,1)):(s=Nl(a),s.c(),b(s,1),s.m(e,t)):s&&(ne(),D(s,1,1,()=>{s=null}),re()),f&1){r=De(a[0].urls);let c;for(c=0;c<r.length;c+=1){const m=El(a,r,c);i[c]?i[c].p(m,f):(i[c]=Dl(m),i[c].c(),i[c].m(e,null))}for(;c<i.length;c+=1)i[c].d(1);i.length=r.length}},i(a){l||(b(s),l=!0)},o(a){D(s),l=!1},d(a){a&&g(e),s&&s.d(),qe(i,a)}}}function ui(n){let e,t,l;function s(i){n[3](i)}let r={className:"w-full space-y-1",$$slots:{content:[fi],default:[ai]},$$scope:{ctx:n}};return n[1]!==void 0&&(r.open=n[1]),e=new Cn({props:r}),Ae.push(()=>Ke(e,"open",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&19&&(a.$$scope={dirty:o,ctx:i}),!t&&o&2&&(t=!0,a.open=i[1],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function ci(n,e,t){let{$$slots:l={},$$scope:s}=e,{status:r={urls:[],query:""}}=e,i=!1;function o(a){i=a,t(1,i)}return n.$$set=a=>{"status"in a&&t(0,r=a.status),"$$scope"in a&&t(4,s=a.$$scope)},[r,i,l,o,s]}class di extends Le{constructor(e){super(),Pe(this,e,ci,ui,Te,{status:0})}}function hi(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function mi(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class gi extends Le{constructor(e){super(),Pe(this,e,mi,hi,Te,{className:0,strokeWidth:1})}}function _i(n){let e,t,l,s,r,i=(typeof n[0]=="string"?n[0]:JSON.stringify(n[0]))+"",o,a;return l=new Br({props:{className:"size-5 text-red-700 dark:text-red-400"}}),{c(){e=M("div"),t=M("div"),$(l.$$.fragment),s=j(),r=M("div"),o=W(i),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);t=E(u,"DIV",{class:!0});var c=w(t);x(l.$$.fragment,c),c.forEach(g),s=A(u),r=E(u,"DIV",{class:!0});var m=w(r);o=q(m,i),m.forEach(g),u.forEach(g),this.h()},h(){h(t,"class","self-start mt-0.5"),h(r,"class","self-center text-sm"),h(e,"class","flex my-2 gap-2.5 border px-4 py-3 border-red-600/10 bg-red-600/10 rounded-lg")},m(f,u){V(f,e,u),p(e,t),ee(l,t,null),p(e,s),p(e,r),p(r,o),a=!0},p(f,[u]){(!a||u&1)&&i!==(i=(typeof f[0]=="string"?f[0]:JSON.stringify(f[0]))+"")&&Z(o,i)},i(f){a||(b(l.$$.fragment,f),a=!0)},o(f){D(l.$$.fragment,f),a=!1},d(f){f&&g(e),te(l)}}}function pi(n,e,t){let{content:l=""}=e;return n.$$set=s=>{"content"in s&&t(0,l=s.content)},[l]}let vi=class extends Le{constructor(e){super(),Pe(this,e,pi,_i,Te,{content:0})}};function Vl(n,e,t){const l=n.slice();return l[9]=e[t],l[11]=t,l}function bi(n){const e=n.slice(),t=Bi(e[9].distance);return e[12]=t,e}function ki(n){let e,t=n[4].t("No source available")+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No source available")+"")&&Z(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function wi(n){let e,t,l,s;e=new Be({props:{className:"w-fit",content:n[4].t("Open file"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[yi]},$$scope:{ctx:n}}});let r=n[2]&&Tl(n);return{c(){$(e.$$.fragment),t=j(),r&&r.c(),l=ce()},l(i){x(e.$$.fragment,i),t=A(i),r&&r.l(i),l=ce()},m(i,o){ee(e,i,o),V(i,t,o),r&&r.m(i,o),V(i,l,o),s=!0},p(i,o){const a={};o&16&&(a.content=i[4].t("Open file")),o&8216&&(a.$$scope={dirty:o,ctx:i}),e.$set(a),i[2]?r?(r.p(i,o),o&4&&b(r,1)):(r=Tl(i),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(ne(),D(r,1,1,()=>{r=null}),re())},i(i){s||(b(e.$$.fragment,i),b(r),s=!0)},o(i){D(e.$$.fragment,i),D(r),s=!1},d(i){i&&(g(t),g(l)),te(e,i),r&&r.d(i)}}}function Cl(n){let e,t,l=n[4].t("page")+"",s,r,i=n[9].metadata.page+1+"",o,a;return{c(){e=M("span"),t=W("("),s=W(l),r=j(),o=W(i),a=W(")"),this.h()},l(f){e=E(f,"SPAN",{class:!0});var u=w(e);t=q(u,"("),s=q(u,l),r=A(u),o=q(u,i),a=q(u,")"),u.forEach(g),this.h()},h(){h(e,"class","text-xs text-gray-500 dark:text-gray-400")},m(f,u){V(f,e,u),p(e,t),p(e,s),p(e,r),p(e,o),p(e,a)},p(f,u){u&16&&l!==(l=f[4].t("page")+"")&&Z(s,l),u&8&&i!==(i=f[9].metadata.page+1+"")&&Z(o,i)},d(f){f&&g(e)}}}function yi(n){var a,f,u,c;let e,t,l=decodeURIComponent(((f=(a=n[9])==null?void 0:a.metadata)==null?void 0:f.name)??n[9].source.name)+"",s,r,i,o=((c=(u=n[9])==null?void 0:u.metadata)==null?void 0:c.page)&&Cl(n);return{c(){e=M("div"),t=M("a"),s=W(l),i=j(),o&&o.c(),this.h()},l(m){e=E(m,"DIV",{class:!0});var d=w(e);t=E(d,"A",{class:!0,href:!0,target:!0});var _=w(t);s=q(_,l),_.forEach(g),i=A(d),o&&o.l(d),d.forEach(g),this.h()},h(){var m,d,_,k,v,N,y,T;h(t,"class","hover:text-gray-500 dark:hover:text-gray-100 underline grow"),h(t,"href",r=(d=(m=n[9])==null?void 0:m.metadata)!=null&&d.file_id?`${cl}/files/${(k=(_=n[9])==null?void 0:_.metadata)==null?void 0:k.file_id}/content${((N=(v=n[9])==null?void 0:v.metadata)==null?void 0:N.page)!==void 0?`#page=${n[9].metadata.page+1}`:""}`:(T=(y=n[9].source)==null?void 0:y.url)!=null&&T.includes("http")?n[9].source.url:"#"),h(t,"target","_blank"),h(e,"class","text-sm dark:text-gray-400 flex items-center gap-2 w-fit")},m(m,d){V(m,e,d),p(e,t),p(t,s),p(e,i),o&&o.m(e,null)},p(m,d){var _,k,v,N,y,T,P,R,I,B,S,L;d&8&&l!==(l=decodeURIComponent(((k=(_=m[9])==null?void 0:_.metadata)==null?void 0:k.name)??m[9].source.name)+"")&&Z(s,l),d&8&&r!==(r=(N=(v=m[9])==null?void 0:v.metadata)!=null&&N.file_id?`${cl}/files/${(T=(y=m[9])==null?void 0:y.metadata)==null?void 0:T.file_id}/content${((R=(P=m[9])==null?void 0:P.metadata)==null?void 0:R.page)!==void 0?`#page=${m[9].metadata.page+1}`:""}`:(B=(I=m[9].source)==null?void 0:I.url)!=null&&B.includes("http")?m[9].source.url:"#")&&h(t,"href",r),(L=(S=m[9])==null?void 0:S.metadata)!=null&&L.page?o?o.p(m,d):(o=Cl(m),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(m){m&&g(e),o&&o.d()}}}function Tl(n){let e,t=n[4].t("Relevance")+"",l,s,r,i,o,a;const f=[Mi,Ii],u=[];function c(m,d){return m[9].distance!==void 0?0:1}return r=c(n),i=u[r]=f[r](n),{c(){e=M("div"),l=W(t),s=j(),i.c(),o=ce(),this.h()},l(m){e=E(m,"DIV",{class:!0});var d=w(e);l=q(d,t),d.forEach(g),s=A(m),i.l(m),o=ce(),this.h()},h(){h(e,"class","text-sm font-medium dark:text-gray-300 mt-2")},m(m,d){V(m,e,d),p(e,l),V(m,s,d),u[r].m(m,d),V(m,o,d),a=!0},p(m,d){(!a||d&16)&&t!==(t=m[4].t("Relevance")+"")&&Z(l,t);let _=r;r=c(m),r===_?u[r].p(m,d):(ne(),D(u[_],1,1,()=>{u[_]=null}),re(),i=u[r],i?i.p(m,d):(i=u[r]=f[r](m),i.c()),b(i,1),i.m(o.parentNode,o))},i(m){a||(b(i),a=!0)},o(m){D(i),a=!1},d(m){m&&(g(e),g(s),g(o)),u[r].d(m)}}}function Ii(n){let e,t=n[4].t("No distance available")+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&16&&t!==(t=s[4].t("No distance available")+"")&&Z(l,t)},i:ve,o:ve,d(s){s&&g(e)}}}function Mi(n){let e,t;return e=new Be({props:{className:"w-fit",content:n[4].t("Semantic distance to query"),placement:"top-start",tippyOptions:{duration:[500,0]},$$slots:{default:[Ni]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s&16&&(r.content=l[4].t("Semantic distance to query")),s&8202&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ei(n){var s;let e,t=(((s=n[9])==null?void 0:s.distance)??0).toFixed(4)+"",l;return{c(){e=M("span"),l=W(t),this.h()},l(r){e=E(r,"SPAN",{class:!0});var i=w(e);l=q(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-gray-500 dark:text-gray-500")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i&8&&t!==(t=(((o=r[9])==null?void 0:o.distance)??0).toFixed(4)+"")&&Z(l,t)},d(r){r&&g(e)}}}function Bl(n){var m;let e,t=n[12].toFixed(2)+"",l,s,r,i,o,a,f=(((m=n[9])==null?void 0:m.distance)??0).toFixed(4)+"",u,c;return{c(){e=M("span"),l=W(t),s=W("%"),i=j(),o=M("span"),a=W("("),u=W(f),c=W(")"),this.h()},l(d){e=E(d,"SPAN",{class:!0});var _=w(e);l=q(_,t),s=q(_,"%"),_.forEach(g),i=A(d),o=E(d,"SPAN",{class:!0});var k=w(o);a=q(k,"("),u=q(k,f),c=q(k,")"),k.forEach(g),this.h()},h(){h(e,"class",r=`px-1 rounded-sm font-medium ${Ol(n[12])}`),h(o,"class","text-gray-500 dark:text-gray-500")},m(d,_){V(d,e,_),p(e,l),p(e,s),V(d,i,_),V(d,o,_),p(o,a),p(o,u),p(o,c)},p(d,_){var k;_&8&&t!==(t=d[12].toFixed(2)+"")&&Z(l,t),_&8&&r!==(r=`px-1 rounded-sm font-medium ${Ol(d[12])}`)&&h(e,"class",r),_&8&&f!==(f=(((k=d[9])==null?void 0:k.distance)??0).toFixed(4)+"")&&Z(u,f)},d(d){d&&(g(e),g(i),g(o))}}}function Ni(n){let e;function t(i,o){return i[1]?Bl:Ei}function l(i,o){return o===Bl?bi(i):i}let s=t(n),r=s(l(n,s));return{c(){e=M("div"),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);r.l(o),o.forEach(g),this.h()},h(){h(e,"class","text-sm my-1 dark:text-gray-400 flex items-center gap-2 w-fit")},m(i,o){V(i,e,o),r.m(e,null)},p(i,o){s===(s=t(i))&&r?r.p(l(i,s),o):(r.d(1),r=s(l(i,s)),r&&(r.c(),r.m(e,null)))},d(i){i&&g(e),r.d()}}}function Di(n){let e,t,l=n[9].document+"",s,r;return{c(){e=M("pre"),t=W("                "),s=W(l),r=W(`
              `),this.h()},l(i){e=E(i,"PRE",{class:!0});var o=w(e);t=q(o,"                "),s=q(o,l),r=q(o,`
              `),o.forEach(g),this.h()},h(){h(e,"class","text-sm dark:text-gray-400 whitespace-pre-line")},m(i,o){V(i,e,o),p(e,t),p(e,s),p(e,r)},p(i,o){o&8&&l!==(l=i[9].document+"")&&Z(s,l)},d(i){i&&g(e)}}}function Vi(n){let e,t,l;return{c(){e=M("iframe"),this.h()},l(s){e=E(s,"IFRAME",{class:!0,sandbox:!0,srcdoc:!0,title:!0}),w(e).forEach(g),this.h()},h(){h(e,"class","w-full border-0 h-auto rounded-none"),h(e,"sandbox","allow-scripts allow-forms allow-same-origin"),h(e,"srcdoc",t=n[9].document),h(e,"title",l=n[4].t("Content"))},m(s,r){V(s,e,r)},p(s,r){r&8&&t!==(t=s[9].document)&&h(e,"srcdoc",t),r&16&&l!==(l=s[4].t("Content"))&&h(e,"title",l)},d(s){s&&g(e)}}}function Rl(n){let e;return{c(){e=M("hr"),this.h()},l(t){e=E(t,"HR",{class:!0}),this.h()},h(){h(e,"class","border-gray-100 dark:border-gray-850 my-3")},m(t,l){V(t,e,l)},d(t){t&&g(e)}}}function Sl(n){let e,t,l=n[4].t("Source")+"",s,r,i,o,a,f,u,c=n[4].t("Content")+"",m,d,_,k,v;const N=[wi,ki],y=[];function T(S,L){var C;return(C=S[9].source)!=null&&C.name?0:1}i=T(n),o=y[i]=N[i](n);function P(S,L){var C;return(C=S[9].metadata)!=null&&C.html?Vi:Di}let R=P(n),I=R(n),B=n[11]!==n[3].length-1&&Rl();return{c(){e=M("div"),t=M("div"),s=W(l),r=j(),o.c(),a=j(),f=M("div"),u=M("div"),m=W(c),d=j(),I.c(),_=j(),B&&B.c(),k=ce(),this.h()},l(S){e=E(S,"DIV",{class:!0});var L=w(e);t=E(L,"DIV",{class:!0});var C=w(t);s=q(C,l),C.forEach(g),r=A(L),o.l(L),L.forEach(g),a=A(S),f=E(S,"DIV",{class:!0});var O=w(f);u=E(O,"DIV",{class:!0});var z=w(u);m=q(z,c),z.forEach(g),d=A(O),I.l(O),O.forEach(g),_=A(S),B&&B.l(S),k=ce(),this.h()},h(){h(t,"class","text-sm font-medium dark:text-gray-300"),h(e,"class","flex flex-col w-full"),h(u,"class","text-sm font-medium dark:text-gray-300 mt-2"),h(f,"class","flex flex-col w-full")},m(S,L){V(S,e,L),p(e,t),p(t,s),p(e,r),y[i].m(e,null),V(S,a,L),V(S,f,L),p(f,u),p(u,m),p(f,d),I.m(f,null),V(S,_,L),B&&B.m(S,L),V(S,k,L),v=!0},p(S,L){(!v||L&16)&&l!==(l=S[4].t("Source")+"")&&Z(s,l);let C=i;i=T(S),i===C?y[i].p(S,L):(ne(),D(y[C],1,1,()=>{y[C]=null}),re(),o=y[i],o?o.p(S,L):(o=y[i]=N[i](S),o.c()),b(o,1),o.m(e,null)),(!v||L&16)&&c!==(c=S[4].t("Content")+"")&&Z(m,c),R===(R=P(S))&&I?I.p(S,L):(I.d(1),I=R(S),I&&(I.c(),I.m(f,null))),S[11]!==S[3].length-1?B||(B=Rl(),B.c(),B.m(k.parentNode,k)):B&&(B.d(1),B=null)},i(S){v||(b(o),v=!0)},o(S){D(o),v=!1},d(S){S&&(g(e),g(a),g(f),g(_),g(k)),y[i].d(),I.d(),B&&B.d(S)}}}function Ci(n){let e,t,l,s=n[4].t("Citation")+"",r,i,o,a='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',f,u,c,m,d,_,k=De(n[3]),v=[];for(let y=0;y<k.length;y+=1)v[y]=Sl(Vl(n,k,y));const N=y=>D(v[y],1,1,()=>{v[y]=null});return{c(){e=M("div"),t=M("div"),l=M("div"),r=W(s),i=j(),o=M("button"),o.innerHTML=a,f=j(),u=M("div"),c=M("div");for(let y=0;y<v.length;y+=1)v[y].c();this.h()},l(y){e=E(y,"DIV",{});var T=w(e);t=E(T,"DIV",{class:!0});var P=w(t);l=E(P,"DIV",{class:!0});var R=w(l);r=q(R,s),R.forEach(g),i=A(P),o=E(P,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(o)!=="svelte-745w2y"&&(o.innerHTML=a),P.forEach(g),f=A(T),u=E(T,"DIV",{class:!0});var I=w(u);c=E(I,"DIV",{class:!0});var B=w(c);for(let S=0;S<v.length;S+=1)v[S].l(B);B.forEach(g),I.forEach(g),T.forEach(g),this.h()},h(){h(l,"class","text-lg font-medium self-center capitalize"),h(o,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(c,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(u,"class","flex flex-col md:flex-row w-full px-6 pb-5 md:space-x-4")},m(y,T){V(y,e,T),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(e,f),p(e,u),p(u,c);for(let P=0;P<v.length;P+=1)v[P]&&v[P].m(c,null);m=!0,d||(_=ue(o,"click",n[7]),d=!0)},p(y,T){if((!m||T&16)&&s!==(s=y[4].t("Citation")+"")&&Z(r,s),T&30){k=De(y[3]);let P;for(P=0;P<k.length;P+=1){const R=Vl(y,k,P);v[P]?(v[P].p(R,T),b(v[P],1)):(v[P]=Sl(R),v[P].c(),b(v[P],1),v[P].m(c,null))}for(ne(),P=k.length;P<v.length;P+=1)N(P);re()}},i(y){if(!m){for(let T=0;T<k.length;T+=1)b(v[T]);m=!0}},o(y){v=v.filter(Boolean);for(let T=0;T<v.length;T+=1)D(v[T]);m=!1},d(y){y&&g(e),qe(v,y),d=!1,_()}}}function Ti(n){let e,t,l;function s(i){n[8](i)}let r={size:"lg",$$slots:{default:[Ci]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new On({props:r}),Ae.push(()=>Ke(e,"show",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&8223&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function Bi(n){return n<0?0:n>1?100:Math.round(n*1e4)/100}function Ol(n){return n>=80?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":n>=60?"bg-yellow-200 dark:bg-yellow-800 text-yellow-800 dark:text-yellow-200":n>=40?"bg-orange-200 dark:bg-orange-800 text-orange-800 dark:text-orange-200":"bg-red-200 dark:bg-red-800 text-red-800 dark:text-red-200"}function Ri(n,e,t){let l;const s=Fe("i18n");Ee(n,s,m=>t(4,l=m));let{show:r=!1}=e,{citation:i}=e,{showPercentage:o=!1}=e,{showRelevance:a=!0}=e,f=[];const u=()=>{t(0,r=!1)};function c(m){r=m,t(0,r)}return n.$$set=m=>{"show"in m&&t(0,r=m.show),"citation"in m&&t(6,i=m.citation),"showPercentage"in m&&t(1,o=m.showPercentage),"showRelevance"in m&&t(2,a=m.showRelevance)},n.$$.update=()=>{var m;n.$$.dirty&72&&i&&(t(3,f=(m=i.document)==null?void 0:m.map((d,_)=>{var k,v;return{source:i.source,document:d,metadata:(k=i.metadata)==null?void 0:k[_],distance:(v=i.distances)==null?void 0:v[_]}})),f.every(d=>d.distance!==void 0)&&t(3,f=f.sort((d,_)=>(_.distance??1/0)-(d.distance??1/0))))},[r,o,a,f,l,s,i,u,c]}class Si extends Le{constructor(e){super(),Pe(this,e,Ri,Ti,Te,{show:0,citation:6,showPercentage:1,showRelevance:2})}}function Ll(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Pl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function Hl(n,e,t){const l=n.slice();return l[18]=e[t],l[20]=t,l}function jl(n){let e,t,l,s;const r=[Li,Oi],i=[];function o(a,f){return a[1].length<=3?0:1}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);l.l(f),f.forEach(g),this.h()},h(){h(e,"class","py-0.5 -mx-0.5 w-full flex gap-1 items-center flex-wrap")},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t===u?i[t].p(a,f):(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),l=i[t],l?l.p(a,f):(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&g(e),i[t].d()}}}function Oi(n){let e,t,l;function s(i){n[17](i)}let r={id:`collapsible-${n[0]}`,className:"w-full max-w-full ",buttonClassName:"w-fit max-w-full",$$slots:{content:[Ai],default:[ji]},$$scope:{ctx:n}};return n[6]!==void 0&&(r.open=n[6]),e=new Cn({props:r}),Ae.push(()=>Ke(e,"open",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,o){const a={};o&1&&(a.id=`collapsible-${i[0]}`),o&8388851&&(a.$$scope={dirty:o,ctx:i}),!t&&o&64&&(t=!0,a.open=i[6],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function Li(n){let e,t=De(n[1]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Fl(Hl(n,t,s));return{c(){e=M("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);for(let i=0;i<l.length;i+=1)l[i].l(r);r.forEach(g),this.h()},h(){h(e,"class","flex text-xs font-medium flex-wrap")},m(s,r){V(s,e,r);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(e,null)},p(s,r){if(r&51){t=De(s[1]);let i;for(i=0;i<t.length;i+=1){const o=Hl(s,t,i);l[i]?l[i].p(o,r):(l[i]=Fl(o),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=t.length}},i:ve,o:ve,d(s){s&&g(e),qe(l,s)}}}function Al(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function zl(n){let e,t=n[1].every(n[12]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u=t&&Al(n);function c(){return n[16](n[18])}return{c(){e=M("button"),u&&u.c(),l=j(),s=M("div"),i=W(r),o=j(),this.h()},l(m){e=E(m,"BUTTON",{class:!0});var d=w(e);u&&u.l(d),l=A(d),s=E(d,"DIV",{class:!0});var _=w(s);i=q(_,r),_.forEach(g),o=A(d),d.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(m,d){V(m,e,d),u&&u.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),a||(f=[ue(e,"click",c),ue(e,"pointerup",qi)],a=!0)},p(m,d){n=m,d&2&&(t=n[1].every(n[12])),t?u||(u=Al(n),u.c(),u.m(e,l)):u&&(u.d(1),u=null),d&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r)},d(m){m&&g(e),u&&u.d(),a=!1,Qe(f)}}}function Pi(n){let e,t;return e=new Bn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Hi(n){let e,t;return e=new Rn({props:{strokeWidth:"3.5",className:"size-3.5"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ji(n){let e,t,l,s=n[7].t("References from")+"",r,i,o,a,f,u,c,m=n[7].t("and")+"",d,_,k=n[1].length-2+"",v,N,y,T=n[7].t("more")+"",P,R,I,B,S,L,C=De(n[1].slice(0,2)),O=[];for(let ie=0;ie<C.length;ie+=1)O[ie]=zl(Ll(n,C,ie));const z=[Hi,Pi],le=[];function me(ie,se){return ie[6]?0:1}return B=me(n),S=le[B]=z[B](n),{c(){e=M("div"),t=M("div"),l=M("span"),r=W(s),i=j(),o=M("div"),a=M("div");for(let ie=0;ie<O.length;ie+=1)O[ie].c();f=j(),u=M("div"),c=M("span"),d=W(m),_=j(),v=W(k),N=j(),y=M("span"),P=W(T),R=j(),I=M("div"),S.c(),this.h()},l(ie){e=E(ie,"DIV",{class:!0});var se=w(e);t=E(se,"DIV",{class:!0});var _e=w(t);l=E(_e,"SPAN",{class:!0});var ge=w(l);r=q(ge,s),ge.forEach(g),i=A(_e),o=E(_e,"DIV",{class:!0});var Ie=w(o);a=E(Ie,"DIV",{class:!0});var Q=w(a);for(let fe=0;fe<O.length;fe+=1)O[fe].l(Q);Q.forEach(g),Ie.forEach(g),f=A(_e),u=E(_e,"DIV",{class:!0});var J=w(u);c=E(J,"SPAN",{class:!0});var oe=w(c);d=q(oe,m),oe.forEach(g),_=A(J),v=q(J,k),N=A(J),y=E(J,"SPAN",{});var ye=w(y);P=q(ye,T),ye.forEach(g),J.forEach(g),_e.forEach(g),R=A(se),I=E(se,"DIV",{class:!0});var U=w(I);S.l(U),U.forEach(g),se.forEach(g),this.h()},h(){h(l,"class","whitespace-nowrap hidden sm:inline shrink-0"),h(a,"class","flex text-xs font-medium items-center"),h(o,"class","flex items-center overflow-auto scrollbar-none w-full max-w-full flex-1"),h(c,"class","hidden sm:inline"),h(u,"class","flex items-center gap-1 whitespace-nowrap shrink-0"),h(t,"class","flex-1 flex items-center gap-1 overflow-auto scrollbar-none w-full max-w-full"),h(I,"class","shrink-0"),h(e,"class","flex w-full overflow-auto items-center gap-2 text-gray-500 hover:text-gray-600 dark:hover:text-gray-400 transition cursor-pointer")},m(ie,se){V(ie,e,se),p(e,t),p(t,l),p(l,r),p(t,i),p(t,o),p(o,a);for(let _e=0;_e<O.length;_e+=1)O[_e]&&O[_e].m(a,null);p(t,f),p(t,u),p(u,c),p(c,d),p(u,_),p(u,v),p(u,N),p(u,y),p(y,P),p(e,R),p(e,I),le[B].m(I,null),L=!0},p(ie,se){if((!L||se&128)&&s!==(s=ie[7].t("References from")+"")&&Z(r,s),se&50){C=De(ie[1].slice(0,2));let ge;for(ge=0;ge<C.length;ge+=1){const Ie=Ll(ie,C,ge);O[ge]?O[ge].p(Ie,se):(O[ge]=zl(Ie),O[ge].c(),O[ge].m(a,null))}for(;ge<O.length;ge+=1)O[ge].d(1);O.length=C.length}(!L||se&128)&&m!==(m=ie[7].t("and")+"")&&Z(d,m),(!L||se&2)&&k!==(k=ie[1].length-2+"")&&Z(v,k),(!L||se&128)&&T!==(T=ie[7].t("more")+"")&&Z(P,T);let _e=B;B=me(ie),B!==_e&&(ne(),D(le[_e],1,1,()=>{le[_e]=null}),re(),S=le[B],S||(S=le[B]=z[B](ie),S.c()),b(S,1),S.m(I,null))},i(ie){L||(b(S),L=!0)},o(ie){D(S),L=!1},d(ie){ie&&g(e),qe(O,ie),le[B].d()}}}function Ul(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function Wl(n){let e,t=n[1].every(n[11]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u,c=t&&Ul(n);function m(){return n[15](n[18])}return{c(){e=M("button"),c&&c.c(),l=j(),s=M("div"),i=W(r),o=j(),this.h()},l(d){e=E(d,"BUTTON",{id:!0,class:!0});var _=w(e);c&&c.l(_),l=A(_),s=E(_,"DIV",{class:!0});var k=w(s);i=q(k,r),k.forEach(g),o=A(_),_.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate"),h(e,"id",a=`source-${n[0]}-${n[20]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-900 dark:hover:bg-gray-850 transition rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ue(e,"click",m),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[11])),t?c||(c=Ul(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[20]+1}`)&&h(e,"id",a)},d(d){d&&g(e),c&&c.d(),f=!1,u()}}}function Ai(n){let e,t,l=De(n[1]),s=[];for(let r=0;r<l.length;r+=1)s[r]=Wl(Pl(n,l,r));return{c(){e=M("div"),t=M("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=E(r,"DIV",{slot:!0});var i=w(e);t=E(i,"DIV",{class:!0});var o=w(t);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),i.forEach(g),this.h()},h(){h(t,"class","flex text-xs font-medium flex-wrap"),h(e,"slot","content")},m(r,i){V(r,e,i),p(e,t);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(t,null)},p(r,i){if(i&51){l=De(r[1]);let o;for(o=0;o<l.length;o+=1){const a=Pl(r,l,o);s[o]?s[o].p(a,i):(s[o]=Wl(a),s[o].c(),s[o].m(t,null))}for(;o<s.length;o+=1)s[o].d(1);s.length=l.length}},d(r){r&&g(e),qe(s,r)}}}function ql(n){let e,t=n[20]+1+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","bg-gray-50 dark:bg-gray-800 rounded-full size-4")},m(s,r){V(s,e,r),p(e,l)},d(s){s&&g(e)}}}function Fl(n){let e,t=n[1].every(n[10]),l,s,r=decodeURIComponent(n[18].source.name)+"",i,o,a,f,u,c=t&&ql(n);function m(){return n[14](n[18])}return{c(){e=M("button"),c&&c.c(),l=j(),s=M("div"),i=W(r),o=j(),this.h()},l(d){e=E(d,"BUTTON",{id:!0,class:!0});var _=w(e);c&&c.l(_),l=A(_),s=E(_,"DIV",{class:!0});var k=w(s);i=q(k,r),k.forEach(g),o=A(_),_.forEach(g),this.h()},h(){h(s,"class","flex-1 mx-1 truncate text-black/60 hover:text-black dark:text-white/60 dark:hover:text-white transition"),h(e,"id",a=`source-${n[0]}-${n[20]+1}`),h(e,"class","no-toggle outline-hidden flex dark:text-gray-300 p-1 bg-white dark:bg-gray-900 rounded-xl max-w-96")},m(d,_){V(d,e,_),c&&c.m(e,null),p(e,l),p(e,s),p(s,i),p(e,o),f||(u=ue(e,"click",m),f=!0)},p(d,_){n=d,_&2&&(t=n[1].every(n[10])),t?c||(c=ql(n),c.c(),c.m(e,l)):c&&(c.d(1),c=null),_&2&&r!==(r=decodeURIComponent(n[18].source.name)+"")&&Z(i,r),_&1&&a!==(a=`source-${n[0]}-${n[20]+1}`)&&h(e,"id",a)},d(d){d&&g(e),c&&c.d(),f=!1,u()}}}function zi(n){let e,t,l,s,r;function i(f){n[13](f)}let o={citation:n[5],showPercentage:n[2],showRelevance:n[3]};n[4]!==void 0&&(o.show=n[4]),e=new Si({props:o}),Ae.push(()=>Ke(e,"show",i));let a=n[1].length>0&&jl(n);return{c(){$(e.$$.fragment),l=j(),a&&a.c(),s=ce()},l(f){x(e.$$.fragment,f),l=A(f),a&&a.l(f),s=ce()},m(f,u){ee(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&32&&(c.citation=f[5]),u&4&&(c.showPercentage=f[2]),u&8&&(c.showRelevance=f[3]),!t&&u&16&&(t=!0,c.show=f[4],Ze(()=>t=!1)),e.$set(c),f[1].length>0?a?(a.p(f,u),u&2&&b(a,1)):(a=jl(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(ne(),D(a,1,1,()=>{a=null}),re())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(g(l),g(s)),te(e,f),a&&a.d(f)}}}function Ui(n){const e=n.flatMap(s=>s.distances??[]),t=e.filter(s=>s!==void 0&&s>=-1&&s<=1).length,l=e.filter(s=>s!==void 0&&(s<-1||s>1)).length;return!(e.length===0||t===e.length-1&&l===1||l===e.length-1&&t===1)}function Wi(n){return n.flatMap(t=>t.distances??[]).every(t=>t!==void 0&&t>=-1&&t<=1)}const qi=n=>{n.stopPropagation()};function Fi(n,e,t){let l;const s=Fe("i18n");Ee(n,s,R=>t(7,l=R));let{id:r=""}=e,{sources:i=[]}=e,o=[],a=!1,f=!0,u=!1,c=null,m=!1;const d=R=>R.distances!==void 0,_=R=>R.distances!==void 0,k=R=>R.distances!==void 0;function v(R){u=R,t(4,u)}const N=R=>{t(4,u=!0),t(5,c=R)},y=R=>{t(4,u=!0),t(5,c=R)},T=R=>{t(4,u=!0),t(5,c=R)};function P(R){m=R,t(6,m)}return n.$$set=R=>{"id"in R&&t(0,r=R.id),"sources"in R&&t(9,i=R.sources)},n.$$.update=()=>{n.$$.dirty&514&&(console.log("sources",i),t(1,o=i.reduce((R,I)=>(Object.keys(I).length===0||I.document.forEach((B,S)=>{var me,ie,se;const L=(me=I.metadata)==null?void 0:me[S],C=(ie=I.distances)==null?void 0:ie[S],O=(L==null?void 0:L.source)??((se=I==null?void 0:I.source)==null?void 0:se.id)??"N/A";let z=I==null?void 0:I.source;L!=null&&L.name&&(z={...z,name:L.name}),(O.startsWith("http://")||O.startsWith("https://"))&&(z={...z,name:O,url:O});const le=R.find(_e=>_e.id===O);le?(le.document.push(B),le.metadata.push(L),C!==void 0&&le.distances.push(C)):R.push({id:O,source:z,document:[B],metadata:L?[L]:[],distances:C!==void 0?[C]:void 0})}),R),[])),t(3,f=Ui(o)),t(2,a=Wi(o)))},[r,o,a,f,u,c,m,l,s,i,d,_,k,v,N,y,T,P]}class Ji extends Le{constructor(e){super(),Pe(this,e,Fi,zi,Te,{id:0,sources:9})}}function Jl(n,e,t){const l=n.slice();return l[6]=e[t],l}function Gl(n){let e,t,l,s;const r=[Ki,Zi,Gi],i=[];function o(a,f){var u,c;return(u=a[1].result)!=null&&u.error?0:(c=a[1].result)!=null&&c.output?1:2}return t=o(n),l=i[t]=r[t](n),{c(){e=M("div"),l.c()},l(a){e=E(a,"DIV",{});var f=w(e);l.l(f),f.forEach(g)},m(a,f){V(a,e,f),i[t].m(e,null),s=!0},p(a,f){let u=t;t=o(a),t!==u&&(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),l=i[t],l||(l=i[t]=r[t](a),l.c()),b(l,1),l.m(e,null))},i(a){s||(b(l),s=!0)},o(a){D(l),s=!1},d(a){a&&g(e),i[t].d()}}}function Gi(n){let e,t;return e=new Qt({props:{type:"warning",content:"incomplete"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Zi(n){let e,t;return e=new Qt({props:{type:"success",content:"success"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ki(n){let e,t;return e=new Qt({props:{type:"error",content:"error"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Zl(n){let e,t,l;return t=new Ut({props:{className:"size-4"}}),{c(){e=M("div"),$(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=w(e);x(t.$$.fragment,r),r.forEach(g)},m(s,r){V(s,e,r),ee(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function Qi(n){let e=n[2].t("Code execution")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&4&&e!==(e=l[2].t("Code execution")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Yi(n){var i;let e=n[2].t("Code execution")+"",t,l,s=((i=n[1])==null?void 0:i.name)+"",r;return{c(){t=W(e),l=W(": "),r=W(s)},l(o){t=q(o,e),l=q(o,": "),r=q(o,s)},m(o,a){V(o,t,a),V(o,l,a),V(o,r,a)},p(o,a){var f;a&4&&e!==(e=o[2].t("Code execution")+"")&&Z(t,e),a&2&&s!==(s=((f=o[1])==null?void 0:f.name)+"")&&Z(r,s)},d(o){o&&(g(t),g(l),g(r))}}}function Kl(n){var r,i,o,a;let e,t,l=((i=(r=n[1])==null?void 0:r.result)==null?void 0:i.error)&&Ql(n),s=((a=(o=n[1])==null?void 0:o.result)==null?void 0:a.output)&&Yl(n);return{c(){e=M("div"),l&&l.c(),t=j(),s&&s.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);l&&l.l(u),t=A(u),s&&s.l(u),u.forEach(g),this.h()},h(){h(e,"class","dark:bg-[#202123] dark:text-white px-4 py-4 rounded-b-lg flex flex-col gap-3")},m(f,u){V(f,e,u),l&&l.m(e,null),p(e,t),s&&s.m(e,null)},p(f,u){var c,m,d,_;(m=(c=f[1])==null?void 0:c.result)!=null&&m.error?l?l.p(f,u):(l=Ql(f),l.c(),l.m(e,t)):l&&(l.d(1),l=null),(_=(d=f[1])==null?void 0:d.result)!=null&&_.output?s?s.p(f,u):(s=Yl(f),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(f){f&&g(e),l&&l.d(),s&&s.d()}}}function Ql(n){var f,u;let e,t,l=n[2].t("ERROR")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.error)+"",a;return{c(){e=M("div"),t=M("div"),s=W(l),r=j(),i=M("div"),a=W(o),this.h()},l(c){e=E(c,"DIV",{});var m=w(e);t=E(m,"DIV",{class:!0});var d=w(t);s=q(d,l),d.forEach(g),r=A(m),i=E(m,"DIV",{class:!0});var _=w(i);a=q(_,o),_.forEach(g),m.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,m){var d,_;m&4&&l!==(l=c[2].t("ERROR")+"")&&Z(s,l),m&2&&o!==(o=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.error)+"")&&Z(a,o)},d(c){c&&g(e)}}}function Yl(n){var f,u;let e,t,l=n[2].t("OUTPUT")+"",s,r,i,o=((u=(f=n[1])==null?void 0:f.result)==null?void 0:u.output)+"",a;return{c(){e=M("div"),t=M("div"),s=W(l),r=j(),i=M("div"),a=W(o),this.h()},l(c){e=E(c,"DIV",{});var m=w(e);t=E(m,"DIV",{class:!0});var d=w(t);s=q(d,l),d.forEach(g),r=A(m),i=E(m,"DIV",{class:!0});var _=w(i);a=q(_,o),_.forEach(g),m.forEach(g),this.h()},h(){h(t,"class","text-gray-500 text-xs mb-1"),h(i,"class","text-sm")},m(c,m){V(c,e,m),p(e,t),p(t,s),p(e,r),p(e,i),p(i,a)},p(c,m){var d,_;m&4&&l!==(l=c[2].t("OUTPUT")+"")&&Z(s,l),m&2&&o!==(o=((_=(d=c[1])==null?void 0:d.result)==null?void 0:_.output)+"")&&Z(a,o)},d(c){c&&g(e)}}}function Xl(n){var c,m;let e,t,l,s,r=n[2].t("Files")+"",i,o,a,f=De((m=(c=n[1])==null?void 0:c.result)==null?void 0:m.files),u=[];for(let d=0;d<f.length;d+=1)u[d]=$l(Jl(n,f,d));return{c(){e=M("div"),t=M("hr"),l=j(),s=M("div"),i=W(r),o=j(),a=M("ul");for(let d=0;d<u.length;d+=1)u[d].c();this.h()},l(d){e=E(d,"DIV",{class:!0});var _=w(e);t=E(_,"HR",{class:!0}),l=A(_),s=E(_,"DIV",{class:!0});var k=w(s);i=q(k,r),k.forEach(g),o=A(_),a=E(_,"UL",{class:!0});var v=w(a);for(let N=0;N<u.length;N+=1)u[N].l(v);v.forEach(g),_.forEach(g),this.h()},h(){h(t,"class","border-gray-100 dark:border-gray-850 my-2"),h(s,"class","text-sm font-medium dark:text-gray-300"),h(a,"class","mt-1 list-disc pl-4 text-xs"),h(e,"class","flex flex-col w-full")},m(d,_){V(d,e,_),p(e,t),p(e,l),p(e,s),p(s,i),p(e,o),p(e,a);for(let k=0;k<u.length;k+=1)u[k]&&u[k].m(a,null)},p(d,_){var k,v;if(_&4&&r!==(r=d[2].t("Files")+"")&&Z(i,r),_&2){f=De((v=(k=d[1])==null?void 0:k.result)==null?void 0:v.files);let N;for(N=0;N<f.length;N+=1){const y=Jl(d,f,N);u[N]?u[N].p(y,_):(u[N]=$l(y),u[N].c(),u[N].m(a,null))}for(;N<u.length;N+=1)u[N].d(1);u.length=f.length}},d(d){d&&g(e),qe(u,d)}}}function $l(n){let e,t,l=n[6].name+"",s,r,i;return{c(){e=M("li"),t=M("a"),s=W(l),i=j(),this.h()},l(o){e=E(o,"LI",{});var a=w(e);t=E(a,"A",{href:!0,target:!0});var f=w(t);s=q(f,l),f.forEach(g),i=A(a),a.forEach(g),this.h()},h(){h(t,"href",r=n[6].url),h(t,"target","_blank")},m(o,a){V(o,e,a),p(e,t),p(t,s),p(e,i)},p(o,a){a&2&&l!==(l=o[6].name+"")&&Z(s,l),a&2&&r!==(r=o[6].url)&&h(t,"href",r)},d(o){o&&g(e)}}}function Xi(n){var z,le,me,ie,se,_e,ge,Ie,Q,J,oe,ye,U,fe,de,he,be,H,K;let e,t,l,s,r,i,o,a,f,u='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5"><path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"></path></svg>',c,m,d,_,k,v,N,y,T,P,R=((z=n[1])==null?void 0:z.result)&&Gl(n),I=!((le=n[1])!=null&&le.result)&&Zl();function B(Y,G){var ae;return(ae=Y[1])!=null&&ae.name?Yi:Qi}let S=B(n),L=S(n);k=new Nr({props:{id:"code-exec-"+((me=n[1])==null?void 0:me.id)+"-code",lang:((ie=n[1])==null?void 0:ie.language)??"",code:((se=n[1])==null?void 0:se.code)??"",className:"",editorClassName:(_e=n[1])!=null&&_e.result&&((Ie=(ge=n[1])==null?void 0:ge.result)!=null&&Ie.error||(J=(Q=n[1])==null?void 0:Q.result)!=null&&J.output)?"rounded-b-none":"",stickyButtonsClassName:"top-0",run:!1}});let C=((oe=n[1])==null?void 0:oe.result)&&(((U=(ye=n[1])==null?void 0:ye.result)==null?void 0:U.error)||((de=(fe=n[1])==null?void 0:fe.result)==null?void 0:de.output))&&Kl(n),O=((be=(he=n[1])==null?void 0:he.result)==null?void 0:be.files)&&((K=(H=n[1])==null?void 0:H.result)==null?void 0:K.files.length)>0&&Xl(n);return{c(){e=M("div"),t=M("div"),l=M("div"),R&&R.c(),s=j(),r=M("div"),I&&I.c(),i=j(),o=M("div"),L.c(),a=j(),f=M("button"),f.innerHTML=u,c=j(),m=M("div"),d=M("div"),_=M("div"),$(k.$$.fragment),v=j(),C&&C.c(),N=j(),O&&O.c(),this.h()},l(Y){e=E(Y,"DIV",{});var G=w(e);t=E(G,"DIV",{class:!0});var ae=w(t);l=E(ae,"DIV",{class:!0});var pe=w(l);R&&R.l(pe),s=A(pe),r=E(pe,"DIV",{class:!0});var Ce=w(r);I&&I.l(Ce),i=A(Ce),o=E(Ce,"DIV",{});var X=w(o);L.l(X),X.forEach(g),Ce.forEach(g),pe.forEach(g),a=A(ae),f=E(ae,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(f)!=="svelte-vnrwun"&&(f.innerHTML=u),ae.forEach(g),c=A(G),m=E(G,"DIV",{class:!0});var Se=w(m);d=E(Se,"DIV",{class:!0});var He=w(d);_=E(He,"DIV",{class:!0});var ze=w(_);x(k.$$.fragment,ze),ze.forEach(g),v=A(He),C&&C.l(He),N=A(He),O&&O.l(He),He.forEach(g),Se.forEach(g),G.forEach(g),this.h()},h(){h(r,"class","flex gap-2 items-center"),h(l,"class","text-lg font-medium self-center flex flex-col gap-0.5 capitalize"),h(f,"class","self-center"),h(t,"class","flex justify-between dark:text-gray-300 px-5 pt-4 pb-2"),h(_,"class","flex flex-col w-full"),h(d,"class","flex flex-col w-full dark:text-gray-200 overflow-y-scroll max-h-[22rem] scrollbar-hidden"),h(m,"class","flex flex-col md:flex-row w-full px-4 pb-5")},m(Y,G){V(Y,e,G),p(e,t),p(t,l),R&&R.m(l,null),p(l,s),p(l,r),I&&I.m(r,null),p(r,i),p(r,o),L.m(o,null),p(t,a),p(t,f),p(e,c),p(e,m),p(m,d),p(d,_),ee(k,_,null),p(d,v),C&&C.m(d,null),p(d,N),O&&O.m(d,null),y=!0,T||(P=ue(f,"click",n[4]),T=!0)},p(Y,G){var pe,Ce,X,Se,He,ze,Ye,lt,ot,at,tt,ft,ut,st,It,Mt,Et,Nt,Dt;(pe=Y[1])!=null&&pe.result?R?(R.p(Y,G),G&2&&b(R,1)):(R=Gl(Y),R.c(),b(R,1),R.m(l,s)):R&&(ne(),D(R,1,1,()=>{R=null}),re()),(Ce=Y[1])!=null&&Ce.result?I&&(ne(),D(I,1,1,()=>{I=null}),re()):I?G&2&&b(I,1):(I=Zl(),I.c(),b(I,1),I.m(r,i)),S===(S=B(Y))&&L?L.p(Y,G):(L.d(1),L=S(Y),L&&(L.c(),L.m(o,null)));const ae={};G&2&&(ae.id="code-exec-"+((X=Y[1])==null?void 0:X.id)+"-code"),G&2&&(ae.lang=((Se=Y[1])==null?void 0:Se.language)??""),G&2&&(ae.code=((He=Y[1])==null?void 0:He.code)??""),G&2&&(ae.editorClassName=(ze=Y[1])!=null&&ze.result&&((lt=(Ye=Y[1])==null?void 0:Ye.result)!=null&&lt.error||(at=(ot=Y[1])==null?void 0:ot.result)!=null&&at.output)?"rounded-b-none":""),k.$set(ae),(tt=Y[1])!=null&&tt.result&&((ut=(ft=Y[1])==null?void 0:ft.result)!=null&&ut.error||(It=(st=Y[1])==null?void 0:st.result)!=null&&It.output)?C?C.p(Y,G):(C=Kl(Y),C.c(),C.m(d,N)):C&&(C.d(1),C=null),(Et=(Mt=Y[1])==null?void 0:Mt.result)!=null&&Et.files&&((Dt=(Nt=Y[1])==null?void 0:Nt.result)==null?void 0:Dt.files.length)>0?O?O.p(Y,G):(O=Xl(Y),O.c(),O.m(d,null)):O&&(O.d(1),O=null)},i(Y){y||(b(R),b(I),b(k.$$.fragment,Y),y=!0)},o(Y){D(R),D(I),D(k.$$.fragment,Y),y=!1},d(Y){Y&&g(e),R&&R.d(),I&&I.d(),L.d(),te(k),C&&C.d(),O&&O.d(),T=!1,P()}}}function $i(n){let e,t,l;function s(i){n[5](i)}let r={size:"lg",$$slots:{default:[Xi]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.show=n[0]),e=new On({props:r}),Ae.push(()=>Ke(e,"show",s)),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),l=!0},p(i,[o]){const a={};o&519&&(a.$$scope={dirty:o,ctx:i}),!t&&o&1&&(t=!0,a.show=i[0],Ze(()=>t=!1)),e.$set(a)},i(i){l||(b(e.$$.fragment,i),l=!0)},o(i){D(e.$$.fragment,i),l=!1},d(i){te(e,i)}}}function xi(n,e,t){let l;const s=Fe("i18n");Ee(n,s,f=>t(2,l=f));let{show:r=!1}=e,{codeExecution:i=null}=e;const o=()=>{t(0,r=!1),t(1,i=null)};function a(f){r=f,t(0,r)}return n.$$set=f=>{"show"in f&&t(0,r=f.show),"codeExecution"in f&&t(1,i=f.codeExecution)},[r,i,l,s,o,a]}class eo extends Le{constructor(e){super(),Pe(this,e,xi,$i,Te,{show:0,codeExecution:1})}}function xl(n,e,t){const l=n.slice();return l[6]=e[t],l}function es(n){let e,t=[],l=new Map,s,r=De(n[0]);const i=o=>o[6].id;for(let o=0;o<r.length;o+=1){let a=xl(n,r,o),f=i(a);l.set(f,t[o]=ts(f,a))}return{c(){e=M("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l(o){e=E(o,"DIV",{class:!0});var a=w(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(g),this.h()},h(){h(e,"class","mt-1 mb-2 w-full flex gap-1 items-center flex-wrap")},m(o,a){V(o,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null);s=!0},p(o,a){a&7&&(r=De(o[0]),ne(),t=Gt(t,a,i,1,o,r,l,e,In,ts,null,xl),re())},i(o){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(o){for(let a=0;a<t.length;a+=1)D(t[a]);s=!1},d(o){o&&g(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function to(n){let e,t;return e=new Ut({props:{className:"size-4"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function lo(n){let e,t,l,s;const r=[ro,no,so],i=[];function o(a,f){var u,c;return(u=a[6].result)!=null&&u.error?0:(c=a[6].result)!=null&&c.output?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e!==u&&(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t||(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function so(n){let e,t;return e=new Or({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function no(n){let e,t;return e=new Rr({props:{strokeWidth:"3",className:"size-3"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ro(n){let e,t;return e=new Sr({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ts(n,e){let t,l,s,r,i,o,a,f=e[6].name+"",u,c,m,d,_,k;const v=[lo,to],N=[];function y(P,R){var I;return(I=P[6])!=null&&I.result?0:1}r=y(e),i=N[r]=v[r](e);function T(){return e[4](e[6])}return{key:n,first:null,c(){t=M("div"),l=M("button"),s=M("div"),i.c(),o=j(),a=M("div"),u=W(f),m=j(),this.h()},l(P){t=E(P,"DIV",{class:!0});var R=w(t);l=E(R,"BUTTON",{class:!0});var I=w(l);s=E(I,"DIV",{class:!0});var B=w(s);i.l(B),B.forEach(g),o=A(I),a=E(I,"DIV",{class:!0});var S=w(a);u=q(S,f),S.forEach(g),I.forEach(g),m=A(R),R.forEach(g),this.h()},h(){var P;h(s,"class","bg-white dark:bg-gray-700 rounded-full size-4 flex items-center justify-center"),h(a,"class",c="flex-1 mx-2 line-clamp-1 code-execution-name "+((P=e[6])!=null&&P.result?"":"pulse")+" svelte-1gvtig2"),h(l,"class","flex dark:text-gray-300 py-1 px-1 bg-gray-50 hover:bg-gray-100 dark:bg-gray-850 dark:hover:bg-gray-800 transition rounded-xl max-w-96"),h(t,"class","flex gap-1 text-xs font-semibold"),this.first=t},m(P,R){V(P,t,R),p(t,l),p(l,s),N[r].m(s,null),p(l,o),p(l,a),p(a,u),p(t,m),d=!0,_||(k=ue(l,"click",T),_=!0)},p(P,R){var B;e=P;let I=r;r=y(e),r===I?N[r].p(e,R):(ne(),D(N[I],1,1,()=>{N[I]=null}),re(),i=N[r],i?i.p(e,R):(i=N[r]=v[r](e),i.c()),b(i,1),i.m(s,null)),(!d||R&1)&&f!==(f=e[6].name+"")&&Z(u,f),(!d||R&1&&c!==(c="flex-1 mx-2 line-clamp-1 code-execution-name "+((B=e[6])!=null&&B.result?"":"pulse")+" svelte-1gvtig2"))&&h(a,"class",c)},i(P){d||(b(i),d=!0)},o(P){D(i),d=!1},d(P){P&&g(t),N[r].d(),_=!1,k()}}}function io(n){let e,t,l,s,r;function i(f){n[3](f)}let o={codeExecution:n[1]};n[2]!==void 0&&(o.show=n[2]),e=new eo({props:o}),Ae.push(()=>Ke(e,"show",i));let a=n[0].length>0&&es(n);return{c(){$(e.$$.fragment),l=j(),a&&a.c(),s=ce()},l(f){x(e.$$.fragment,f),l=A(f),a&&a.l(f),s=ce()},m(f,u){ee(e,f,u),V(f,l,u),a&&a.m(f,u),V(f,s,u),r=!0},p(f,[u]){const c={};u&2&&(c.codeExecution=f[1]),!t&&u&4&&(t=!0,c.show=f[2],Ze(()=>t=!1)),e.$set(c),f[0].length>0?a?(a.p(f,u),u&1&&b(a,1)):(a=es(f),a.c(),b(a,1),a.m(s.parentNode,s)):a&&(ne(),D(a,1,1,()=>{a=null}),re())},i(f){r||(b(e.$$.fragment,f),b(a),r=!0)},o(f){D(e.$$.fragment,f),D(a),r=!1},d(f){f&&(g(l),g(s)),te(e,f),a&&a.d(f)}}}function oo(n,e,t){let{codeExecutions:l=[]}=e,s=null,r=!1;const i=()=>{s&&t(1,s=l.find(f=>f.id===s.id))};function o(f){r=f,t(2,r)}const a=f=>{t(1,s=f),t(2,r=!0)};return n.$$set=f=>{"codeExecutions"in f&&t(0,l=f.codeExecutions)},n.$$.update=()=>{n.$$.dirty&1&&l&&i()},[l,s,r,o,a]}class ao extends Le{constructor(e){super(),Pe(this,e,oo,io,Te,{codeExecutions:0})}}function fo(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function uo(n,e,t){let{className:l="size-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class co extends Le{constructor(e){super(),Pe(this,e,uo,fo,Te,{className:0,strokeWidth:1})}}function ho(n){let e,t,l,s,r,i,o,a,f,u,c,m;s=new yt({props:{id:`${n[0]}-float-prompt`,content:n[4]}});const d=[_o,go],_=[];function k(N,y){return y&32&&(a=null),a==null&&(a=N[5].trim()===""),a?0:1}f=k(n,-1),u=_[f]=d[f](n);let v=n[6]&&ls(n);return{c(){e=M("div"),t=M("div"),l=M("div"),$(s.$$.fragment),r=j(),i=M("div"),o=M("div"),u.c(),c=j(),v&&v.c(),this.h()},l(N){e=E(N,"DIV",{class:!0});var y=w(e);t=E(y,"DIV",{class:!0});var T=w(t);l=E(T,"DIV",{class:!0});var P=w(l);x(s.$$.fragment,P),P.forEach(g),T.forEach(g),r=A(y),i=E(y,"DIV",{class:!0});var R=w(i);o=E(R,"DIV",{class:!0,id:!0});var I=w(o);u.l(I),c=A(I),v&&v.l(I),I.forEach(g),R.forEach(g),y.forEach(g),this.h()},h(){h(l,"class","font-medium"),h(t,"class","bg-gray-50/50 dark:bg-gray-800 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(o,"class","max-h-80 overflow-y-auto w-full markdown-prose-xs"),h(o,"id","response-container"),h(i,"class","bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-xl px-3.5 py-3 w-full"),h(e,"class","bg-white dark:bg-gray-850 dark:text-gray-100 rounded-xl shadow-xl w-80 max-w-full")},m(N,y){V(N,e,y),p(e,t),p(t,l),ee(s,l,null),p(e,r),p(e,i),p(i,o),_[f].m(o,null),p(o,c),v&&v.m(o,null),m=!0},p(N,y){const T={};y&1&&(T.id=`${N[0]}-float-prompt`),y&16&&(T.content=N[4]),s.$set(T);let P=f;f=k(N,y),f===P?_[f].p(N,y):(ne(),D(_[P],1,1,()=>{_[P]=null}),re(),u=_[f],u?u.p(N,y):(u=_[f]=d[f](N),u.c()),b(u,1),u.m(o,c)),N[6]?v?v.p(N,y):(v=ls(N),v.c(),v.m(o,null)):v&&(v.d(1),v=null)},i(N){m||(b(s.$$.fragment,N),b(u),m=!0)},o(N){D(s.$$.fragment,N),D(u),m=!1},d(N){N&&g(e),te(s),_[f].d(),v&&v.d()}}}function mo(n){let e,t,l,s;const r=[vo,po],i=[];function o(a,f){return a[1]?1:0}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function go(n){let e,t;return e=new yt({props:{id:`${n[0]}-float-response`,content:n[5]}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.id=`${l[0]}-float-response`),s&32&&(r.content=l[5]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function _o(n){let e,t;return e=new Yt({props:{size:"sm"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ls(n){let e,t,l=n[7].t("Add")+"",s,r,i;return{c(){e=M("div"),t=M("button"),s=W(l),this.h()},l(o){e=E(o,"DIV",{class:!0});var a=w(e);t=E(a,"BUTTON",{class:!0});var f=w(t);s=q(f,l),f.forEach(g),a.forEach(g),this.h()},h(){h(t,"class","px-3.5 py-1.5 text-sm font-medium bg-black hover:bg-gray-900 text-white dark:bg-white dark:text-black dark:hover:bg-gray-100 transition rounded-full"),h(e,"class","flex justify-end pt-3 text-sm font-medium")},m(o,a){V(o,e,a),p(e,t),p(t,s),r||(i=ue(t,"click",n[11]),r=!0)},p(o,a){a&128&&l!==(l=o[7].t("Add")+"")&&Z(s,l)},d(o){o&&g(e),r=!1,i()}}}function po(n){let e,t,l,s,r,i,o,a,f,u,c;return{c(){e=M("div"),t=M("input"),s=j(),r=M("div"),i=M("button"),o=ke("svg"),a=ke("path"),this.h()},l(m){e=E(m,"DIV",{class:!0});var d=w(e);t=E(d,"INPUT",{type:!0,id:!0,class:!0,placeholder:!0}),s=A(d),r=E(d,"DIV",{class:!0});var _=w(r);i=E(_,"BUTTON",{class:!0});var k=w(i);o=we(k,"svg",{xmlns:!0,viewBox:!0,fill:!0,class:!0});var v=w(o);a=we(v,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),w(a).forEach(g),v.forEach(g),k.forEach(g),_.forEach(g),d.forEach(g),this.h()},h(){h(t,"type","text"),h(t,"id","floating-message-input"),h(t,"class","ml-5 bg-transparent outline-hidden w-full flex-1 text-sm"),h(t,"placeholder",l=n[7].t("Ask a question")),h(a,"fill-rule","evenodd"),h(a,"d","M8 14a.75.75 0 0 1-.75-.75V4.56L4.03 7.78a.75.75 0 0 1-1.06-1.06l4.5-4.5a.75.75 0 0 1 1.06 0l4.5 4.5a.75.75 0 0 1-1.06 1.06L8.75 4.56v8.69A.75.75 0 0 1 8 14Z"),h(a,"clip-rule","evenodd"),h(o,"xmlns","http://www.w3.org/2000/svg"),h(o,"viewBox","0 0 16 16"),h(o,"fill","currentColor"),h(o,"class","size-4"),h(i,"class",f=(n[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center"),h(r,"class","ml-1 mr-2"),h(e,"class","py-1 flex dark:text-gray-100 bg-gray-50 dark:bg-gray-800 border border-gray-100 dark:border-gray-850 w-72 rounded-full shadow-xl")},m(m,d){V(m,e,d),p(e,t),rt(t,n[3]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,a),u||(c=[ue(t,"input",n[18]),ue(t,"keydown",n[19]),ue(i,"click",n[20])],u=!0)},p(m,d){d&128&&l!==(l=m[7].t("Ask a question"))&&h(t,"placeholder",l),d&8&&t.value!==m[3]&&rt(t,m[3]),d&8&&f!==(f=(m[3]!==""?"bg-black text-white hover:bg-gray-900 dark:bg-white dark:text-black dark:hover:bg-gray-100 ":"text-white bg-gray-200 dark:text-gray-900 dark:bg-gray-700 disabled")+" transition rounded-full p-1.5 m-0.5 self-center")&&h(i,"class",f)},i:ve,o:ve,d(m){m&&g(e),u=!1,Qe(c)}}}function vo(n){let e,t,l,s,r,i=n[7].t("Ask")+"",o,a,f,u,c,m,d=n[7].t("Explain")+"",_,k,v,N;return l=new co({props:{className:"size-3 shrink-0"}}),u=new Dr({props:{className:"size-3 shrink-0"}}),{c(){e=M("div"),t=M("button"),$(l.$$.fragment),s=j(),r=M("div"),o=W(i),a=j(),f=M("button"),$(u.$$.fragment),c=j(),m=M("div"),_=W(d),this.h()},l(y){e=E(y,"DIV",{class:!0});var T=w(e);t=E(T,"BUTTON",{class:!0});var P=w(t);x(l.$$.fragment,P),s=A(P),r=E(P,"DIV",{class:!0});var R=w(r);o=q(R,i),R.forEach(g),P.forEach(g),a=A(T),f=E(T,"BUTTON",{class:!0});var I=w(f);x(u.$$.fragment,I),c=A(I),m=E(I,"DIV",{class:!0});var B=w(m);_=q(B,d),B.forEach(g),I.forEach(g),T.forEach(g),this.h()},h(){h(r,"class","shrink-0"),h(t,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(m,"class","shrink-0"),h(f,"class","px-1 hover:bg-gray-50 dark:hover:bg-gray-800 rounded-sm flex items-center gap-1 min-w-fit"),h(e,"class","flex flex-row gap-0.5 shrink-0 p-1 bg-white dark:bg-gray-850 dark:text-gray-100 text-medium rounded-lg shadow-xl")},m(y,T){V(y,e,T),p(e,t),ee(l,t,null),p(t,s),p(t,r),p(r,o),p(e,a),p(e,f),ee(u,f,null),p(f,c),p(f,m),p(m,_),k=!0,v||(N=[ue(t,"click",n[16]),ue(f,"click",n[17])],v=!0)},p(y,T){(!k||T&128)&&i!==(i=y[7].t("Ask")+"")&&Z(o,i),(!k||T&128)&&d!==(d=y[7].t("Explain")+"")&&Z(_,d)},i(y){k||(b(l.$$.fragment,y),b(u.$$.fragment,y),k=!0)},o(y){D(l.$$.fragment,y),D(u.$$.fragment,y),k=!1},d(y){y&&g(e),te(l),te(u),v=!1,Qe(N)}}}function bo(n){let e,t,l,s,r;const i=[mo,ho],o=[];function a(f,u){return f[5]===null?0:1}return t=a(n),l=o[t]=i[t](n),{c(){e=M("div"),l.c(),this.h()},l(f){e=E(f,"DIV",{id:!0,class:!0,style:!0});var u=w(e);l.l(u),u.forEach(g),this.h()},h(){h(e,"id",s=`floating-buttons-${n[0]}`),h(e,"class","absolute rounded-lg mt-1 text-xs z-9999"),St(e,"display","none")},m(f,u){V(f,e,u),o[t].m(e,null),r=!0},p(f,[u]){let c=t;t=a(f),t===c?o[t].p(f,u):(ne(),D(o[c],1,1,()=>{o[c]=null}),re(),l=o[t],l?l.p(f,u):(l=o[t]=i[t](f),l.c()),b(l,1),l.m(e,null)),(!r||u&1&&s!==(s=`floating-buttons-${f[0]}`))&&h(e,"id",s)},i(f){r||(b(l),r=!0)},o(f){D(l),r=!1},d(f){f&&g(e),o[t].d()}}}function ko(n,e,t){let l;const s=Fe("i18n");Ee(n,s,L=>t(7,l=L));let{id:r=""}=e,{model:i=null}=e,{messages:o=[]}=e,{onAdd:a=()=>{}}=e,f=!1,u="",c="",m="",d=null,_=!1;const k=async()=>{const L=document.getElementById("response-container");L.scrollHeight-L.clientHeight<=L.scrollTop+50&&(L.scrollTop=L.scrollHeight)},v=async()=>{if(!i){je.error("Model not selected");return}t(4,m=`${c}
\`\`\`
${u}
\`\`\``),t(3,c=""),t(5,d="");const[L,C]=await pl(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(O=>({role:O.role,content:O.content})),stream:!0});if(L&&L.ok){const O=L.body.getReader(),z=new TextDecoder;await(async()=>{var me,ie;for(;;){const{done:se,value:_e}=await O.read();if(se)break;const Ie=z.decode(_e,{stream:!0}).split(`
`).filter(Q=>Q.trim()!=="");for(const Q of Ie)if(Q.startsWith("data: "))if(Q.startsWith("data: [DONE]")){t(6,_=!0),await Ne(),k();continue}else try{const J=JSON.parse(Q.slice(6));J.choices&&((ie=(me=J.choices[0])==null?void 0:me.delta)!=null&&ie.content)&&(t(5,d+=J.choices[0].delta.content),k())}catch(J){console.error(J)}}})()}else je.error("An error occurred while fetching the explanation")},N=async()=>{if(!i){je.error("Model not selected");return}const L=l.t("Explain this section to me in more detail");t(4,m=`${L}

\`\`\`
${u}
\`\`\``),t(5,d="");const[C,O]=await pl(localStorage.token,{model:i,messages:[...o,{role:"user",content:m}].map(z=>({role:z.role,content:z.content})),stream:!0});if(C&&C.ok){const z=C.body.getReader(),le=new TextDecoder;await(async()=>{var ie,se;for(;;){const{done:_e,value:ge}=await z.read();if(_e)break;const Q=le.decode(ge,{stream:!0}).split(`
`).filter(J=>J.trim()!=="");for(const J of Q)if(J.startsWith("data: "))if(J.startsWith("data: [DONE]")){t(6,_=!0),await Ne(),k();continue}else try{const oe=JSON.parse(J.slice(6));oe.choices&&((se=(ie=oe.choices[0])==null?void 0:ie.delta)!=null&&se.content)&&(t(5,d+=oe.choices[0].delta.content),k())}catch(oe){console.error(oe)}}})()}else je.error("An error occurred while fetching the explanation")},y=async()=>{a({modelId:i,parentId:r,messages:[{role:"user",content:m},{role:"assistant",content:d}]})},T=()=>{t(5,d=null),t(6,_=!1),t(1,f=!1),t(3,c="")},P=async()=>{t(2,u=window.getSelection().toString()),t(1,f=!0),await Ne(),setTimeout(()=>{const L=document.getElementById("floating-message-input");L&&L.focus()},0)},R=()=>{t(2,u=window.getSelection().toString()),N()};function I(){c=this.value,t(3,c)}const B=L=>{L.key==="Enter"&&v()},S=()=>{v()};return n.$$set=L=>{"id"in L&&t(0,r=L.id),"model"in L&&t(12,i=L.model),"messages"in L&&t(13,o=L.messages),"onAdd"in L&&t(14,a=L.onAdd)},[r,f,u,c,m,d,_,l,s,v,N,y,i,o,a,T,P,R,I,B,S]}class wo extends Le{constructor(e){super(),Pe(this,e,ko,bo,Te,{id:0,model:12,messages:13,onAdd:14,closeHandler:15})}get closeHandler(){return this.$$.ctx[15]}}function ss(n){var s;let e,t,l={id:n[0],model:(s=n[3])==null?void 0:s.id,messages:Jt(n[2],n[0]),onAdd:n[20]};return e=new wo({props:l}),n[21](e),{c(){$(e.$$.fragment)},l(r){x(e.$$.fragment,r)},m(r,i){ee(e,r,i),t=!0},p(r,i){var a;const o={};i&1&&(o.id=r[0]),i&8&&(o.model=(a=r[3])==null?void 0:a.id),i&5&&(o.messages=Jt(r[2],r[0])),i&512&&(o.onAdd=r[20]),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){n[21](null),te(e,r)}}}function yo(n){let e,t,l,s,r;t=new yt({props:{id:n[0],content:n[1],model:n[3],save:n[5],sourceIds:(n[4]??[]).reduce(n[16],[]),onSourceClick:n[7],onTaskClick:n[8]}}),t.$on("update",n[17]),t.$on("code",n[18]);let i=n[6]&&n[3]&&ss(n);return{c(){e=M("div"),$(t.$$.fragment),l=j(),i&&i.c(),s=ce()},l(o){e=E(o,"DIV",{});var a=w(e);x(t.$$.fragment,a),a.forEach(g),l=A(o),i&&i.l(o),s=ce()},m(o,a){V(o,e,a),ee(t,e,null),n[19](e),V(o,l,a),i&&i.m(o,a),V(o,s,a),r=!0},p(o,[a]){const f={};a&1&&(f.id=o[0]),a&2&&(f.content=o[1]),a&8&&(f.model=o[3]),a&32&&(f.save=o[5]),a&24&&(f.sourceIds=(o[4]??[]).reduce(o[16],[])),a&128&&(f.onSourceClick=o[7]),a&256&&(f.onTaskClick=o[8]),t.$set(f),o[6]&&o[3]?i?(i.p(o,a),a&72&&b(i,1)):(i=ss(o),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(ne(),D(i,1,1,()=>{i=null}),re())},i(o){r||(b(t.$$.fragment,o),b(i),r=!0)},o(o){D(t.$$.fragment,o),D(i),r=!1},d(o){o&&(g(e),g(l),g(s)),te(t),n[19](null),i&&i.d(o)}}}function Io(n,e,t){let l,s;Ee(n,Mn,O=>t(12,l=O)),Ee(n,dr,O=>t(13,s=O)),Fe("i18n");const r=gt();let{id:i}=e,{content:o}=e,{history:a}=e,{model:f=null}=e,{sources:u=null}=e,{save:c=!1}=e,{floatingButtons:m=!0}=e,{onSourceClick:d=()=>{}}=e,{onTaskClick:_=()=>{}}=e,{onAddMessages:k=()=>{}}=e,v,N;const y=O=>{const z=document.getElementById(`floating-buttons-${i}`);if(!(v!=null&&v.contains(O.target))&&!(z!=null&&z.contains(O.target))){T();return}setTimeout(async()=>{if(await Ne(),!(v!=null&&v.contains(O.target)))return;let le=window.getSelection();if(le.toString().trim().length>0){const ie=le.getRangeAt(0).getBoundingClientRect(),se=v.getBoundingClientRect(),_e=ie.bottom-se.top,ge=ie.left-se.left;if(z){z.style.display="block";const Ie=se.width-ge;let Q=l?window.innerWidth/2:window.innerWidth/3;if(Ie<Q){const J=se.right-ie.right;z.style.right=`${J}px`,z.style.left="auto"}else z.style.left=`${ge}px`,z.style.right="auto";z.style.top=`${_e+5}px`}}else T()},0)},T=()=>{const O=document.getElementById(`floating-buttons-${i}`);O&&(O.style.display="none"),N&&typeof(N==null?void 0:N.closeHandler)=="function"&&(N==null||N.closeHandler())},P=O=>{O.key==="Escape"&&T()};bt(()=>{m&&(v==null||v.addEventListener("mouseup",y),document.addEventListener("mouseup",y),document.addEventListener("keydown",P))}),ar(()=>{m&&(v==null||v.removeEventListener("mouseup",y),document.removeEventListener("mouseup",y),document.removeEventListener("keydown",P))});const R=(O,z)=>{let le=[];return z.document.forEach((me,ie)=>{var ge,Ie,Q,J,oe;if(((Q=(Ie=(ge=f==null?void 0:f.info)==null?void 0:ge.meta)==null?void 0:Ie.capabilities)==null?void 0:Q.citations)==!1)return le.push("N/A"),le;const se=(J=z.metadata)==null?void 0:J[ie],_e=(se==null?void 0:se.source)??"N/A";return se!=null&&se.name?(le.push(se.name),le):(_e.startsWith("http://")||_e.startsWith("https://")?le.push(_e):le.push(((oe=z==null?void 0:z.source)==null?void 0:oe.name)??_e),le)}),O=[...O,...le],O.filter((me,ie)=>O.indexOf(me)===ie)},I=O=>{r("update",O.detail)},B=O=>{const{lang:z,code:le}=O.detail;(["html","svg"].includes(z)||z==="xml"&&le.includes("svg"))&&!l&&s&&(hr.set(!0),mr.set(!0))};function S(O){Ae[O?"unshift":"push"](()=>{v=O,t(10,v)})}const L=({modelId:O,parentId:z,messages:le})=>{console.log(O,z,le),k({modelId:O,parentId:z,messages:le}),T()};function C(O){Ae[O?"unshift":"push"](()=>{N=O,t(11,N)})}return n.$$set=O=>{"id"in O&&t(0,i=O.id),"content"in O&&t(1,o=O.content),"history"in O&&t(2,a=O.history),"model"in O&&t(3,f=O.model),"sources"in O&&t(4,u=O.sources),"save"in O&&t(5,c=O.save),"floatingButtons"in O&&t(6,m=O.floatingButtons),"onSourceClick"in O&&t(7,d=O.onSourceClick),"onTaskClick"in O&&t(8,_=O.onTaskClick),"onAddMessages"in O&&t(9,k=O.onAddMessages)},[i,o,a,f,u,c,m,d,_,k,v,N,l,s,r,T,R,I,B,S,L,C]}class Mo extends Le{constructor(e){super(),Pe(this,e,Io,yo,Te,{id:0,content:1,history:2,model:3,sources:4,save:5,floatingButtons:6,onSourceClick:7,onTaskClick:8,onAddMessages:9})}}function ns(n,e,t){const l=n.slice();return l[86]=e[t],l}function Wt(n){var l,s,r;const e=n.slice(),t=(((l=e[13])==null?void 0:l.statusHistory)??[...(s=e[13])!=null&&s.status?[(r=e[13])==null?void 0:r.status]:[]]).at(-1);return e[89]=t,e}function rs(n,e,t){const l=n.slice();return l[90]=e[t],l}function Eo(n){var s;let e,t=(((s=n[17])==null?void 0:s.name)??n[13].model)+"",l;return{c(){e=M("span"),l=W(t),this.h()},l(r){e=E(r,"SPAN",{class:!0});var i=w(e);l=q(i,t),i.forEach(g),this.h()},h(){h(e,"class","line-clamp-1 text-black dark:text-white")},m(r,i){V(r,e,i),p(e,l)},p(r,i){var o;i[0]&139264&&t!==(t=(((o=r[17])==null?void 0:o.name)??r[13].model)+"")&&Z(l,t)},d(r){r&&g(e)}}}function is(n){let e,t,l;return t=new Be({props:{content:it(n[13].timestamp*1e3).format("LLLL"),$$slots:{default:[No]},$$scope:{ctx:n}}}),{c(){e=M("div"),$(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);x(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&8192&&(i.content=it(s[13].timestamp*1e3).format("LLLL")),r[0]&8192|r[3]&1&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function No(n){let e,t=Pt(n[13].timestamp*1e3)+"",l;return{c(){e=M("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&8192&&t!==(t=Pt(s[13].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&g(e)}}}function Do(n){var i;let e,t,l,s;e=new Be({props:{content:((i=n[17])==null?void 0:i.name)??n[13].model,placement:"top-start",$$slots:{default:[Eo]},$$scope:{ctx:n}}});let r=n[13].timestamp&&is(n);return{c(){$(e.$$.fragment),t=j(),r&&r.c(),l=ce()},l(o){x(e.$$.fragment,o),t=A(o),r&&r.l(o),l=ce()},m(o,a){ee(e,o,a),V(o,t,a),r&&r.m(o,a),V(o,l,a),s=!0},p(o,a){var u;const f={};a[0]&139264&&(f.content=((u=o[17])==null?void 0:u.name)??o[13].model),a[0]&139264|a[3]&1&&(f.$$scope={dirty:a,ctx:o}),e.$set(f),o[13].timestamp?r?(r.p(o,a),a[0]&8192&&b(r,1)):(r=is(o),r.c(),b(r,1),r.m(l.parentNode,l)):r&&(ne(),D(r,1,1,()=>{r=null}),re())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){D(e.$$.fragment,o),D(r),s=!1},d(o){o&&(g(t),g(l)),te(e,o),r&&r.d(o)}}}function os(n){let e,t,l=De(n[13].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=fs(rs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),this.h()},h(){h(e,"class","my-2.5 w-full flex overflow-x-auto gap-2 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&8192){l=De(i[13].files);let a;for(a=0;a<l.length;a+=1){const f=rs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=fs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(ne(),a=l.length;a<s.length;a+=1)r(a);re()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&g(e),qe(s,i)}}}function as(n){let e,t;return e=new Tn({props:{src:n[90].url,alt:n[13].content}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.src=l[90].url),s[0]&8192&&(r.alt=l[13].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function fs(n){let e,t,l,s=n[90].type==="image"&&as(n);return{c(){e=M("div"),s&&s.c(),t=j()},l(r){e=E(r,"DIV",{});var i=w(e);s&&s.l(i),t=A(i),i.forEach(g)},m(r,i){V(r,e,i),s&&s.m(e,null),p(e,t),l=!0},p(r,i){r[90].type==="image"?s?(s.p(r,i),i[0]&8192&&b(s,1)):(s=as(r),s.c(),b(s,1),s.m(e,t)):s&&(ne(),D(s,1,1,()=>{s=null}),re())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(e),s&&s.d()}}}function us(n){var s;let e,t,l=!((s=n[89])!=null&&s.hidden)&&cs(n);return{c(){l&&l.c(),e=ce()},l(r){l&&l.l(r),e=ce()},m(r,i){l&&l.m(r,i),V(r,e,i),t=!0},p(r,i){var o;(o=r[89])!=null&&o.hidden?l&&(ne(),D(l,1,1,()=>{l=null}),re()):l?(l.p(r,i),i[0]&8192&&b(l,1)):(l=cs(r),l.c(),b(l,1),l.m(e.parentNode,e))},i(r){t||(b(l),t=!0)},o(r){D(l),t=!1},d(r){r&&g(e),l&&l.d(r)}}}function cs(n){var u;let e,t,l,s,r,i=((u=n[89])==null?void 0:u.done)===!1&&ds();const o=[To,Co,Vo],a=[];function f(c,m){var d,_,k;return((d=c[89])==null?void 0:d.action)==="web_search"&&((_=c[89])!=null&&_.urls)?0:((k=c[89])==null?void 0:k.action)==="knowledge_search"?1:2}return l=f(n),s=a[l]=o[l](n),{c(){e=M("div"),i&&i.c(),t=j(),s.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);i&&i.l(m),t=A(m),s.l(m),m.forEach(g),this.h()},h(){h(e,"class","status-description flex items-center gap-2 py-0.5")},m(c,m){V(c,e,m),i&&i.m(e,null),p(e,t),a[l].m(e,null),r=!0},p(c,m){var _;((_=c[89])==null?void 0:_.done)===!1?i?m[0]&8192&&b(i,1):(i=ds(),i.c(),b(i,1),i.m(e,t)):i&&(ne(),D(i,1,1,()=>{i=null}),re());let d=l;l=f(c),l===d?a[l].p(c,m):(ne(),D(a[d],1,1,()=>{a[d]=null}),re(),s=a[l],s?s.p(c,m):(s=a[l]=o[l](c),s.c()),b(s,1),s.m(e,null))},i(c){r||(b(i),b(s),r=!0)},o(c){D(i),D(s),r=!1},d(c){c&&g(e),i&&i.d(),a[l].d()}}}function ds(n){let e,t,l;return t=new Ut({props:{className:"size-4"}}),{c(){e=M("div"),$(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);x(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","")},m(s,r){V(s,e,r),ee(t,e,null),l=!0},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function Vo(n){let e,t,l,s;function r(a,f){var u,c,m;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[89])!=null&&u.description.includes("{{searchQuery}}"))),l?Oo:((c=a[89])==null?void 0:c.description)==="No search query generated"?So:((m=a[89])==null?void 0:m.description)==="Generating search query"?Ro:Bo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);t=E(f,"DIV",{class:!0});var u=w(t);o.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var a;h(t,"class",s=(((a=n[89])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[89])==null?void 0:u.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",s)},i:ve,o:ve,d(a){a&&g(e),o.d()}}}function Co(n){let e,t,l=n[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:n[89].query})+"",s,r;return{c(){e=M("div"),t=M("div"),s=W(l),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);t=E(o,"DIV",{class:!0});var a=w(t);s=q(a,l),a.forEach(g),o.forEach(g),this.h()},h(){var i;h(t,"class",r=(((i=n[89])==null?void 0:i.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(i,o){V(i,e,o),p(e,t),p(t,s)},p(i,o){var a;o[0]&268443648&&l!==(l=i[28].t('Searching Knowledge for "{{searchQuery}}"',{searchQuery:i[89].query})+"")&&Z(s,l),o[0]&8192&&r!==(r=(((a=i[89])==null?void 0:a.done)===!1?"shimmer":"")+" text-gray-500 dark:text-gray-500 text-base line-clamp-1 text-wrap")&&h(t,"class",r)},i:ve,o:ve,d(i){i&&g(e)}}}function To(n){let e,t;return e=new di({props:{status:n[89],$$slots:{default:[Ao]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.status=l[89]),s[0]&268443648|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Bo(n){var l;let e=((l=n[89])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[89])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&g(t)}}}function Ro(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&Z(t,e)},d(l){l&&g(t)}}}function So(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Oo(n){var l,s;let e=n[28].t((l=n[89])==null?void 0:l.description,{searchQuery:(s=n[89])==null?void 0:s.query})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[89])==null?void 0:o.description,{searchQuery:(a=r[89])==null?void 0:a.query})+"")&&Z(t,e)},d(r){r&&g(t)}}}function Lo(n){var l;let e=((l=n[89])==null?void 0:l.description)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r[0]&8192&&e!==(e=((i=s[89])==null?void 0:i.description)+"")&&Z(t,e)},d(s){s&&g(t)}}}function Po(n){let e=n[28].t("Generating search query")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("Generating search query")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Ho(n){let e=n[28].t("No search query generated")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&268435456&&e!==(e=l[28].t("No search query generated")+"")&&Z(t,e)},d(l){l&&g(t)}}}function jo(n){var l,s;let e=n[28].t((l=n[89])==null?void 0:l.description,{count:(s=n[89])==null?void 0:s.urls.length})+"",t;return{c(){t=W(e)},l(r){t=q(r,e)},m(r,i){V(r,t,i)},p(r,i){var o,a;i[0]&268443648&&e!==(e=r[28].t((o=r[89])==null?void 0:o.description,{count:(a=r[89])==null?void 0:a.urls.length})+"")&&Z(t,e)},d(r){r&&g(t)}}}function Ao(n){let e,t,l,s;function r(a,f){var u,c,m;return f[0]&8192&&(l=null),l==null&&(l=!!((u=a[89])!=null&&u.description.includes("{{count}}"))),l?jo:((c=a[89])==null?void 0:c.description)==="No search query generated"?Ho:((m=a[89])==null?void 0:m.description)==="Generating search query"?Po:Lo}let i=r(n,[-1,-1,-1,-1]),o=i(n);return{c(){e=M("div"),t=M("div"),o.c(),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);t=E(f,"DIV",{class:!0});var u=w(t);o.l(u),u.forEach(g),f.forEach(g),this.h()},h(){var a;h(t,"class",s=(((a=n[89])==null?void 0:a.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap"),h(e,"class","flex flex-col justify-center -space-y-0.5")},m(a,f){V(a,e,f),p(e,t),o.m(t,null)},p(a,f){var u;i===(i=r(a,f))&&o?o.p(a,f):(o.d(1),o=i(a),o&&(o.c(),o.m(t,null))),f[0]&8192&&s!==(s=(((u=a[89])==null?void 0:u.done)===!1?"shimmer":"")+" text-base line-clamp-1 text-wrap")&&h(t,"class",s)},d(a){a&&g(e),o.d()}}}function zo(n){var _,k,v,N,y,T,P;let e,t,l,s,r,i,o;const a=[qo,Wo],f=[];function u(R,I){return R[13].content===""&&!R[13].error?0:R[13].content&&R[13].error!==!0?1:-1}~(t=u(n))&&(l=f[t]=a[t](n));let c=((_=n[13])==null?void 0:_.error)&&hs(n),m=(((k=n[13])==null?void 0:k.sources)||((v=n[13])==null?void 0:v.citations))&&(((P=(T=(y=(N=n[17])==null?void 0:N.info)==null?void 0:y.meta)==null?void 0:T.capabilities)==null?void 0:P.citations)??!0)&&ms(n),d=n[13].code_executions&&gs(n);return{c(){e=M("div"),l&&l.c(),s=j(),c&&c.c(),r=j(),m&&m.c(),i=j(),d&&d.c(),this.h()},l(R){e=E(R,"DIV",{class:!0,id:!0});var I=w(e);l&&l.l(I),s=A(I),c&&c.l(I),r=A(I),m&&m.l(I),i=A(I),d&&d.l(I),I.forEach(g),this.h()},h(){h(e,"class","w-full flex flex-col relative"),h(e,"id","response-content-container")},m(R,I){V(R,e,I),~t&&f[t].m(e,null),p(e,s),c&&c.m(e,null),p(e,r),m&&m.m(e,null),p(e,i),d&&d.m(e,null),o=!0},p(R,I){var S,L,C,O,z,le,me;let B=t;t=u(R),t===B?~t&&f[t].p(R,I):(l&&(ne(),D(f[B],1,1,()=>{f[B]=null}),re()),~t?(l=f[t],l?l.p(R,I):(l=f[t]=a[t](R),l.c()),b(l,1),l.m(e,s)):l=null),(S=R[13])!=null&&S.error?c?(c.p(R,I),I[0]&8192&&b(c,1)):(c=hs(R),c.c(),b(c,1),c.m(e,r)):c&&(ne(),D(c,1,1,()=>{c=null}),re()),((L=R[13])!=null&&L.sources||(C=R[13])!=null&&C.citations)&&(((me=(le=(z=(O=R[17])==null?void 0:O.info)==null?void 0:z.meta)==null?void 0:le.capabilities)==null?void 0:me.citations)??!0)?m?(m.p(R,I),I[0]&139264&&b(m,1)):(m=ms(R),m.c(),b(m,1),m.m(e,i)):m&&(ne(),D(m,1,1,()=>{m=null}),re()),R[13].code_executions?d?(d.p(R,I),I[0]&8192&&b(d,1)):(d=gs(R),d.c(),b(d,1),d.m(e,null)):d&&(ne(),D(d,1,1,()=>{d=null}),re())},i(R){o||(b(l),b(c),b(m),b(d),o=!0)},o(R){D(l),D(c),D(m),D(d),o=!1},d(R){R&&g(e),~t&&f[t].d(),c&&c.d(),m&&m.d(),d&&d.d()}}}function Uo(n){let e,t,l,s,r,i,o,a=n[28].t("Save As Copy")+"",f,u,c,m,d=n[28].t("Cancel")+"",_,k,v,N=n[28].t("Save")+"",y,T,P;return{c(){e=M("div"),t=M("textarea"),s=j(),r=M("div"),i=M("div"),o=M("button"),f=W(a),u=j(),c=M("div"),m=M("button"),_=W(d),k=j(),v=M("button"),y=W(N),this.h()},l(R){e=E(R,"DIV",{class:!0});var I=w(e);t=E(I,"TEXTAREA",{id:!0,class:!0}),w(t).forEach(g),s=A(I),r=E(I,"DIV",{class:!0});var B=w(r);i=E(B,"DIV",{});var S=w(i);o=E(S,"BUTTON",{id:!0,class:!0});var L=w(o);f=q(L,a),L.forEach(g),S.forEach(g),u=A(B),c=E(B,"DIV",{class:!0});var C=w(c);m=E(C,"BUTTON",{id:!0,class:!0});var O=w(m);_=q(O,d),O.forEach(g),k=A(C),v=E(C,"BUTTON",{id:!0,class:!0});var z=w(v);y=q(z,N),z.forEach(g),C.forEach(g),B.forEach(g),I.forEach(g),this.h()},h(){h(t,"id",l="message-edit-"+n[13].id),h(t,"class","bg-transparent outline-hidden w-full resize-none"),h(o,"id","save-new-message-button"),h(o,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(m,"id","close-edit-message-button"),h(m,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(v,"id","confirm-edit-message-button"),h(v,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(c,"class","flex space-x-1.5"),h(r,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 my-2")},m(R,I){V(R,e,I),p(e,t),n[51](t),rt(t,n[18]),p(e,s),p(e,r),p(r,i),p(i,o),p(o,f),p(r,u),p(r,c),p(c,m),p(m,_),p(c,k),p(c,v),p(v,y),T||(P=[ue(t,"input",n[52]),ue(t,"input",ca),ue(t,"keydown",n[53]),ue(o,"click",n[54]),ue(m,"click",n[55]),ue(v,"click",n[56])],T=!0)},p(R,I){I[0]&8192&&l!==(l="message-edit-"+R[13].id)&&h(t,"id",l),I[0]&262144&&rt(t,R[18]),I[0]&268435456&&a!==(a=R[28].t("Save As Copy")+"")&&Z(f,a),I[0]&268435456&&d!==(d=R[28].t("Cancel")+"")&&Z(_,d),I[0]&268435456&&N!==(N=R[28].t("Save")+"")&&Z(y,N)},i:ve,o:ve,d(R){R&&g(e),n[51](null),T=!1,Qe(P)}}}function Wo(n){var l;let e,t;return e=new Mo({props:{id:n[13].id,history:n[0],content:n[13].content,sources:n[13].sources,floatingButtons:((l=n[13])==null?void 0:l.done)&&!n[12],save:!n[12],model:n[17],onTaskClick:n[57],onSourceClick:n[58],onAddMessages:n[59]}}),e.$on("update",n[60]),e.$on("select",n[61]),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&8192&&(i.id=s[13].id),r[0]&1&&(i.history=s[0]),r[0]&8192&&(i.content=s[13].content),r[0]&8192&&(i.sources=s[13].sources),r[0]&12288&&(i.floatingButtons=((o=s[13])==null?void 0:o.done)&&!s[12]),r[0]&4096&&(i.save=!s[12]),r[0]&131072&&(i.model=s[17]),r[0]&8192&&(i.onSourceClick=s[58]),r[0]&1024&&(i.onAddMessages=s[59]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function qo(n){let e,t;return e=new Yt({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function hs(n){var l,s;let e,t;return e=new vi({props:{content:((s=(l=n[13])==null?void 0:l.error)==null?void 0:s.content)??n[13].content}}),{c(){$(e.$$.fragment)},l(r){x(e.$$.fragment,r)},m(r,i){ee(e,r,i),t=!0},p(r,i){var a,f;const o={};i[0]&8192&&(o.content=((f=(a=r[13])==null?void 0:a.error)==null?void 0:f.content)??r[13].content),e.$set(o)},i(r){t||(b(e.$$.fragment,r),t=!0)},o(r){D(e.$$.fragment,r),t=!1},d(r){te(e,r)}}}function ms(n){var l,s,r;let e,t;return e=new Ji({props:{id:(l=n[13])==null?void 0:l.id,sources:((s=n[13])==null?void 0:s.sources)??((r=n[13])==null?void 0:r.citations)}}),{c(){$(e.$$.fragment)},l(i){x(e.$$.fragment,i)},m(i,o){ee(e,i,o),t=!0},p(i,o){var f,u,c;const a={};o[0]&8192&&(a.id=(f=i[13])==null?void 0:f.id),o[0]&8192&&(a.sources=((u=i[13])==null?void 0:u.sources)??((c=i[13])==null?void 0:c.citations)),e.$set(a)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){D(e.$$.fragment,i),t=!1},d(i){te(e,i)}}}function gs(n){let e,t;return e=new ao({props:{codeExecutions:n[13].code_executions}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.codeExecutions=l[13].code_executions),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function _s(n){let e,t,l,s,r=(n[13].done||n[1].length>1)&&ps(n),i=n[13].done&&n[24]&&Ts(n);return{c(){e=M("div"),r&&r.c(),t=j(),i&&i.c(),l=ce(),this.h()},l(o){e=E(o,"DIV",{class:!0});var a=w(e);r&&r.l(a),a.forEach(g),t=A(o),i&&i.l(o),l=ce(),this.h()},h(){h(e,"class","flex justify-start overflow-x-auto buttons text-gray-600 dark:text-gray-500 mt-0.5 svelte-1u5gq5j")},m(o,a){V(o,e,a),r&&r.m(e,null),n[78](e),V(o,t,a),i&&i.m(o,a),V(o,l,a),s=!0},p(o,a){o[13].done||o[1].length>1?r?(r.p(o,a),a[0]&8194&&b(r,1)):(r=ps(o),r.c(),b(r,1),r.m(e,null)):r&&(ne(),D(r,1,1,()=>{r=null}),re()),o[13].done&&o[24]?i?(i.p(o,a),a[0]&16785408&&b(i,1)):(i=Ts(o),i.c(),b(i,1),i.m(l.parentNode,l)):i&&(ne(),D(i,1,1,()=>{i=null}),re())},i(o){s||(b(r),b(i),s=!0)},o(o){D(r),D(i),s=!1},d(o){o&&(g(e),g(t),g(l)),r&&r.d(),n[78](null),i&&i.d(o)}}}function ps(n){let e,t,l,s=n[1].length>1&&vs(n),r=n[13].done&&bs(n);return{c(){s&&s.c(),e=j(),r&&r.c(),t=ce()},l(i){s&&s.l(i),e=A(i),r&&r.l(i),t=ce()},m(i,o){s&&s.m(i,o),V(i,e,o),r&&r.m(i,o),V(i,t,o),l=!0},p(i,o){i[1].length>1?s?s.p(i,o):(s=vs(i),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),i[13].done?r?(r.p(i,o),o[0]&8192&&b(r,1)):(r=bs(i),r.c(),b(r,1),r.m(t.parentNode,t)):r&&(ne(),D(r,1,1,()=>{r=null}),re())},i(i){l||(b(r),l=!0)},o(i){D(r),l=!1},d(i){i&&(g(e),g(t)),s&&s.d(i),r&&r.d(i)}}}function vs(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[20]?Jo:Fo}let c=u(n),m=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=M("button"),i.innerHTML=o,this.h()},l(d){e=E(d,"DIV",{class:!0,dir:!0});var _=w(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-1e0chv1"&&(t.innerHTML=l),s=A(_),m.l(_),r=A(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-107ksnk"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center min-w-fit"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[62]),ue(i,"click",n[66])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Qe(f)}}}function Fo(n){let e,t=n[1].indexOf(n[13].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[65]),o=!0)},p(f,u){u[0]&8194&&t!==(t=f[1].indexOf(f[13].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&g(e),o=!1,a()}}}function Jo(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=W("/"),a=W(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);t=E(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(m,"/"),a=q(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[13].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[13].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",da),ue(t,"blur",n[63]),ue(t,"keydown",n[64])],f=!0)},p(c,m){m[0]&8192&&l!==(l="message-index-input-"+c[13].id)&&h(t,"id",l),m[0]&8194&&s!==(s=c[1].indexOf(c[13].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&g(e),f=!1,Qe(u)}}}function bs(n){var _,k,v,N;let e,t,l,s,r,i,o,a,f,u=!n[12]&&ks(n);t=new Be({props:{content:n[28].t("Copy"),placement:"bottom",$$slots:{default:[Zo]},$$scope:{ctx:n}}}),s=new Be({props:{content:n[28].t("Read Aloud"),placement:"bottom",$$slots:{default:[Xo]},$$scope:{ctx:n}}});let c=((_=n[27])==null?void 0:_.features.enable_image_generation)&&(n[29].role==="admin"||((N=(v=(k=n[29])==null?void 0:k.permissions)==null?void 0:v.features)==null?void 0:N.image_generation))&&!n[12]&&ys(n),m=n[13].usage&&Is(n),d=!n[12]&&Ms(n);return{c(){u&&u.c(),e=j(),$(t.$$.fragment),l=j(),$(s.$$.fragment),r=j(),c&&c.c(),i=j(),m&&m.c(),o=j(),d&&d.c(),a=ce()},l(y){u&&u.l(y),e=A(y),x(t.$$.fragment,y),l=A(y),x(s.$$.fragment,y),r=A(y),c&&c.l(y),i=A(y),m&&m.l(y),o=A(y),d&&d.l(y),a=ce()},m(y,T){u&&u.m(y,T),V(y,e,T),ee(t,y,T),V(y,l,T),ee(s,y,T),V(y,r,T),c&&c.m(y,T),V(y,i,T),m&&m.m(y,T),V(y,o,T),d&&d.m(y,T),V(y,a,T),f=!0},p(y,T){var I,B,S,L;y[12]?u&&(ne(),D(u,1,1,()=>{u=null}),re()):u?(u.p(y,T),T[0]&4096&&b(u,1)):(u=ks(y),u.c(),b(u,1),u.m(e.parentNode,e));const P={};T[0]&268435456&&(P.content=y[28].t("Copy")),T[0]&10240|T[3]&1&&(P.$$scope={dirty:T,ctx:y}),t.$set(P);const R={};T[0]&268435456&&(R.content=y[28].t("Read Aloud")),T[0]&6301696|T[3]&1&&(R.$$scope={dirty:T,ctx:y}),s.$set(R),(I=y[27])!=null&&I.features.enable_image_generation&&(y[29].role==="admin"||(L=(S=(B=y[29])==null?void 0:B.permissions)==null?void 0:S.features)!=null&&L.image_generation)&&!y[12]?c?(c.p(y,T),T[0]&671092736&&b(c,1)):(c=ys(y),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(ne(),D(c,1,1,()=>{c=null}),re()),y[13].usage?m?(m.p(y,T),T[0]&8192&&b(m,1)):(m=Is(y),m.c(),b(m,1),m.m(o.parentNode,o)):m&&(ne(),D(m,1,1,()=>{m=null}),re()),y[12]?d&&(ne(),D(d,1,1,()=>{d=null}),re()):d?(d.p(y,T),T[0]&4096&&b(d,1)):(d=Ms(y),d.c(),b(d,1),d.m(a.parentNode,a))},i(y){f||(b(u),b(t.$$.fragment,y),b(s.$$.fragment,y),b(c),b(m),b(d),f=!0)},o(y){D(u),D(t.$$.fragment,y),D(s.$$.fragment,y),D(c),D(m),D(d),f=!1},d(y){y&&(g(e),g(l),g(r),g(i),g(o),g(a)),u&&u.d(y),te(t,y),te(s,y),c&&c.d(y),m&&m.d(y),d&&d.d(y)}}}function ks(n){var s,r,i;let e,t,l=(n[29].role==="user"?((i=(r=(s=n[29])==null?void 0:s.permissions)==null?void 0:r.chat)==null?void 0:i.edit)??!0:!0)&&ws(n);return{c(){l&&l.c(),e=ce()},l(o){l&&l.l(o),e=ce()},m(o,a){l&&l.m(o,a),V(o,e,a),t=!0},p(o,a){var f,u,c;o[29].role!=="user"||(((c=(u=(f=o[29])==null?void 0:f.permissions)==null?void 0:u.chat)==null?void 0:c.edit)??!0)?l?(l.p(o,a),a[0]&536870912&&b(l,1)):(l=ws(o),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ne(),D(l,1,1,()=>{l=null}),re())},i(o){t||(b(l),t=!0)},o(o){D(l),t=!1},d(o){o&&g(e),l&&l.d(o)}}}function ws(n){let e,t;return e=new Be({props:{content:n[28].t("Edit"),placement:"bottom",$$slots:{default:[Go]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Edit")),s[0]&2048|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Go(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=w(e);t=we(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=we(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[67]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Zo(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=w(e);t=we(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=we(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[68]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition copy-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Ko(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M19.114 5.636a9 9 0 010 12.728M16.463 8.288a5.25 5.25 0 010 7.424M6.75 8.25l4.72-4.72a.75.75 0 011.28.53v15.88a.75.75 0 01-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 012.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function Qo(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function Yo(n){let e,t,l,s,r,i;return{c(){e=ke("svg"),t=ke("style"),l=W(`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),s=ke("circle"),r=ke("circle"),i=ke("circle"),this.h()},l(o){e=we(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=w(e);t=we(a,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {
														animation: spinner_MGfb 0.8s linear infinite;
														animation-delay: -0.8s;
													}

													.spinner_Km9P {
														animation-delay: -0.65s;
													}

													.spinner_JApP {
														animation-delay: -0.5s;
													}

													@keyframes spinner_MGfb {
														93.75%,
														100% {
															opacity: 0.2;
														}
													}
												`),f.forEach(g),s=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(g),r=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(g),i=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(g),a.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&g(e)}}}function Xo(n){let e,t,l,s,r;function i(f,u){return f[22]?Yo:f[21]?Qo:Ko}let o=i(n),a=o(n);return{c(){e=M("button"),a.c(),this.h()},l(f){e=E(f,"BUTTON",{id:!0,class:!0});var u=w(e);a.l(u),u.forEach(g),this.h()},h(){h(e,"id",t="speak-button-"+n[13].id),h(e,"class",l=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(f,u){V(f,e,u),a.m(e,null),s||(r=ue(e,"click",n[69]),s=!0)},p(f,u){o!==(o=i(f))&&(a.d(1),a=o(f),a&&(a.c(),a.m(e,null))),u[0]&8192&&t!==(t="speak-button-"+f[13].id)&&h(e,"id",t),u[0]&2048&&l!==(l=(f[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",l)},d(f){f&&g(e),a.d(),s=!1,r()}}}function ys(n){let e,t;return e=new Be({props:{content:n[28].t("Generate Image"),placement:"bottom",$$slots:{default:[ea]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Generate Image")),s[0]&8398848|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function $o(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width","2.3"),h(e,"stroke","currentColor"),h(e,"class","w-4 h-4")},m(l,s){V(l,e,s),p(e,t)},d(l){l&&g(e)}}}function xo(n){let e,t,l,s,r,i;return{c(){e=ke("svg"),t=ke("style"),l=W(`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),s=ke("circle"),r=ke("circle"),i=ke("circle"),this.h()},l(o){e=we(o,"svg",{class:!0,fill:!0,viewBox:!0,xmlns:!0});var a=w(e);t=we(a,"style",{});var f=w(t);l=q(f,`.spinner_S1WN {
															animation: spinner_MGfb 0.8s linear infinite;
															animation-delay: -0.8s;
														}

														.spinner_Km9P {
															animation-delay: -0.65s;
														}

														.spinner_JApP {
															animation-delay: -0.5s;
														}

														@keyframes spinner_MGfb {
															93.75%,
															100% {
																opacity: 0.2;
															}
														}
													`),f.forEach(g),s=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(s).forEach(g),r=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(r).forEach(g),i=we(a,"circle",{class:!0,cx:!0,cy:!0,r:!0}),w(i).forEach(g),a.forEach(g),this.h()},h(){h(s,"class","spinner_S1WN"),h(s,"cx","4"),h(s,"cy","12"),h(s,"r","3"),h(r,"class","spinner_S1WN spinner_Km9P"),h(r,"cx","12"),h(r,"cy","12"),h(r,"r","3"),h(i,"class","spinner_S1WN spinner_JApP"),h(i,"cx","20"),h(i,"cy","12"),h(i,"r","3"),h(e,"class","w-4 h-4"),h(e,"fill","currentColor"),h(e,"viewBox","0 0 24 24"),h(e,"xmlns","http://www.w3.org/2000/svg")},m(o,a){V(o,e,a),p(e,t),p(t,l),p(e,s),p(e,r),p(e,i)},d(o){o&&g(e)}}}function ea(n){let e,t,l,s;function r(a,f){return a[23]?xo:$o}let i=r(n),o=i(n);return{c(){e=M("button"),o.c(),this.h()},l(a){e=E(a,"BUTTON",{class:!0});var f=w(e);o.l(f),f.forEach(g),this.h()},h(){h(e,"class",t=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(a,f){V(a,e,f),o.m(e,null),l||(s=ue(e,"click",n[70]),l=!0)},p(a,f){i!==(i=r(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null))),f[0]&2048&&t!==(t=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")&&h(e,"class",t)},d(a){a&&g(e),o.d(),l=!1,s()}}}function Is(n){let e,t;return e=new Be({props:{content:n[13].usage?`<pre>${vt(JSON.stringify(n[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:"",placement:"bottom",$$slots:{default:[ta]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].usage?`<pre>${vt(JSON.stringify(l[13].usage,null,2).replace(/"([^(")"]+)":/g,"$1:").slice(1,-1).split(`
`).map(Ss).map(Os).join(`
`))}</pre>`:""),s[0]&10240|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ta(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(a){e=E(a,"BUTTON",{class:!0,id:!0});var f=w(e);t=we(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap"),h(e,"id",r="info-"+n[13].id)},m(a,f){V(a,e,f),p(e,t),p(t,l),i||(o=ue(e,"click",n[71]),i=!0)},p(a,f){f[0]&2048&&s!==(s=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition whitespace-pre-wrap")&&h(e,"class",s),f[0]&8192&&r!==(r="info-"+a[13].id)&&h(e,"id",r)},d(a){a&&g(e),i=!1,o()}}}function Ms(n){var m;let e,t,l,s,r,i,o,a=!n[30]&&(((m=n[27])==null?void 0:m.features.enable_message_rating)??!0)&&Es(n),f=n[11]&&Ns(n);l=new Be({props:{content:n[28].t("Regenerate"),placement:"bottom",$$slots:{default:[ra]},$$scope:{ctx:n}}});let u=n[1].length>1&&Ds(n),c=n[11]&&Vs(n);return{c(){a&&a.c(),e=j(),f&&f.c(),t=j(),$(l.$$.fragment),s=j(),u&&u.c(),r=j(),c&&c.c(),i=ce()},l(d){a&&a.l(d),e=A(d),f&&f.l(d),t=A(d),x(l.$$.fragment,d),s=A(d),u&&u.l(d),r=A(d),c&&c.l(d),i=ce()},m(d,_){a&&a.m(d,_),V(d,e,_),f&&f.m(d,_),V(d,t,_),ee(l,d,_),V(d,s,_),u&&u.m(d,_),V(d,r,_),c&&c.m(d,_),V(d,i,_),o=!0},p(d,_){var v;!d[30]&&(((v=d[27])==null?void 0:v.features.enable_message_rating)??!0)?a?(a.p(d,_),_[0]&1207959552&&b(a,1)):(a=Es(d),a.c(),b(a,1),a.m(e.parentNode,e)):a&&(ne(),D(a,1,1,()=>{a=null}),re()),d[11]?f?(f.p(d,_),_[0]&2048&&b(f,1)):(f=Ns(d),f.c(),b(f,1),f.m(t.parentNode,t)):f&&(ne(),D(f,1,1,()=>{f=null}),re());const k={};_[0]&268435456&&(k.content=d[28].t("Regenerate")),_[0]&16919040|_[3]&1&&(k.$$scope={dirty:_,ctx:d}),l.$set(k),d[1].length>1?u?(u.p(d,_),_[0]&2&&b(u,1)):(u=Ds(d),u.c(),b(u,1),u.m(r.parentNode,r)):u&&(ne(),D(u,1,1,()=>{u=null}),re()),d[11]?c?(c.p(d,_),_[0]&2048&&b(c,1)):(c=Vs(d),c.c(),b(c,1),c.m(i.parentNode,i)):c&&(ne(),D(c,1,1,()=>{c=null}),re())},i(d){o||(b(a),b(f),b(l.$$.fragment,d),b(u),b(c),o=!0)},o(d){D(a),D(f),D(l.$$.fragment,d),D(u),D(c),o=!1},d(d){d&&(g(e),g(t),g(s),g(r),g(i)),a&&a.d(d),f&&f.d(d),te(l,d),u&&u.d(d),c&&c.d(d)}}}function Es(n){let e,t,l,s;return e=new Be({props:{content:n[28].t("Good Response"),placement:"bottom",$$slots:{default:[la]},$$scope:{ctx:n}}}),l=new Be({props:{content:n[28].t("Bad Response"),placement:"bottom",$$slots:{default:[sa]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment),t=j(),$(l.$$.fragment)},l(r){x(e.$$.fragment,r),t=A(r),x(l.$$.fragment,r)},m(r,i){ee(e,r,i),V(r,t,i),ee(l,r,i),s=!0},p(r,i){const o={};i[0]&268435456&&(o.content=r[28].t("Good Response")),i[0]&33564672|i[3]&1&&(o.$$scope={dirty:i,ctx:r}),e.$set(o);const a={};i[0]&268435456&&(a.content=r[28].t("Bad Response")),i[0]&33564672|i[3]&1&&(a.$$scope={dirty:i,ctx:r}),l.$set(a)},i(r){s||(b(e.$$.fragment,r),b(l.$$.fragment,r),s=!0)},o(r){D(e.$$.fragment,r),D(l.$$.fragment,r),s=!1},d(r){r&&g(t),te(e,r),te(l,r)}}}function la(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=w(e);t=we(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=we(f,"path",{d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){var o,a;h(l,"d","M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[72]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&g(e),r=!1,i()}}}function sa(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{class:!0});var a=w(e);t=we(a,"svg",{stroke:!0,fill:!0,"stroke-width":!0,viewBox:!0,"stroke-linecap":!0,"stroke-linejoin":!0,class:!0,xmlns:!0});var f=w(t);l=we(f,"path",{d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){var o,a;h(l,"d","M10 15v4a3 3 0 0 0 3 3l4-9V2H5.72a2 2 0 0 0-2 1.7l-1.38 9a2 2 0 0 0 2 2.3zm7-13h2.67A2.31 2.31 0 0 1 22 4v7a2.31 2.31 0 0 1-2.33 2H17"),h(t,"stroke","currentColor"),h(t,"fill","none"),h(t,"stroke-width","2.3"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"class","w-4 h-4"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((a=(o=n[13])==null?void 0:o.annotation)==null?void 0:a.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent"),e.disabled=n[25]},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[73]),r=!0)},p(o,a){var f,u;a[0]&10240&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg "+((((u=(f=o[13])==null?void 0:f.annotation)==null?void 0:u.rating)??"").toString()==="-1"?"bg-gray-100 dark:bg-gray-800":"")+" dark:hover:text-white hover:text-black transition disabled:cursor-progress disabled:hover:bg-transparent")&&h(e,"class",s),a[0]&33554432&&(e.disabled=o[25])},d(o){o&&g(e),r=!1,i()}}}function Ns(n){let e,t;return e=new Be({props:{content:n[28].t("Continue Response"),placement:"bottom",$$slots:{default:[na]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Continue Response")),s[0]&2304|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function na(n){let e,t,l,s,r,i,o;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),s=ke("path"),this.h()},l(a){e=E(a,"BUTTON",{type:!0,id:!0,class:!0});var f=w(e);t=we(f,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var u=w(t);l=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),s=we(u,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(s).forEach(g),u.forEach(g),f.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),h(s,"stroke-linecap","round"),h(s,"stroke-linejoin","round"),h(s,"d","M15.91 11.672a.375.375 0 0 1 0 .656l-5.603 3.113a.375.375 0 0 1-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112Z"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","continue-response-button"),h(e,"class",r=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(a,f){V(a,e,f),p(e,t),p(t,l),p(t,s),i||(o=ue(e,"click",n[74]),i=!0)},p(a,f){f[0]&2048&&r!==(r=(a[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",r)},d(a){a&&g(e),i=!1,o()}}}function ra(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,class:!0});var a=w(e);t=we(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=we(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2.3"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[75]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Ds(n){let e,t;return e=new Be({props:{content:n[28].t("Delete"),placement:"bottom",$$slots:{default:[ia]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&268435456&&(r.content=l[28].t("Delete")),s[0]&67584|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ia(n){let e,t,l,s,r,i;return{c(){e=M("button"),t=ke("svg"),l=ke("path"),this.h()},l(o){e=E(o,"BUTTON",{type:!0,id:!0,class:!0});var a=w(e);t=we(a,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var f=w(t);l=we(f,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(l).forEach(g),f.forEach(g),a.forEach(g),this.h()},h(){h(l,"stroke-linecap","round"),h(l,"stroke-linejoin","round"),h(l,"d","m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"),h(t,"xmlns","http://www.w3.org/2000/svg"),h(t,"fill","none"),h(t,"viewBox","0 0 24 24"),h(t,"stroke-width","2"),h(t,"stroke","currentColor"),h(t,"class","w-4 h-4"),h(e,"type","button"),h(e,"id","delete-response-button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(o,a){V(o,e,a),p(e,t),p(t,l),r||(i=ue(e,"click",n[76]),r=!0)},p(o,a){a[0]&2048&&s!==(s=(o[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")&&h(e,"class",s)},d(o){o&&g(e),r=!1,i()}}}function Vs(n){var i;let e,t,l=De(((i=n[17])==null?void 0:i.actions)??[]),s=[];for(let o=0;o<l.length;o+=1)s[o]=Cs(ns(n,l,o));const r=o=>D(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=ce()},l(o){for(let a=0;a<s.length;a+=1)s[a].l(o);e=ce()},m(o,a){for(let f=0;f<s.length;f+=1)s[f]&&s[f].m(o,a);V(o,e,a),t=!0},p(o,a){var f;if(a[0]&141376){l=De(((f=o[17])==null?void 0:f.actions)??[]);let u;for(u=0;u<l.length;u+=1){const c=ns(o,l,u);s[u]?(s[u].p(c,a),b(s[u],1)):(s[u]=Cs(c),s[u].c(),b(s[u],1),s[u].m(e.parentNode,e))}for(ne(),u=l.length;u<s.length;u+=1)r(u);re()}},i(o){if(!t){for(let a=0;a<l.length;a+=1)b(s[a]);t=!0}},o(o){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)D(s[a]);t=!1},d(o){o&&g(e),qe(s,o)}}}function oa(n){let e,t;return e=new gi({props:{strokeWidth:"2.1",className:"size-4"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function aa(n){let e,t,l,s,r;return{c(){e=M("div"),t=M("img"),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);t=E(o,"IMG",{src:!0,class:!0,style:!0,alt:!0}),o.forEach(g),this.h()},h(){Ot(t.src,l=n[86].icon_url)||h(t,"src",l),h(t,"class",s="w-4 h-4 "+(n[86].icon_url.includes("svg")?"dark:invert-[80%]":"")),St(t,"fill","currentColor"),h(t,"alt",r=n[86].name),h(e,"class","size-4")},m(i,o){V(i,e,o),p(e,t)},p(i,o){o[0]&131072&&!Ot(t.src,l=i[86].icon_url)&&h(t,"src",l),o[0]&131072&&s!==(s="w-4 h-4 "+(i[86].icon_url.includes("svg")?"dark:invert-[80%]":""))&&h(t,"class",s),o[0]&131072&&r!==(r=i[86].name)&&h(t,"alt",r)},i:ve,o:ve,d(i){i&&g(e)}}}function fa(n){let e,t,l,s,r,i,o,a;const f=[aa,oa],u=[];function c(d,_){return d[86].icon_url?0:1}t=c(n),l=u[t]=f[t](n);function m(){return n[77](n[86])}return{c(){e=M("button"),l.c(),r=j(),this.h()},l(d){e=E(d,"BUTTON",{type:!0,class:!0});var _=w(e);l.l(_),_.forEach(g),r=A(d),this.h()},h(){h(e,"type","button"),h(e,"class",s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(d,_){V(d,e,_),u[t].m(e,null),V(d,r,_),i=!0,o||(a=ue(e,"click",m),o=!0)},p(d,_){n=d;let k=t;t=c(n),t===k?u[t].p(n,_):(ne(),D(u[k],1,1,()=>{u[k]=null}),re(),l=u[t],l?l.p(n,_):(l=u[t]=f[t](n),l.c()),b(l,1),l.m(e,null)),(!i||_[0]&2048&&s!==(s=(n[11]?"visible":"invisible group-hover:visible")+" p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition"))&&h(e,"class",s)},i(d){i||(b(l),i=!0)},o(d){D(l),i=!1},d(d){d&&(g(e),g(r)),u[t].d(),o=!1,a()}}}function Cs(n){let e,t;return e=new Be({props:{content:n[86].name,placement:"bottom",$$slots:{default:[fa]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&131072&&(r.content=l[86].name),s[0]&141376|s[3]&1&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ts(n){let e,t,l,s;function r(a){n[79](a)}function i(a){n[80](a)}let o={};return n[13]!==void 0&&(o.message=n[13]),n[24]!==void 0&&(o.show=n[24]),e=new ri({props:o}),Ae.push(()=>Ke(e,"message",r)),Ae.push(()=>Ke(e,"show",i)),e.$on("save",n[81]),{c(){$(e.$$.fragment)},l(a){x(e.$$.fragment,a)},m(a,f){ee(e,a,f),s=!0},p(a,f){const u={};!t&&f[0]&8192&&(t=!0,u.message=a[13],Ze(()=>t=!1)),!l&&f[0]&16777216&&(l=!0,u.show=a[24],Ze(()=>l=!1)),e.$set(u)},i(a){s||(b(e.$$.fragment,a),s=!0)},o(a){D(e.$$.fragment,a),s=!1},d(a){te(e,a)}}}function Bs(n){var le,me,ie,se,_e,ge,Ie,Q;let e,t,l,s,r,i,o,a,f,u=((le=n[13])==null?void 0:le.files)&&((me=n[13].files)==null?void 0:me.filter(Rs).length)>0,c,m,d,_,k,v,N,y,T,P,R,I;l=new Vn({props:{src:((_e=(se=(ie=n[17])==null?void 0:ie.info)==null?void 0:se.meta)==null?void 0:_e.profile_image_url)??(n[28].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`),className:"size-8"}}),o=new Kt({props:{$$slots:{default:[Do]},$$scope:{ctx:n}}});let B=u&&os(n),S=(((ge=n[13])==null?void 0:ge.statusHistory)??[...(Ie=n[13])!=null&&Ie.status?[(Q=n[13])==null?void 0:Q.status]:[]]).length>0&&us(Wt(n));const L=[Uo,zo],C=[];function O(J,oe){return J[14]===!0?0:1}k=O(n),v=C[k]=L[k](n);let z=!n[14]&&_s(n);return{c(){e=M("div"),t=M("div"),$(l.$$.fragment),r=j(),i=M("div"),$(o.$$.fragment),a=j(),f=M("div"),B&&B.c(),c=j(),m=M("div"),d=M("div"),S&&S.c(),_=j(),v.c(),y=j(),z&&z.c(),this.h()},l(J){e=E(J,"DIV",{class:!0,id:!0,dir:!0});var oe=w(e);t=E(oe,"DIV",{class:!0});var ye=w(t);x(l.$$.fragment,ye),ye.forEach(g),r=A(oe),i=E(oe,"DIV",{class:!0});var U=w(i);x(o.$$.fragment,U),a=A(U),f=E(U,"DIV",{});var fe=w(f);B&&B.l(fe),c=A(fe),m=E(fe,"DIV",{class:!0});var de=w(m);d=E(de,"DIV",{});var he=w(d);S&&S.l(he),_=A(he),v.l(he),he.forEach(g),de.forEach(g),y=A(fe),z&&z.l(fe),fe.forEach(g),U.forEach(g),oe.forEach(g),this.h()},h(){var J;h(t,"class",s=ul(`shrink-0 ${(((J=n[26])==null?void 0:J.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"),h(m,"class",N="chat-"+n[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"),h(i,"class","flex-auto w-0 pl-1"),h(e,"class",T="flex w-full message-"+n[13].id+" svelte-1u5gq5j"),h(e,"id",P="message-"+n[13].id),h(e,"dir",R=n[26].chatDirection)},m(J,oe){V(J,e,oe),p(e,t),ee(l,t,null),p(e,r),p(e,i),ee(o,i,null),p(i,a),p(i,f),B&&B.m(f,null),p(f,c),p(f,m),p(m,d),S&&S.m(d,null),p(d,_),C[k].m(d,null),p(f,y),z&&z.m(f,null),I=!0},p(J,oe){var de,he,be,H,K,Y,G,ae,pe;const ye={};oe[0]&268566528&&(ye.src=((be=(he=(de=J[17])==null?void 0:de.info)==null?void 0:he.meta)==null?void 0:be.profile_image_url)??(J[28].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`)),l.$set(ye),(!I||oe[0]&67108864&&s!==(s=ul(`shrink-0 ${(((H=J[26])==null?void 0:H.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)+" svelte-1u5gq5j"))&&h(t,"class",s);const U={};oe[0]&139264|oe[3]&1&&(U.$$scope={dirty:oe,ctx:J}),o.$set(U),oe[0]&8192&&(u=((K=J[13])==null?void 0:K.files)&&((Y=J[13].files)==null?void 0:Y.filter(Rs).length)>0),u?B?(B.p(J,oe),oe[0]&8192&&b(B,1)):(B=os(J),B.c(),b(B,1),B.m(f,c)):B&&(ne(),D(B,1,1,()=>{B=null}),re()),(((G=J[13])==null?void 0:G.statusHistory)??[...(ae=J[13])!=null&&ae.status?[(pe=J[13])==null?void 0:pe.status]:[]]).length>0?S?(S.p(Wt(J),oe),oe[0]&8192&&b(S,1)):(S=us(Wt(J)),S.c(),b(S,1),S.m(d,_)):S&&(ne(),D(S,1,1,()=>{S=null}),re());let fe=k;k=O(J),k===fe?C[k].p(J,oe):(ne(),D(C[fe],1,1,()=>{C[fe]=null}),re(),v=C[k],v?v.p(J,oe):(v=C[k]=L[k](J),v.c()),b(v,1),v.m(d,null)),(!I||oe[0]&8192&&N!==(N="chat-"+J[13].role+" w-full min-w-full markdown-prose svelte-1u5gq5j"))&&h(m,"class",N),J[14]?z&&(ne(),D(z,1,1,()=>{z=null}),re()):z?(z.p(J,oe),oe[0]&16384&&b(z,1)):(z=_s(J),z.c(),b(z,1),z.m(f,null)),(!I||oe[0]&8192&&T!==(T="flex w-full message-"+J[13].id+" svelte-1u5gq5j"))&&h(e,"class",T),(!I||oe[0]&8192&&P!==(P="message-"+J[13].id))&&h(e,"id",P),(!I||oe[0]&67108864&&R!==(R=J[26].chatDirection))&&h(e,"dir",R)},i(J){I||(b(l.$$.fragment,J),b(o.$$.fragment,J),b(B),b(S),b(v),b(z),I=!0)},o(J){D(l.$$.fragment,J),D(o.$$.fragment,J),D(B),D(S),D(v),D(z),I=!1},d(J){J&&g(e),te(l),te(o),B&&B.d(),S&&S.d(),C[k].d(),z&&z.d()}}}function ua(n){let e,t,l,s=n[13].id,r,i;function o(u){n[49](u)}let a={title:n[28].t("Delete message?")};n[16]!==void 0&&(a.show=n[16]),e=new Sn({props:a}),Ae.push(()=>Ke(e,"show",o)),e.$on("confirm",n[50]);let f=Bs(n);return{c(){$(e.$$.fragment),l=j(),f.c(),r=ce()},l(u){x(e.$$.fragment,u),l=A(u),f.l(u),r=ce()},m(u,c){ee(e,u,c),V(u,l,c),f.m(u,c),V(u,r,c),i=!0},p(u,c){const m={};c[0]&268435456&&(m.title=u[28].t("Delete message?")),!t&&c[0]&65536&&(t=!0,m.show=u[16],Ze(()=>t=!1)),e.$set(m),c[0]&8192&&Te(s,s=u[13].id)?(ne(),D(f,1,1,ve),re(),f=Bs(u),f.c(),b(f,1),f.m(r.parentNode,r)):f.p(u,c)},i(u){i||(b(e.$$.fragment,u),b(f),i=!0)},o(u){D(e.$$.fragment,u),D(f),i=!1},d(u){u&&(g(l),g(r)),te(e,u),f.d(u)}}}const Rs=n=>n.type==="image",ca=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},da=n=>{n.target.select()},Ss=n=>n.slice(2),Os=n=>n.endsWith(",")?n.slice(0,-1):n;function ha(n,e,t){let l,s,r,i,o,a,f;Ee(n,jt,F=>t(48,l=F)),Ee(n,At,F=>t(26,s=F)),Ee(n,En,F=>t(27,r=F)),Ee(n,dl,F=>t(84,i=F)),Ee(n,zt,F=>t(29,a=F)),Ee(n,Zt,F=>t(30,f=F));const u=Fe("i18n");Ee(n,u,F=>t(28,o=F));const c=gt();let{chatId:m=""}=e,{history:d}=e,{messageId:_}=e,k=JSON.parse(JSON.stringify(d.messages[_])),{siblings:v}=e,{gotoMessage:N=()=>{}}=e,{showPreviousMessage:y}=e,{showNextMessage:T}=e,{updateChat:P}=e,{editMessage:R}=e,{saveMessage:I}=e,{rateMessage:B}=e,{actionMessage:S}=e,{deleteMessage:L}=e,{submitMessage:C}=e,{continueResponse:O}=e,{regenerateResponse:z}=e,{addMessages:le}=e,{isLastMessage:me=!0}=e,{readOnly:ie=!1}=e,se,_e=!1,ge=null,Ie=!1,Q="",J,oe=!1,ye={},U=!1,fe,de=!1,he=!1,be=!1;const H=async F=>{await Nn(F)&&je.success(o.t("Copying to clipboard was successful!"))},K=F=>new Promise(Ve=>{fe=F;const Me=ye[F];if(!Me)return Ve();Me.play(),Me.onended=async()=>{await new Promise(Oe=>setTimeout(Oe,300)),Object.keys(ye).length-1===F&&t(21,U=!1),Ve()}}),Y=async()=>{var F,Ve,Me,Oe,Je,xe,Vt,ct,kt,Re,Ge,nt,wt,Ct,Xt,$t,xt,el,tl,ll,sl,nl,rl;if(U){try{speechSynthesis.cancel(),fe!==void 0&&ye[fe]&&(ye[fe].pause(),ye[fe].currentTime=0)}catch{}t(21,U=!1),fe=void 0;return}if(!((k==null?void 0:k.content)??"").trim().length){je.info(o.t("No content to speak"));return}if(t(21,U=!0),r.audio.tts.engine===""){let Xe=[];const _t=setInterval(()=>{var $e,dt,et;if(Xe=speechSynthesis.getVoices(),Xe.length>0){clearInterval(_t);const We=(($e=Xe==null?void 0:Xe.filter(mt=>{var il,ol,al,fl;return mt.voiceURI===(((ol=(il=s==null?void 0:s.audio)==null?void 0:il.tts)==null?void 0:ol.voice)??((fl=(al=r==null?void 0:r.audio)==null?void 0:al.tts)==null?void 0:fl.voice))}))==null?void 0:$e.at(0))??void 0;console.log(We);const ht=new SpeechSynthesisUtterance(k.content);ht.rate=((et=(dt=s.audio)==null?void 0:dt.tts)==null?void 0:et.playbackRate)??1,console.log(ht),ht.onend=()=>{var mt;t(21,U=!1),s.conversationMode&&((mt=document.getElementById("voice-input-button"))==null||mt.click())},We&&(ht.voice=We),speechSynthesis.speak(ht)}},100)}else{t(22,de=!0);const Xe=kr(k.content,((Ve=(F=r==null?void 0:r.audio)==null?void 0:F.tts)==null?void 0:Ve.split_on)??"punctuation");if(!Xe.length){console.log("No content to speak"),je.info(o.t("No content to speak")),t(21,U=!1),t(22,de=!1);return}console.debug("Prepared message content for TTS",Xe),ye=Xe.reduce(($e,dt,et)=>($e[et]=null,$e),{});let _t=Promise.resolve();if(((Oe=(Me=s.audio)==null?void 0:Me.tts)==null?void 0:Oe.engine)==="browser-kokoro"){i||(await dl.set(new Ar({dtype:((Vt=(xe=(Je=s.audio)==null?void 0:Je.tts)==null?void 0:xe.engineConfig)==null?void 0:Vt.dtype)??"fp32"})),await i.init());for(const[$e,dt]of Xe.entries()){const et=await i.generate({text:dt,voice:((kt=(ct=s==null?void 0:s.audio)==null?void 0:ct.tts)==null?void 0:kt.voice)??((Ge=(Re=r==null?void 0:r.audio)==null?void 0:Re.tts)==null?void 0:Ge.voice)}).catch(We=>{console.error(We),je.error(`${We}`),t(21,U=!1),t(22,de=!1)});if(et){const We=new Audio(et);We.playbackRate=((wt=(nt=s.audio)==null?void 0:nt.tts)==null?void 0:wt.playbackRate)??1,ye[$e]=We,t(22,de=!1),_t=_t.then(()=>K($e))}}}else for(const[$e,dt]of Xe.entries()){const et=await Ir(localStorage.token,((Xt=(Ct=s==null?void 0:s.audio)==null?void 0:Ct.tts)==null?void 0:Xt.defaultVoice)===r.audio.tts.voice?((xt=($t=s==null?void 0:s.audio)==null?void 0:$t.tts)==null?void 0:xt.voice)??((tl=(el=r==null?void 0:r.audio)==null?void 0:el.tts)==null?void 0:tl.voice):(sl=(ll=r==null?void 0:r.audio)==null?void 0:ll.tts)==null?void 0:sl.voice,dt).catch(We=>{console.error(We),je.error(`${We}`),t(21,U=!1),t(22,de=!1)});if(et){const We=await et.blob(),ht=URL.createObjectURL(We),mt=new Audio(ht);mt.playbackRate=((rl=(nl=s.audio)==null?void 0:nl.tts)==null?void 0:rl.playbackRate)??1,ye[$e]=mt,t(22,de=!1),_t=_t.then(()=>K($e))}}}},G=async()=>{t(14,Ie=!0),t(18,Q=k.content),await Ne(),t(19,J.style.height="",J),t(19,J.style.height=`${J.scrollHeight}px`,J)},ae=async()=>{R(k.id,Q||"",!1),t(14,Ie=!1),t(18,Q=""),await Ne()},pe=async()=>{R(k.id,Q||""),t(14,Ie=!1),t(18,Q=""),await Ne()},Ce=async()=>{t(14,Ie=!1),t(18,Q=""),await Ne()},X=async F=>{t(23,he=!0);const Ve=await Mr(localStorage.token,F.content).catch(Me=>{je.error(`${Me}`)});if(console.log(Ve),Ve){const Me=Ve.map(Oe=>({type:"image",url:`${Oe.url}`}));I(F.id,{...F,files:Me})}t(23,he=!1)};let Se=!1;const He=async(F=null,Ve=null)=>{var kt;t(25,Se=!0),console.log("Feedback",F,Ve);const Me={...k,annotation:{...(k==null?void 0:k.annotation)??{},...F!==null?{rating:F}:{},...Ve||{}}},Oe=await pr(localStorage.token,m).catch(Re=>{je.error(`${Re}`)});if(!Oe)return;const Je=Jt(d,k.id);let xe={type:"rating",data:{...Me!=null&&Me.annotation?Me.annotation:{},model_id:(k==null?void 0:k.selectedModelId)??k.model,...d.messages[k.parentId].childrenIds.length>1?{sibling_model_ids:d.messages[k.parentId].childrenIds.filter(Re=>Re!==k.id).map(Re=>{var Ge;return((Ge=d.messages[Re])==null?void 0:Ge.selectedModelId)??d.messages[Re].model})}:{}},meta:{arena:k?k.arena:!1,model_id:k.model,message_id:k.id,message_index:Je.length,chat_id:m},snapshot:{chat:Oe}};const Vt=[xe.data.model_id,...xe.data.sibling_model_ids??[]].reduce((Re,Ge)=>{var wt;const nt=l.find(Ct=>Ct.id===Ge);return nt?Re[nt.id]=((wt=nt==null?void 0:nt.info)==null?void 0:wt.base_model_id)??null:console.warn(`Model with ID ${Ge} not found`),Re},{});xe.meta.base_models=Vt;let ct=null;if(k!=null&&k.feedbackId?ct=await _l(localStorage.token,k.feedbackId,xe).catch(Re=>{je.error(`${Re}`)}):(ct=await wr(localStorage.token,xe).catch(Re=>{je.error(`${Re}`)}),ct&&(Me.feedbackId=ct.id)),console.log(Me),I(k.id,Me),await Ne(),!Ve&&(t(24,be=!0),!((kt=Me.annotation)!=null&&kt.tags))){const Re=await yr(localStorage.token,k.model,Je,m).catch(Ge=>(console.error(Ge),[]));console.log(Re),Re&&(Me.annotation.tags=Re,xe.data.tags=Re,I(k.id,Me),await _l(localStorage.token,Me.feedbackId,xe).catch(Ge=>{je.error(`${Ge}`)}))}t(25,Se=!1)},ze=async()=>{L(k.id)};bt(async()=>{await Ne(),se&&(console.log(se),se.addEventListener("wheel",function(F){F.preventDefault(),F.deltaY!==0&&t(15,se.scrollLeft+=F.deltaY,se)}))});function Ye(F){_e=F,t(16,_e)}const lt=()=>{ze()};function ot(F){Ae[F?"unshift":"push"](()=>{J=F,t(19,J)})}function at(){Q=this.value,t(18,Q)}const tt=F=>{var Oe,Je;F.key==="Escape"&&((Oe=document.getElementById("close-edit-message-button"))==null||Oe.click());const Ve=F.metaKey||F.ctrlKey,Me=F.key==="Enter";Ve&&Me&&((Je=document.getElementById("confirm-edit-message-button"))==null||Je.click())},ft=()=>{pe()},ut=()=>{Ce()},st=()=>{ae()},It=async F=>{console.log(F)},Mt=async(F,Ve)=>{console.log(F,Ve);let Me=document.getElementById(`source-${k.id}-${Ve}`);const Oe=document.getElementById(`collapsible-${k.id}`);Me?Me.click():Oe&&(Oe.querySelector("div:first-child").dispatchEvent(new PointerEvent("pointerup",{})),await new Promise(Je=>{requestAnimationFrame(()=>{requestAnimationFrame(Je)})}),Me=document.getElementById(`source-${k.id}-${Ve}`),Me&&Me.click())},Et=({modelId:F,parentId:Ve,messages:Me})=>{le({modelId:F,parentId:Ve,messages:Me})},Nt=F=>{const{raw:Ve,oldContent:Me,newContent:Oe}=F.detail;t(0,d.messages[k.id].content=d.messages[k.id].content.replace(Ve,Ve.replace(Me,Oe)),d),P()},Dt=F=>{var Oe;const{type:Ve,content:Me}=F.detail;if(Ve==="explain")C(k.id,`Explain this section to me in more detail

\`\`\`
${Me}
\`\`\``);else if(Ve==="ask"){const Je=((Oe=F.detail)==null?void 0:Oe.input)??"";C(k.id,`\`\`\`
${Me}
\`\`\`
${Je}`)}},Pn=()=>{y(k)},Hn=F=>{N(k,F.target.value-1),t(20,oe=!1)},jn=F=>{F.key==="Enter"&&(N(k,F.target.value-1),t(20,oe=!1))},An=async()=>{t(20,oe=!0),await Ne();const F=document.getElementById(`message-index-input-${k.id}`);F&&(F.focus(),F.select())},zn=()=>{T(k)},Un=()=>{G()},Wn=()=>{H(k.content)},qn=()=>{de||Y()},Fn=()=>{he||X(k)},Jn=()=>{console.log(k)},Gn=async()=>{await He(1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${k.id}`))==null||F.scrollIntoView()},0)},Zn=async()=>{await He(-1),window.setTimeout(()=>{var F;(F=document.getElementById(`message-feedback-${k.id}`))==null||F.scrollIntoView()},0)},Kn=()=>{O()},Qn=()=>{t(24,be=!1),z(k),((ge==null?void 0:ge.actions)??[]).forEach(F=>{c("action",{id:F.id,event:{id:"regenerate-response",data:{messageId:k.id}}})})},Yn=()=>{t(16,_e=!0)},Xn=F=>{S(F.id,k)};function $n(F){Ae[F?"unshift":"push"](()=>{se=F,t(15,se)})}function xn(F){k=F,t(13,k),t(0,d),t(43,_)}function er(F){be=F,t(24,be)}const tr=async F=>{await He(null,{...F.detail})};return n.$$set=F=>{"chatId"in F&&t(42,m=F.chatId),"history"in F&&t(0,d=F.history),"messageId"in F&&t(43,_=F.messageId),"siblings"in F&&t(1,v=F.siblings),"gotoMessage"in F&&t(2,N=F.gotoMessage),"showPreviousMessage"in F&&t(3,y=F.showPreviousMessage),"showNextMessage"in F&&t(4,T=F.showNextMessage),"updateChat"in F&&t(5,P=F.updateChat),"editMessage"in F&&t(44,R=F.editMessage),"saveMessage"in F&&t(45,I=F.saveMessage),"rateMessage"in F&&t(46,B=F.rateMessage),"actionMessage"in F&&t(6,S=F.actionMessage),"deleteMessage"in F&&t(47,L=F.deleteMessage),"submitMessage"in F&&t(7,C=F.submitMessage),"continueResponse"in F&&t(8,O=F.continueResponse),"regenerateResponse"in F&&t(9,z=F.regenerateResponse),"addMessages"in F&&t(10,le=F.addMessages),"isLastMessage"in F&&t(11,me=F.isLastMessage),"readOnly"in F&&t(12,ie=F.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&8193|n.$$.dirty[1]&4096&&d.messages&&JSON.stringify(k)!==JSON.stringify(d.messages[_])&&t(13,k=JSON.parse(JSON.stringify(d.messages[_]))),n.$$.dirty[0]&8192|n.$$.dirty[1]&131072&&t(17,ge=l.find(F=>F.id===k.model)),n.$$.dirty[0]&16384&&(Ie||(async()=>await Ne())())},[d,v,N,y,T,P,S,C,O,z,le,me,ie,k,Ie,se,_e,ge,Q,J,oe,U,de,he,be,Se,s,r,o,a,f,u,c,H,Y,G,ae,pe,Ce,X,He,ze,m,_,R,I,B,L,l,Ye,lt,ot,at,tt,ft,ut,st,It,Mt,Et,Nt,Dt,Pn,Hn,jn,An,zn,Un,Wn,qn,Fn,Jn,Gn,Zn,Kn,Qn,Yn,Xn,$n,xn,er,tr]}class Ln extends Le{constructor(e){super(),Pe(this,e,ha,ua,Te,{chatId:42,history:0,messageId:43,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,updateChat:5,editMessage:44,saveMessage:45,rateMessage:46,actionMessage:6,deleteMessage:47,submitMessage:7,continueResponse:8,regenerateResponse:9,addMessages:10,isLastMessage:11,readOnly:12},null,[-1,-1,-1,-1])}}function ma(n){let e,t;return{c(){e=ke("svg"),t=ke("path"),this.h()},l(l){e=we(l,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var s=w(e);t=we(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),w(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"stroke-linecap","round"),h(t,"stroke-linejoin","round"),h(t,"d","M8 8v8m0-8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 8a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm6-2a2 2 0 1 1 4 0 2 2 0 0 1-4 0Zm0 0h-1a5 5 0 0 1-5-5v-.5"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"fill","none"),h(e,"viewBox","0 0 24 24"),h(e,"stroke-width",n[1]),h(e,"stroke","currentColor"),h(e,"class",n[0])},m(l,s){V(l,e,s),p(e,t)},p(l,[s]){s&2&&h(e,"stroke-width",l[1]),s&1&&h(e,"class",l[0])},i:ve,o:ve,d(l){l&&g(e)}}}function ga(n,e,t){let{className:l="w-4 h-4"}=e,{strokeWidth:s="1.5"}=e;return n.$$set=r=>{"className"in r&&t(0,l=r.className),"strokeWidth"in r&&t(1,s=r.strokeWidth)},[l,s]}class _a extends Le{constructor(e){super(),Pe(this,e,ga,ma,Te,{className:0,strokeWidth:1})}}function qt(n){var l;const e=n.slice(),t=(l=e[0].messages[e[2]])==null?void 0:l.merged;return e[16]=t,e}function Ls(n,e,t){const l=n.slice();return l[38]=e[t],l}function Ft(n){const e=n.slice(),t=e[19][e[38]].messageIds[e[20][e[38]]];return e[41]=t,e}function Ps(n){let e,t,l,s,r,i=De(Object.keys(n[19])),o=[];for(let u=0;u<i.length;u+=1)o[u]=zs(Ls(n,i,u));const a=u=>D(o[u],1,1,()=>{o[u]=null});let f=!n[4]&&Us(n);return{c(){e=M("div"),t=M("div");for(let u=0;u<o.length;u+=1)o[u].c();s=j(),f&&f.c(),this.h()},l(u){e=E(u,"DIV",{});var c=w(e);t=E(c,"DIV",{class:!0,id:!0});var m=w(t);for(let d=0;d<o.length;d+=1)o[d].l(m);m.forEach(g),s=A(c),f&&f.l(c),c.forEach(g),this.h()},h(){h(t,"class","flex snap-x snap-mandatory overflow-x-auto scrollbar-hidden"),h(t,"id",l="responses-container-"+n[1]+"-"+n[18].id)},m(u,c){V(u,e,c),p(e,t);for(let m=0;m<o.length;m+=1)o[m]&&o[m].m(t,null);p(e,s),f&&f.m(e,null),r=!0},p(u,c){if(c[0]&121241591){i=De(Object.keys(u[19]));let m;for(m=0;m<i.length;m+=1){const d=Ls(u,i,m);o[m]?(o[m].p(d,c),b(o[m],1)):(o[m]=zs(d),o[m].c(),b(o[m],1),o[m].m(t,null))}for(ne(),m=i.length;m<o.length;m+=1)a(m);re()}(!r||c[0]&262146&&l!==(l="responses-container-"+u[1]+"-"+u[18].id))&&h(t,"id",l),u[4]?f&&(ne(),D(f,1,1,()=>{f=null}),re()):f?(f.p(u,c),c[0]&16&&b(f,1)):(f=Us(u),f.c(),b(f,1),f.m(e,null))},i(u){if(!r){for(let c=0;c<i.length;c+=1)b(o[c]);b(f),r=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)D(o[c]);D(f),r=!1},d(u){u&&g(e),qe(o,u),f&&f.d()}}}function Hs(n){let e,t=n[0].currentId,l,s,r,i,o,a=As(n);function f(){return n[34](n[41])}return{c(){e=M("div"),a.c(),l=j(),this.h()},l(u){e=E(u,"DIV",{class:!0});var c=w(e);a.l(c),l=A(c),c.forEach(g),this.h()},h(){var u;h(e,"class",s="snap-center w-full max-w-full m-1 border "+(((u=n[0].messages[n[2]])==null?void 0:u.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl")},m(u,c){V(u,e,c),a.m(e,null),p(e,l),r=!0,i||(o=ue(e,"click",f),i=!0)},p(u,c){var m;n=u,c[0]&1&&Te(t,t=n[0].currentId)?(ne(),D(a,1,1,ve),re(),a=As(n),a.c(),b(a,1),a.m(e,l)):a.p(n,c),(!r||c[0]&2621445&&s!==(s="snap-center w-full max-w-full m-1 border "+(((m=n[0].messages[n[2]])==null?void 0:m.modelIdx)==n[38]?`border-gray-100 dark:border-gray-850 border-[1.5px] ${n[21]?"min-w-full":"min-w-80"}`:`border-gray-100 dark:border-gray-850 border-dashed ${n[21]?"min-w-full":"min-w-80"}`)+" transition-all p-5 rounded-2xl"))&&h(e,"class",s)},i(u){r||(b(a),r=!0)},o(u){D(a),r=!1},d(u){u&&g(e),a.d(u),i=!1,o()}}}function js(n){let e,t;function l(...o){return n[30](n[38],...o)}function s(){return n[31](n[38])}function r(){return n[32](n[38])}function i(...o){return n[33](n[38],...o)}return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[41],isLastMessage:!0,siblings:n[19][n[38]].messageIds,gotoMessage:l,showPreviousMessage:s,showNextMessage:r,updateChat:n[5],editMessage:n[6],saveMessage:n[7],rateMessage:n[8],deleteMessage:n[11],actionMessage:n[9],submitMessage:n[10],continueResponse:n[12],regenerateResponse:i,addMessages:n[14],readOnly:n[4]}}),{c(){$(e.$$.fragment)},l(o){x(e.$$.fragment,o)},m(o,a){ee(e,o,a),t=!0},p(o,a){n=o;const f={};a[0]&2&&(f.chatId=n[1]),a[0]&1&&(f.history=n[0]),a[0]&1572864&&(f.messageId=n[41]),a[0]&524288&&(f.siblings=n[19][n[38]].messageIds),a[0]&524288&&(f.gotoMessage=l),a[0]&524288&&(f.showPreviousMessage=s),a[0]&524288&&(f.showNextMessage=r),a[0]&32&&(f.updateChat=n[5]),a[0]&64&&(f.editMessage=n[6]),a[0]&128&&(f.saveMessage=n[7]),a[0]&256&&(f.rateMessage=n[8]),a[0]&2048&&(f.deleteMessage=n[11]),a[0]&512&&(f.actionMessage=n[9]),a[0]&1024&&(f.submitMessage=n[10]),a[0]&4096&&(f.continueResponse=n[12]),a[0]&1581056&&(f.regenerateResponse=i),a[0]&16384&&(f.addMessages=n[14]),a[0]&16&&(f.readOnly=n[4]),e.$set(f)},i(o){t||(b(e.$$.fragment,o),t=!0)},o(o){D(e.$$.fragment,o),t=!1},d(o){te(e,o)}}}function As(n){let e,t,l=n[16]&&js(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[16]?l?(l.p(s,r),r[0]&65536&&b(l,1)):(l=js(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ne(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function zs(n){let e,t,l=n[20][n[38]]!==void 0&&n[19][n[38]].messageIds.length>0&&Hs(Ft(n));return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[20][s[38]]!==void 0&&s[19][s[38]].messageIds.length>0?l?(l.p(Ft(s),r),r[0]&1572864&&b(l,1)):(l=Hs(Ft(s)),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ne(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function Us(n){let e=!Object.keys(n[19]).find(n[29]),t,l,s=e&&Ws(n);return{c(){s&&s.c(),t=ce()},l(r){s&&s.l(r),t=ce()},m(r,i){s&&s.m(r,i),V(r,t,i),l=!0},p(r,i){i[0]&1572865&&(e=!Object.keys(r[19]).find(r[29])),e?s?(s.p(r,i),i[0]&1572865&&b(s,1)):(s=Ws(r),s.c(),b(s,1),s.m(t.parentNode,t)):s&&(ne(),D(s,1,1,()=>{s=null}),re())},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(t),s&&s.d(r)}}}function Ws(n){var o,a;let e,t,l,s,r=((a=(o=n[0].messages[n[2]])==null?void 0:o.merged)==null?void 0:a.status)&&qs(qt(n)),i=n[3]&&Js(n);return{c(){e=M("div"),t=M("div"),r&&r.c(),l=j(),i&&i.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);t=E(u,"DIV",{class:!0});var c=w(t);r&&r.l(c),c.forEach(g),l=A(u),i&&i.l(u),u.forEach(g),this.h()},h(){h(t,"class","w-full"),h(e,"class","flex justify-end")},m(f,u){V(f,e,u),p(e,t),r&&r.m(t,null),p(e,l),i&&i.m(e,null),s=!0},p(f,u){var c,m;(m=(c=f[0].messages[f[2]])==null?void 0:c.merged)!=null&&m.status?r?(r.p(qt(f),u),u[0]&5&&b(r,1)):(r=qs(qt(f)),r.c(),b(r,1),r.m(t,null)):r&&(ne(),D(r,1,1,()=>{r=null}),re()),f[3]?i?(i.p(f,u),u[0]&8&&b(i,1)):(i=Js(f),i.c(),b(i,1),i.m(e,null)):i&&(ne(),D(i,1,1,()=>{i=null}),re())},i(f){s||(b(r),b(i),s=!0)},o(f){D(r),D(i),s=!1},d(f){f&&g(e),r&&r.d(),i&&i.d()}}}function qs(n){let e,t,l,s,r,i,o;t=new Kt({props:{$$slots:{default:[pa]},$$scope:{ctx:n}}});const a=[ba,va],f=[];function u(c,m){var d;return(((d=c[16])==null?void 0:d.content)??"")===""?0:1}return r=u(n),i=f[r]=a[r](n),{c(){e=M("div"),$(t.$$.fragment),l=j(),s=M("div"),i.c(),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);x(t.$$.fragment,m),l=A(m),s=E(m,"DIV",{class:!0});var d=w(s);i.l(d),d.forEach(g),m.forEach(g),this.h()},h(){h(s,"class","mt-1 markdown-prose w-full min-w-full"),h(e,"class","w-full rounded-xl pl-5 pr-2 py-2")},m(c,m){V(c,e,m),ee(t,e,null),p(e,l),p(e,s),f[r].m(s,null),o=!0},p(c,m){const d={};m[0]&5|m[1]&2048&&(d.$$scope={dirty:m,ctx:c}),t.$set(d);let _=r;r=u(c),r===_?f[r].p(c,m):(ne(),D(f[_],1,1,()=>{f[_]=null}),re(),i=f[r],i?i.p(c,m):(i=f[r]=a[r](c),i.c()),b(i,1),i.m(s,null))},i(c){o||(b(t.$$.fragment,c),b(i),o=!0)},o(c){D(t.$$.fragment,c),D(i),o=!1},d(c){c&&g(e),te(t),f[r].d()}}}function Fs(n){let e,t=it(n[16].timestamp*1e3).format("LT")+"",l;return{c(){e=M("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","self-center invisible group-hover:visible text-gray-400 text-xs font-medium uppercase ml-0.5 -mt-0.5")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&5&&t!==(t=it(s[16].timestamp*1e3).format("LT")+"")&&Z(l,t)},d(s){s&&g(e)}}}function pa(n){let e,t,l=n[16].timestamp&&Fs(n);return{c(){e=W(`Merged Response

									`),l&&l.c(),t=ce()},l(s){e=q(s,`Merged Response

									`),l&&l.l(s),t=ce()},m(s,r){V(s,e,r),l&&l.m(s,r),V(s,t,r)},p(s,r){s[16].timestamp?l?l.p(s,r):(l=Fs(s),l.c(),l.m(t.parentNode,t)):l&&(l.d(1),l=null)},d(s){s&&(g(e),g(t)),l&&l.d(s)}}}function va(n){let e,t;return e=new yt({props:{id:"merged",content:n[16].content??""}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&5&&(r.content=l[16].content??""),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function ba(n){let e,t;return e=new Yt({}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p:ve,i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Js(n){let e,t,l;return t=new Be({props:{content:n[22].t("Merge Responses"),placement:"bottom",$$slots:{default:[ka]},$$scope:{ctx:n}}}),{c(){e=M("div"),$(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);x(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","shrink-0 text-gray-600 dark:text-gray-500 mt-1")},m(s,r){V(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&4194304&&(i.content=s[22].t("Merge Responses")),r[1]&2048&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function ka(n){let e,t,l,s,r;return t=new _a({props:{className:" size-5 "}}),{c(){e=M("button"),$(t.$$.fragment),this.h()},l(i){e=E(i,"BUTTON",{type:!0,id:!0,class:!0});var o=w(e);x(t.$$.fragment,o),o.forEach(g),this.h()},h(){h(e,"type","button"),h(e,"id","merge-response-button"),h(e,"class","visible p-1 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition regenerate-response-button")},m(i,o){V(i,e,o),ee(t,e,null),l=!0,s||(r=ue(e,"click",n[35]),s=!0)},p:ve,i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){D(t.$$.fragment,i),l=!1},d(i){i&&g(e),te(t),s=!1,r()}}}function wa(n){let e,t,l=n[18]&&Ps(n);return{c(){l&&l.c(),e=ce()},l(s){l&&l.l(s),e=ce()},m(s,r){l&&l.m(s,r),V(s,e,r),t=!0},p(s,r){s[18]?l?(l.p(s,r),r[0]&262144&&b(l,1)):(l=Ps(s),l.c(),b(l,1),l.m(e.parentNode,e)):l&&(ne(),D(l,1,1,()=>{l=null}),re())},i(s){t||(b(l),t=!0)},o(s){D(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function ya(n,e,t){let l,s;Ee(n,Mn,U=>t(21,l=U));const r=Fe("i18n");Ee(n,r,U=>t(22,s=U)),it.extend(Dn);let{chatId:i}=e,{history:o}=e,{messageId:a}=e,{isLastMessage:f}=e,{readOnly:u=!1}=e,{updateChat:c}=e,{editMessage:m}=e,{saveMessage:d}=e,{rateMessage:_}=e,{actionMessage:k}=e,{submitMessage:v}=e,{deleteMessage:N}=e,{continueResponse:y}=e,{regenerateResponse:T}=e,{mergeResponses:P}=e,{addMessages:R}=e,{triggerScroll:I}=e;gt();let B,S,L={},C={},O=JSON.parse(JSON.stringify(o.messages[a]));const z=async(U,fe)=>{t(20,C[U]=Math.max(0,Math.min(fe,L[U].messageIds.length-1)),C);let de=L[U].messageIds[C[U]];console.log(de);let he=o.messages[de].childrenIds;for(;he.length!==0;)de=he.at(-1),he=o.messages[de].childrenIds;t(0,o.currentId=de,o),await Ne(),await c(),I()},le=async U=>{t(20,C[U]=Math.max(0,C[U]-1),C);let fe=L[U].messageIds[C[U]];console.log(fe);let de=o.messages[fe].childrenIds;for(;de.length!==0;)fe=de.at(-1),de=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await Ne(),await c(),I()},me=async U=>{t(20,C[U]=Math.min(L[U].messageIds.length-1,C[U]+1),C);let fe=L[U].messageIds[C[U]];console.log(fe);let de=o.messages[fe].childrenIds;for(;de.length!==0;)fe=de.at(-1),de=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await Ne(),await c(),I()},ie=async()=>{console.log("multiresponse:initHandler"),await Ne(),t(17,B=a),t(18,S=o.messages[a].parentId?o.messages[o.messages[a].parentId]:null),t(19,L=S==null?void 0:S.models.reduce((U,fe,de)=>{let he=S==null?void 0:S.childrenIds.map(be=>o.messages[be]).filter(be=>(be==null?void 0:be.modelIdx)===de).map(be=>be.id);if(he.length===0){let be=S==null?void 0:S.childrenIds.map(H=>o.messages[H]).filter(H=>(H==null?void 0:H.model)===fe);be.forEach(H=>{H.modelIdx=de}),he=be.map(H=>H.id)}return{...U,[de]:{messageIds:he}}},{})),t(20,C=S==null?void 0:S.models.reduce((U,fe,de)=>{const he=L[de].messageIds.findIndex(be=>be===a);return he!==-1?{...U,[de]:he}:{...U,[de]:L[de].messageIds.length-1}},{})),console.log(L,C),await Ne()},se=async()=>{const U=Object.keys(L).map(fe=>{const{messageIds:de}=L[fe],he=de[C[fe]];return o.messages[he].content});P(a,U,i)};bt(async()=>{await ie(),await Ne();const U=document.getElementById(`message-${a}`);U&&U.scrollIntoView({block:"start"})});const _e=U=>{var he;const{messageIds:fe}=L[U],de=fe[C[U]];return!((he=o.messages[de])!=null&&he.done)},ge=(U,fe,de)=>z(U,de),Ie=U=>le(U),Q=U=>me(U),J=async(U,fe)=>{T(fe),await Ne(),t(20,C[U]=L[U].messageIds.length-1,C)},oe=async U=>{if(a!=U){let fe=U,de=o.messages[fe].childrenIds;for(;de.length!==0;)fe=de.at(-1),de=o.messages[fe].childrenIds;t(0,o.currentId=fe,o),await Ne(),await c(),I()}},ye=()=>{se()};return n.$$set=U=>{"chatId"in U&&t(1,i=U.chatId),"history"in U&&t(0,o=U.history),"messageId"in U&&t(2,a=U.messageId),"isLastMessage"in U&&t(3,f=U.isLastMessage),"readOnly"in U&&t(4,u=U.readOnly),"updateChat"in U&&t(5,c=U.updateChat),"editMessage"in U&&t(6,m=U.editMessage),"saveMessage"in U&&t(7,d=U.saveMessage),"rateMessage"in U&&t(8,_=U.rateMessage),"actionMessage"in U&&t(9,k=U.actionMessage),"submitMessage"in U&&t(10,v=U.submitMessage),"deleteMessage"in U&&t(11,N=U.deleteMessage),"continueResponse"in U&&t(12,y=U.continueResponse),"regenerateResponse"in U&&t(13,T=U.regenerateResponse),"mergeResponses"in U&&t(28,P=U.mergeResponses),"addMessages"in U&&t(14,R=U.addMessages),"triggerScroll"in U&&t(15,I=U.triggerScroll)},n.$$.update=()=>{n.$$.dirty[0]&65541&&o.messages&&JSON.stringify(O)!==JSON.stringify(o.messages[a])&&t(16,O=JSON.parse(JSON.stringify(o.messages[a])))},[o,i,a,f,u,c,m,d,_,k,v,N,y,T,R,I,O,B,S,L,C,l,s,r,z,le,me,se,P,_e,ge,Ie,Q,J,oe,ye]}class Ia extends Le{constructor(e){super(),Pe(this,e,ya,wa,Te,{chatId:1,history:0,messageId:2,isLastMessage:3,readOnly:4,updateChat:5,editMessage:6,saveMessage:7,rateMessage:8,actionMessage:9,submitMessage:10,deleteMessage:11,continueResponse:12,regenerateResponse:13,mergeResponses:28,addMessages:14,triggerScroll:15},null,[-1,-1])}}function Gs(n,e,t){const l=n.slice();return l[49]=e[t],l}function Zs(n){var r,i,o,a;let e,t,l,s;return t=new Vn({props:{src:n[7].user?((o=(i=(r=n[15].find(n[29]))==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??"/user.png":((a=n[0])==null?void 0:a.profile_image_url)??"/user.png",className:"size-8"}}),{c(){e=M("div"),$(t.$$.fragment),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);x(t.$$.fragment,u),u.forEach(g),this.h()},h(){var f;h(e,"class",l=`shrink-0 ${(((f=n[14])==null?void 0:f.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`)},m(f,u){V(f,e,u),ee(t,e,null),s=!0},p(f,u){var m,d,_,k,v;const c={};u[0]&32897&&(c.src=f[7].user?((_=(d=(m=f[15].find(f[29]))==null?void 0:m.info)==null?void 0:d.meta)==null?void 0:_.profile_image_url)??"/user.png":((k=f[0])==null?void 0:k.profile_image_url)??"/user.png"),t.$set(c),(!s||u[0]&16384&&l!==(l=`shrink-0 ${(((v=f[14])==null?void 0:v.chatDirection)??"LTR")==="LTR"?"mr-3":"ml-3"}`))&&h(e,"class",l)},i(f){s||(b(t.$$.fragment,f),s=!0)},o(f){D(t.$$.fragment,f),s=!1},d(f){f&&g(e),te(t)}}}function Ks(n){let e,t,l;return t=new Kt({props:{$$slots:{default:[Va]},$$scope:{ctx:n}}}),{c(){e=M("div"),$(t.$$.fragment)},l(s){e=E(s,"DIV",{});var r=w(e);x(t.$$.fragment,r),r.forEach(g)},m(s,r){V(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&90241|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function Ma(n){let e=n[13].t("You")+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&8192&&e!==(e=l[13].t("You")+"")&&Z(t,e)},d(l){l&&g(t)}}}function Ea(n){let e=n[0].name+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s[0]&1&&e!==(e=l[0].name+"")&&Z(t,e)},d(l){l&&g(t)}}}function Na(n){var o;let e=n[13].t("You")+"",t,l,s,r=(((o=n[7])==null?void 0:o.user)??"")+"",i;return{c(){t=W(e),l=j(),s=M("span"),i=W(r),this.h()},l(a){t=q(a,e),l=A(a),s=E(a,"SPAN",{class:!0});var f=w(s);i=q(f,r),f.forEach(g),this.h()},h(){h(s,"class","text-gray-500 text-sm font-medium")},m(a,f){V(a,t,f),V(a,l,f),V(a,s,f),p(s,i)},p(a,f){var u;f[0]&8192&&e!==(e=a[13].t("You")+"")&&Z(t,e),f[0]&128&&r!==(r=(((u=a[7])==null?void 0:u.user)??"")+"")&&Z(i,r)},d(a){a&&(g(t),g(l),g(s))}}}function Qs(n){let e,t,l;return t=new Be({props:{content:it(n[7].timestamp*1e3).format("LLLL"),$$slots:{default:[Da]},$$scope:{ctx:n}}}),{c(){e=M("div"),$(t.$$.fragment),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);x(t.$$.fragment,r),r.forEach(g),this.h()},h(){h(e,"class","self-center text-xs invisible group-hover:visible text-gray-400 font-medium first-letter:capitalize ml-0.5 translate-y-[1px]")},m(s,r){V(s,e,r),ee(t,e,null),l=!0},p(s,r){const i={};r[0]&128&&(i.content=it(s[7].timestamp*1e3).format("LLLL")),r[0]&128|r[1]&2097152&&(i.$$scope={dirty:r,ctx:s}),t.$set(i)},i(s){l||(b(t.$$.fragment,s),l=!0)},o(s){D(t.$$.fragment,s),l=!1},d(s){s&&g(e),te(t)}}}function Da(n){let e,t=Pt(n[7].timestamp*1e3)+"",l;return{c(){e=M("span"),l=W(t),this.h()},l(s){e=E(s,"SPAN",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","line-clamp-1")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r[0]&128&&t!==(t=Pt(s[7].timestamp*1e3)+"")&&Z(l,t)},d(s){s&&g(e)}}}function Va(n){let e,t,l;function s(a,f){return a[7].user?Na:a[14].showUsername||a[16].name!==a[0].name?Ea:Ma}let r=s(n),i=r(n),o=n[7].timestamp&&Qs(n);return{c(){i.c(),e=j(),o&&o.c(),t=ce()},l(a){i.l(a),e=A(a),o&&o.l(a),t=ce()},m(a,f){i.m(a,f),V(a,e,f),o&&o.m(a,f),V(a,t,f),l=!0},p(a,f){r===(r=s(a))&&i?i.p(a,f):(i.d(1),i=r(a),i&&(i.c(),i.m(e.parentNode,e))),a[7].timestamp?o?(o.p(a,f),f[0]&128&&b(o,1)):(o=Qs(a),o.c(),b(o,1),o.m(t.parentNode,t)):o&&(ne(),D(o,1,1,()=>{o=null}),re())},i(a){l||(b(o),l=!0)},o(a){D(o),l=!1},d(a){a&&(g(e),g(t)),i.d(a),o&&o.d(a)}}}function Ys(n){let e,t,l=De(n[7].files),s=[];for(let i=0;i<l.length;i+=1)s[i]=Xs(Gs(n,l,i));const r=i=>D(s[i],1,1,()=>{s[i]=null});return{c(){e=M("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);for(let a=0;a<s.length;a+=1)s[a].l(o);o.forEach(g),this.h()},h(){h(e,"class","mt-2.5 mb-1 w-full flex flex-col justify-end overflow-x-auto gap-1 flex-wrap")},m(i,o){V(i,e,o);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(i,o){if(o[0]&16512){l=De(i[7].files);let a;for(a=0;a<l.length;a+=1){const f=Gs(i,l,a);s[a]?(s[a].p(f,o),b(s[a],1)):(s[a]=Xs(f),s[a].c(),b(s[a],1),s[a].m(e,null))}for(ne(),a=l.length;a<s.length;a+=1)r(a);re()}},i(i){if(!t){for(let o=0;o<l.length;o+=1)b(s[o]);t=!0}},o(i){s=s.filter(Boolean);for(let o=0;o<s.length;o+=1)D(s[o]);t=!1},d(i){i&&g(e),qe(s,i)}}}function Ca(n){var l;let e,t;return e=new Lr({props:{item:n[49],url:n[49].url,name:n[49].name,type:n[49].type,size:(l=n[49])==null?void 0:l.size,colorClassName:"bg-white dark:bg-gray-850 "}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r[0]&128&&(i.item=s[49]),r[0]&128&&(i.url=s[49].url),r[0]&128&&(i.name=s[49].name),r[0]&128&&(i.type=s[49].type),r[0]&128&&(i.size=(o=s[49])==null?void 0:o.size),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Ta(n){let e,t;return e=new Tn({props:{src:n[49].url,imageClassName:" max-h-96 rounded-lg"}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.src=l[49].url),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Xs(n){let e,t,l,s,r,i;const o=[Ta,Ca],a=[];function f(u,c){return u[49].type==="image"?0:1}return t=f(n),l=a[t]=o[t](n),{c(){e=M("div"),l.c(),s=j(),this.h()},l(u){e=E(u,"DIV",{class:!0});var c=w(e);l.l(c),s=A(c),c.forEach(g),this.h()},h(){var u;h(e,"class",r=((u=n[14])==null?void 0:u.chatBubble)??!0?"self-end":"")},m(u,c){V(u,e,c),a[t].m(e,null),p(e,s),i=!0},p(u,c){var d;let m=t;t=f(u),t===m?a[t].p(u,c):(ne(),D(a[m],1,1,()=>{a[m]=null}),re(),l=a[t],l?l.p(u,c):(l=a[t]=o[t](u),l.c()),b(l,1),l.m(e,s)),(!i||c[0]&16384&&r!==(r=((d=u[14])==null?void 0:d.chatBubble)??!0?"self-end":""))&&h(e,"class",r)},i(u){i||(b(l),i=!0)},o(u){D(l),i=!1},d(u){u&&g(e),a[t].d()}}}function $s(n){let e,t,l,s;const r=[Ra,Ba],i=[];function o(a,f){return a[10]===!0?0:1}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function Ba(n){var P,R;let e,t,l,s,r,i,o,a,f,u,c,m,d,_,k=n[7].content&&xs(n),v=!(((P=n[14])==null?void 0:P.chatBubble)??!0)&&en(n),N=!n[6]&&ln(n);u=new Be({props:{content:n[13].t("Copy"),placement:"bottom",$$slots:{default:[Pa]},$$scope:{ctx:n}}});let y=!n[6]&&(!n[5]||n[1].length>1)&&sn(n),T=(((R=n[14])==null?void 0:R.chatBubble)??!0)&&nn(n);return{c(){e=M("div"),t=M("div"),l=M("div"),k&&k.c(),i=j(),o=M("div"),v&&v.c(),a=j(),N&&N.c(),f=j(),$(u.$$.fragment),c=j(),y&&y.c(),m=j(),T&&T.c(),this.h()},l(I){e=E(I,"DIV",{class:!0});var B=w(e);t=E(B,"DIV",{class:!0});var S=w(t);l=E(S,"DIV",{class:!0});var L=w(l);k&&k.l(L),L.forEach(g),S.forEach(g),i=A(B),o=E(B,"DIV",{class:!0});var C=w(o);v&&v.l(C),a=A(C),N&&N.l(C),f=A(C),x(u.$$.fragment,C),c=A(C),y&&y.l(C),m=A(C),T&&T.l(C),C.forEach(g),B.forEach(g),this.h()},h(){var I,B,S;h(l,"class",s="rounded-3xl "+(((I=n[14])==null?void 0:I.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${n[7].files?"rounded-tr-lg":""}`:" w-full")),h(t,"class",r="flex "+(((B=n[14])==null?void 0:B.chatBubble)??!0?"justify-end pb-1":"w-full")),h(o,"class",d="flex "+(((S=n[14])==null?void 0:S.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"),h(e,"class","w-full")},m(I,B){V(I,e,B),p(e,t),p(t,l),k&&k.m(l,null),p(e,i),p(e,o),v&&v.m(o,null),p(o,a),N&&N.m(o,null),p(o,f),ee(u,o,null),p(o,c),y&&y.m(o,null),p(o,m),T&&T.m(o,null),_=!0},p(I,B){var L,C,O,z,le;I[7].content?k?(k.p(I,B),B[0]&128&&b(k,1)):(k=xs(I),k.c(),b(k,1),k.m(l,null)):k&&(ne(),D(k,1,1,()=>{k=null}),re()),(!_||B[0]&16512&&s!==(s="rounded-3xl "+(((L=I[14])==null?void 0:L.chatBubble)??!0?`max-w-[90%] px-5 py-2  bg-gray-50 dark:bg-gray-850 ${I[7].files?"rounded-tr-lg":""}`:" w-full")))&&h(l,"class",s),(!_||B[0]&16384&&r!==(r="flex "+(((C=I[14])==null?void 0:C.chatBubble)??!0?"justify-end pb-1":"w-full")))&&h(t,"class",r),((O=I[14])==null?void 0:O.chatBubble)??!0?v&&(v.d(1),v=null):v?v.p(I,B):(v=en(I),v.c(),v.m(o,a)),I[6]?N&&(ne(),D(N,1,1,()=>{N=null}),re()):N?(N.p(I,B),B[0]&64&&b(N,1)):(N=ln(I),N.c(),b(N,1),N.m(o,f));const S={};B[0]&8192&&(S.content=I[13].t("Copy")),B[0]&128|B[1]&2097152&&(S.$$scope={dirty:B,ctx:I}),u.$set(S),!I[6]&&(!I[5]||I[1].length>1)?y?(y.p(I,B),B[0]&98&&b(y,1)):(y=sn(I),y.c(),b(y,1),y.m(o,m)):y&&(ne(),D(y,1,1,()=>{y=null}),re()),((z=I[14])==null?void 0:z.chatBubble)??!0?T?T.p(I,B):(T=nn(I),T.c(),T.m(o,null)):T&&(T.d(1),T=null),(!_||B[0]&16384&&d!==(d="flex "+(((le=I[14])==null?void 0:le.chatBubble)??!0?"justify-end":"")+" text-gray-600 dark:text-gray-500"))&&h(o,"class",d)},i(I){_||(b(k),b(N),b(u.$$.fragment,I),b(y),_=!0)},o(I){D(k),D(N),D(u.$$.fragment,I),D(y),_=!1},d(I){I&&g(e),k&&k.d(),v&&v.d(),N&&N.d(),te(u),y&&y.d(),T&&T.d()}}}function Ra(n){let e,t,l,s,r,i,o,a,f=n[13].t("Save")+"",u,c,m,d,_=n[13].t("Cancel")+"",k,v,N,y=n[13].t("Send")+"",T,P,R;return{c(){e=M("div"),t=M("div"),l=M("textarea"),r=j(),i=M("div"),o=M("div"),a=M("button"),u=W(f),c=j(),m=M("div"),d=M("button"),k=W(_),v=j(),N=M("button"),T=W(y),this.h()},l(I){e=E(I,"DIV",{class:!0});var B=w(e);t=E(B,"DIV",{class:!0});var S=w(t);l=E(S,"TEXTAREA",{id:!0,class:!0}),w(l).forEach(g),S.forEach(g),r=A(B),i=E(B,"DIV",{class:!0});var L=w(i);o=E(L,"DIV",{});var C=w(o);a=E(C,"BUTTON",{id:!0,class:!0});var O=w(a);u=q(O,f),O.forEach(g),C.forEach(g),c=A(L),m=E(L,"DIV",{class:!0});var z=w(m);d=E(z,"BUTTON",{id:!0,class:!0});var le=w(d);k=q(le,_),le.forEach(g),v=A(z),N=E(z,"BUTTON",{id:!0,class:!0});var me=w(N);T=q(me,y),me.forEach(g),z.forEach(g),L.forEach(g),B.forEach(g),this.h()},h(){h(l,"id",s="message-edit-"+n[7].id),h(l,"class","bg-transparent outline-hidden w-full resize-none"),h(t,"class","max-h-96 overflow-auto"),h(a,"id","save-edit-message-button"),h(a,"class","px-4 py-2 bg-gray-50 hover:bg-gray-100 dark:bg-gray-800 dark:hover:bg-gray-700 border dark:border-gray-700 text-gray-700 dark:text-gray-200 transition rounded-3xl"),h(d,"id","close-edit-message-button"),h(d,"class","px-4 py-2 bg-white dark:bg-gray-900 hover:bg-gray-100 text-gray-800 dark:text-gray-100 transition rounded-3xl"),h(N,"id","confirm-edit-message-button"),h(N,"class","px-4 py-2 bg-gray-900 dark:bg-white hover:bg-gray-850 text-gray-100 dark:text-gray-800 transition rounded-3xl"),h(m,"class","flex space-x-1.5"),h(i,"class","mt-2 mb-1 flex justify-between text-sm font-medium"),h(e,"class","w-full bg-gray-50 dark:bg-gray-800 rounded-3xl px-5 py-3 mb-2")},m(I,B){V(I,e,B),p(e,t),p(t,l),n[30](l),rt(l,n[11]),p(e,r),p(e,i),p(i,o),p(o,a),p(a,u),p(i,c),p(i,m),p(m,d),p(d,k),p(m,v),p(m,N),p(N,T),P||(R=[ue(l,"input",n[31]),ue(l,"input",Ua),ue(l,"keydown",n[32]),ue(a,"click",n[33]),ue(d,"click",n[34]),ue(N,"click",n[35])],P=!0)},p(I,B){B[0]&128&&s!==(s="message-edit-"+I[7].id)&&h(l,"id",s),B[0]&2048&&rt(l,I[11]),B[0]&8192&&f!==(f=I[13].t("Save")+"")&&Z(u,f),B[0]&8192&&_!==(_=I[13].t("Cancel")+"")&&Z(k,_),B[0]&8192&&y!==(y=I[13].t("Send")+"")&&Z(T,y)},i:ve,o:ve,d(I){I&&g(e),n[30](null),P=!1,Qe(R)}}}function xs(n){let e,t;return e=new yt({props:{id:n[7].id,content:n[7].content}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&128&&(r.id=l[7].id),s[0]&128&&(r.content=l[7].content),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function en(n){let e,t=n[1].length>1&&tn(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=tn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function tn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[9]?Oa:Sa}let c=u(n),m=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=M("button"),i.innerHTML=o,this.h()},l(d){e=E(d,"DIV",{class:!0,dir:!0});var _=w(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=A(_),m.l(_),r=A(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[36]),ue(i,"click",n[40])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Qe(f)}}}function Sa(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[39]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&g(e),o=!1,a()}}}function Oa(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=W("/"),a=W(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);t=E(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(m,"/"),a=q(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",Wa),ue(t,"blur",n[37]),ue(t,"keydown",n[38])],f=!0)},p(c,m){m[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),m[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&g(e),f=!1,Qe(u)}}}function ln(n){let e,t;return e=new Be({props:{content:n[13].t("Edit"),placement:"bottom",$$slots:{default:[La]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Edit")),s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function La(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-tlrz1q"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition edit-user-message-button")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[41]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function Pa(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.3" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="M15.666 3.888A2.25 2.25 0 0013.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 01-.75.75H9a.75.75 0 01-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 01-2.25 2.25H6.75A2.25 2.25 0 014.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 011.927-.184"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-1ivgdx2"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1.5 hover:bg-black/5 dark:hover:bg-white/5 rounded-lg dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[42]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function sn(n){let e,t;return e=new Be({props:{content:n[13].t("Delete"),placement:"bottom",$$slots:{default:[Ha]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&8192&&(r.content=l[13].t("Delete")),s[0]&256|s[1]&2097152&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function Ha(n){let e,t='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',l,s;return{c(){e=M("button"),e.innerHTML=t,this.h()},l(r){e=E(r,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(e)!=="svelte-146x2zz"&&(e.innerHTML=t),this.h()},h(){h(e,"class","invisible group-hover:visible p-1 rounded-sm dark:hover:text-white hover:text-black transition")},m(r,i){V(r,e,i),l||(s=ue(e,"click",n[43]),l=!0)},p:ve,d(r){r&&g(e),l=!1,s()}}}function nn(n){let e,t=n[1].length>1&&rn(n);return{c(){t&&t.c(),e=ce()},l(l){t&&t.l(l),e=ce()},m(l,s){t&&t.m(l,s),V(l,e,s)},p(l,s){l[1].length>1?t?t.p(l,s):(t=rn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(l){l&&g(e),t&&t.d(l)}}}function rn(n){let e,t,l='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>',s,r,i,o='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" class="size-3.5"><path stroke-linecap="round" stroke-linejoin="round" d="m8.25 4.5 7.5 7.5-7.5 7.5"></path></svg>',a,f;function u(d,_){return d[9]?Aa:ja}let c=u(n),m=c(n);return{c(){e=M("div"),t=M("button"),t.innerHTML=l,s=j(),m.c(),r=j(),i=M("button"),i.innerHTML=o,this.h()},l(d){e=E(d,"DIV",{class:!0,dir:!0});var _=w(e);t=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(t)!=="svelte-buado9"&&(t.innerHTML=l),s=A(_),m.l(_),r=A(_),i=E(_,"BUTTON",{class:!0,"data-svelte-h":!0}),Ue(i)!=="svelte-4phel2"&&(i.innerHTML=o),_.forEach(g),this.h()},h(){h(t,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(i,"class","self-center p-1 hover:bg-black/5 dark:hover:bg-white/5 dark:hover:text-white hover:text-black rounded-md transition"),h(e,"class","flex self-center"),h(e,"dir","ltr")},m(d,_){V(d,e,_),p(e,t),p(e,s),m.m(e,null),p(e,r),p(e,i),a||(f=[ue(t,"click",n[44]),ue(i,"click",n[48])],a=!0)},p(d,_){c===(c=u(d))&&m?m.p(d,_):(m.d(1),m=c(d),m&&(m.c(),m.m(e,r)))},d(d){d&&g(e),m.d(),a=!1,Qe(f)}}}function ja(n){let e,t=n[1].indexOf(n[7].id)+1+"",l,s,r=n[1].length+"",i,o,a;return{c(){e=M("div"),l=W(t),s=W("/"),i=W(r),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);l=q(u,t),s=q(u,"/"),i=q(u,r),u.forEach(g),this.h()},h(){h(e,"class","text-sm tracking-widest font-semibold self-center dark:text-gray-100 min-w-fit")},m(f,u){V(f,e,u),p(e,l),p(e,s),p(e,i),o||(a=ue(e,"dblclick",n[47]),o=!0)},p(f,u){u[0]&130&&t!==(t=f[1].indexOf(f[7].id)+1+"")&&Z(l,t),u[0]&2&&r!==(r=f[1].length+"")&&Z(i,r)},d(f){f&&g(e),o=!1,a()}}}function Aa(n){let e,t,l,s,r,i,o=n[1].length+"",a,f,u;return{c(){e=M("div"),t=M("input"),i=W("/"),a=W(o),this.h()},l(c){e=E(c,"DIV",{class:!0});var m=w(e);t=E(m,"INPUT",{id:!0,type:!0,min:!0,max:!0,class:!0}),i=q(m,"/"),a=q(m,o),m.forEach(g),this.h()},h(){h(t,"id",l="message-index-input-"+n[7].id),h(t,"type","number"),t.value=s=n[1].indexOf(n[7].id)+1,h(t,"min","1"),h(t,"max",r=n[1].length),h(t,"class","bg-transparent font-semibold self-center dark:text-gray-100 min-w-fit outline-hidden"),h(e,"class","text-sm flex justify-center font-semibold self-center dark:text-gray-100 min-w-fit")},m(c,m){V(c,e,m),p(e,t),p(e,i),p(e,a),f||(u=[ue(t,"focus",qa),ue(t,"blur",n[45]),ue(t,"keydown",n[46])],f=!0)},p(c,m){m[0]&128&&l!==(l="message-index-input-"+c[7].id)&&h(t,"id",l),m[0]&130&&s!==(s=c[1].indexOf(c[7].id)+1)&&t.value!==s&&(t.value=s),m[0]&2&&r!==(r=c[1].length)&&h(t,"max",r),m[0]&2&&o!==(o=c[1].length+"")&&Z(a,o)},d(c){c&&g(e),f=!1,Qe(u)}}}function za(n){var P,R;let e,t,l,s,r,i,o,a,f,u,c,m,d;function _(I){n[27](I)}let k={title:n[13].t("Delete message?")};n[8]!==void 0&&(k.show=n[8]),e=new Sn({props:k}),Ae.push(()=>Ke(e,"show",_)),e.$on("confirm",n[28]);let v=!(((P=n[14])==null?void 0:P.chatBubble)??!0)&&Zs(n),N=!(((R=n[14])==null?void 0:R.chatBubble)??!0)&&Ks(n),y=n[7].files&&Ys(n),T=n[7].content!==""&&$s(n);return{c(){$(e.$$.fragment),l=j(),s=M("div"),v&&v.c(),r=j(),i=M("div"),N&&N.c(),o=j(),a=M("div"),y&&y.c(),f=j(),T&&T.c(),this.h()},l(I){x(e.$$.fragment,I),l=A(I),s=E(I,"DIV",{class:!0,dir:!0,id:!0});var B=w(s);v&&v.l(B),r=A(B),i=E(B,"DIV",{class:!0});var S=w(i);N&&N.l(S),o=A(S),a=E(S,"DIV",{class:!0});var L=w(a);y&&y.l(L),f=A(L),T&&T.l(L),L.forEach(g),S.forEach(g),B.forEach(g),this.h()},h(){h(a,"class",u="chat-"+n[7].role+" w-full min-w-full markdown-prose"),h(i,"class","flex-auto w-0 max-w-full pl-1"),h(s,"class","flex w-full user-message"),h(s,"dir",c=n[14].chatDirection),h(s,"id",m="message-"+n[7].id)},m(I,B){ee(e,I,B),V(I,l,B),V(I,s,B),v&&v.m(s,null),p(s,r),p(s,i),N&&N.m(i,null),p(i,o),p(i,a),y&&y.m(a,null),p(a,f),T&&T.m(a,null),d=!0},p(I,B){var L,C;const S={};B[0]&8192&&(S.title=I[13].t("Delete message?")),!t&&B[0]&256&&(t=!0,S.show=I[8],Ze(()=>t=!1)),e.$set(S),((L=I[14])==null?void 0:L.chatBubble)??!0?v&&(ne(),D(v,1,1,()=>{v=null}),re()):v?(v.p(I,B),B[0]&16384&&b(v,1)):(v=Zs(I),v.c(),b(v,1),v.m(s,r)),((C=I[14])==null?void 0:C.chatBubble)??!0?N&&(ne(),D(N,1,1,()=>{N=null}),re()):N?(N.p(I,B),B[0]&16384&&b(N,1)):(N=Ks(I),N.c(),b(N,1),N.m(i,o)),I[7].files?y?(y.p(I,B),B[0]&128&&b(y,1)):(y=Ys(I),y.c(),b(y,1),y.m(a,f)):y&&(ne(),D(y,1,1,()=>{y=null}),re()),I[7].content!==""?T?(T.p(I,B),B[0]&128&&b(T,1)):(T=$s(I),T.c(),b(T,1),T.m(a,null)):T&&(ne(),D(T,1,1,()=>{T=null}),re()),(!d||B[0]&128&&u!==(u="chat-"+I[7].role+" w-full min-w-full markdown-prose"))&&h(a,"class",u),(!d||B[0]&16384&&c!==(c=I[14].chatDirection))&&h(s,"dir",c),(!d||B[0]&128&&m!==(m="message-"+I[7].id))&&h(s,"id",m)},i(I){d||(b(e.$$.fragment,I),b(v),b(N),b(y),b(T),d=!0)},o(I){D(e.$$.fragment,I),D(v),D(N),D(y),D(T),d=!1},d(I){I&&(g(l),g(s)),te(e,I),v&&v.d(),N&&N.d(),y&&y.d(),T&&T.d()}}}const Ua=n=>{n.target.style.height="",n.target.style.height=`${n.target.scrollHeight}px`},Wa=n=>{n.target.select()},qa=n=>{n.target.select()};function Fa(n,e,t){let l,s,r,i;Ee(n,At,X=>t(14,s=X)),Ee(n,jt,X=>t(15,r=X)),Ee(n,zt,X=>t(16,i=X));const o=Fe("i18n");Ee(n,o,X=>t(13,l=X)),it.extend(Dn);let{user:a}=e,{history:f}=e,{messageId:u}=e,{siblings:c}=e,{gotoMessage:m}=e,{showPreviousMessage:d}=e,{showNextMessage:_}=e,{editMessage:k}=e,{deleteMessage:v}=e,{isFirstMessage:N}=e,{readOnly:y}=e,T=!1,P=!1,R=!1,I="",B,S=JSON.parse(JSON.stringify(f.messages[u]));const L=async X=>{await Nn(X)&&je.success(l.t("Copying to clipboard was successful!"))},C=async()=>{t(10,R=!0),t(11,I=S.content),await Ne(),t(12,B.style.height="",B),t(12,B.style.height=`${B.scrollHeight}px`,B),B==null||B.focus()},O=async(X=!0)=>{k(S.id,I,X),t(10,R=!1),t(11,I="")},z=()=>{t(10,R=!1),t(11,I="")},le=async()=>{v(S.id)};bt(()=>{});function me(X){T=X,t(8,T)}const ie=()=>{le()},se=X=>X.id===S.user;function _e(X){Ae[X?"unshift":"push"](()=>{B=X,t(12,B)})}function ge(){I=this.value,t(11,I)}const Ie=X=>{var ze,Ye;X.key==="Escape"&&((ze=document.getElementById("close-edit-message-button"))==null||ze.click());const Se=X.metaKey||X.ctrlKey,He=X.key==="Enter";Se&&He&&((Ye=document.getElementById("confirm-edit-message-button"))==null||Ye.click())},Q=()=>{O(!1)},J=()=>{z()},oe=()=>{O()},ye=()=>{d(S)},U=X=>{m(S,X.target.value-1),t(9,P=!1)},fe=X=>{X.key==="Enter"&&(m(S,X.target.value-1),t(9,P=!1))},de=async()=>{t(9,P=!0),await Ne();const X=document.getElementById(`message-index-input-${S.id}`);X&&(X.focus(),X.select())},he=()=>{_(S)},be=()=>{C()},H=()=>{L(S.content)},K=()=>{t(8,T=!0)},Y=()=>{d(S)},G=X=>{m(S,X.target.value-1),t(9,P=!1)},ae=X=>{X.key==="Enter"&&(m(S,X.target.value-1),t(9,P=!1))},pe=async()=>{t(9,P=!0),await Ne();const X=document.getElementById(`message-index-input-${S.id}`);X&&(X.focus(),X.select())},Ce=()=>{_(S)};return n.$$set=X=>{"user"in X&&t(0,a=X.user),"history"in X&&t(23,f=X.history),"messageId"in X&&t(24,u=X.messageId),"siblings"in X&&t(1,c=X.siblings),"gotoMessage"in X&&t(2,m=X.gotoMessage),"showPreviousMessage"in X&&t(3,d=X.showPreviousMessage),"showNextMessage"in X&&t(4,_=X.showNextMessage),"editMessage"in X&&t(25,k=X.editMessage),"deleteMessage"in X&&t(26,v=X.deleteMessage),"isFirstMessage"in X&&t(5,N=X.isFirstMessage),"readOnly"in X&&t(6,y=X.readOnly)},n.$$.update=()=>{n.$$.dirty[0]&25165952&&f.messages&&JSON.stringify(S)!==JSON.stringify(f.messages[u])&&t(7,S=JSON.parse(JSON.stringify(f.messages[u])))},[a,c,m,d,_,N,y,S,T,P,R,I,B,l,s,r,i,o,L,C,O,z,le,f,u,k,v,me,ie,se,_e,ge,Ie,Q,J,oe,ye,U,fe,de,he,be,H,K,Y,G,ae,pe,Ce]}class Ja extends Le{constructor(e){super(),Pe(this,e,Fa,za,Te,{user:0,history:23,messageId:24,siblings:1,gotoMessage:2,showPreviousMessage:3,showNextMessage:4,editMessage:25,deleteMessage:26,isFirstMessage:5,readOnly:6},null,[-1,-1])}}function on(n){let e,t,l,s;const r=[Ka,Za,Ga],i=[];function o(a,f){var u,c;return a[0].messages[a[3]].role==="user"?0:(((c=(u=a[0].messages[a[0].messages[a[3]].parentId])==null?void 0:u.models)==null?void 0:c.length)??1)===1?1:2}return e=o(n),t=i[e]=r[e](n),{c(){t.c(),l=ce()},l(a){t.l(a),l=ce()},m(a,f){i[e].m(a,f),V(a,l,f),s=!0},p(a,f){let u=e;e=o(a),e===u?i[e].p(a,f):(ne(),D(i[u],1,1,()=>{i[u]=null}),re(),t=i[e],t?t.p(a,f):(t=i[e]=r[e](a),t.c()),b(t,1),t.m(l.parentNode,l))},i(a){s||(b(t),s=!0)},o(a){D(t),s=!1},d(a){a&&g(l),i[e].d(a)}}}function Ga(n){var i;let e,t,l;function s(o){n[22](o)}let r={chatId:n[1],messageId:n[3],isLastMessage:n[3]===((i=n[0])==null?void 0:i.currentId),updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],mergeResponses:n[17],triggerScroll:n[19],addMessages:n[18],readOnly:n[20]};return n[0]!==void 0&&(r.history=n[0]),e=new Ia({props:r}),Ae.push(()=>Ke(e,"history",s)),{c(){$(e.$$.fragment)},l(o){x(e.$$.fragment,o)},m(o,a){ee(e,o,a),l=!0},p(o,a){var u;const f={};a&2&&(f.chatId=o[1]),a&8&&(f.messageId=o[3]),a&9&&(f.isLastMessage=o[3]===((u=o[0])==null?void 0:u.currentId)),a&256&&(f.updateChat=o[8]),a&512&&(f.editMessage=o[9]),a&1024&&(f.saveMessage=o[10]),a&4096&&(f.rateMessage=o[12]),a&8192&&(f.actionMessage=o[13]),a&16384&&(f.submitMessage=o[14]),a&2048&&(f.deleteMessage=o[11]),a&65536&&(f.continueResponse=o[16]),a&32768&&(f.regenerateResponse=o[15]),a&131072&&(f.mergeResponses=o[17]),a&524288&&(f.triggerScroll=o[19]),a&262144&&(f.addMessages=o[18]),a&1048576&&(f.readOnly=o[20]),!t&&a&1&&(t=!0,f.history=o[0],Ze(()=>t=!1)),e.$set(f)},i(o){l||(b(e.$$.fragment,o),l=!0)},o(o){D(e.$$.fragment,o),l=!1},d(o){te(e,o)}}}function Za(n){var l;let e,t;return e=new Ln({props:{chatId:n[1],history:n[0],messageId:n[3],isLastMessage:n[3]===n[0].currentId,siblings:((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],updateChat:n[8],editMessage:n[9],saveMessage:n[10],rateMessage:n[12],actionMessage:n[13],submitMessage:n[14],deleteMessage:n[11],continueResponse:n[16],regenerateResponse:n[15],addMessages:n[18],readOnly:n[20]}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r&2&&(i.chatId=s[1]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&9&&(i.isLastMessage=s[3]===s[0].currentId),r&9&&(i.siblings=((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&256&&(i.updateChat=s[8]),r&512&&(i.editMessage=s[9]),r&1024&&(i.saveMessage=s[10]),r&4096&&(i.rateMessage=s[12]),r&8192&&(i.actionMessage=s[13]),r&16384&&(i.submitMessage=s[14]),r&2048&&(i.deleteMessage=s[11]),r&65536&&(i.continueResponse=s[16]),r&32768&&(i.regenerateResponse=s[15]),r&262144&&(i.addMessages=s[18]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Ka(n){var l;let e,t;return e=new Ja({props:{user:n[4],history:n[0],messageId:n[3],isFirstMessage:n[2]===0,siblings:n[0].messages[n[3]].parentId!==null?((l=n[0].messages[n[0].messages[n[3]].parentId])==null?void 0:l.childrenIds)??[]:Object.values(n[0].messages).filter(an).map(fn)??[],gotoMessage:n[5],showPreviousMessage:n[6],showNextMessage:n[7],editMessage:n[9],deleteMessage:n[11],readOnly:n[20]}}),{c(){$(e.$$.fragment)},l(s){x(e.$$.fragment,s)},m(s,r){ee(e,s,r),t=!0},p(s,r){var o;const i={};r&16&&(i.user=s[4]),r&1&&(i.history=s[0]),r&8&&(i.messageId=s[3]),r&4&&(i.isFirstMessage=s[2]===0),r&9&&(i.siblings=s[0].messages[s[3]].parentId!==null?((o=s[0].messages[s[0].messages[s[3]].parentId])==null?void 0:o.childrenIds)??[]:Object.values(s[0].messages).filter(an).map(fn)??[]),r&32&&(i.gotoMessage=s[5]),r&64&&(i.showPreviousMessage=s[6]),r&128&&(i.showNextMessage=s[7]),r&512&&(i.editMessage=s[9]),r&2048&&(i.deleteMessage=s[11]),r&1048576&&(i.readOnly=s[20]),e.$set(i)},i(s){t||(b(e.$$.fragment,s),t=!0)},o(s){D(e.$$.fragment,s),t=!1},d(s){te(e,s)}}}function Qa(n){let e,t,l,s=n[0].messages[n[3]]&&on(n);return{c(){e=M("div"),s&&s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=w(e);s&&s.l(i),i.forEach(g),this.h()},h(){var r;h(e,"class",t="flex flex-col justify-between px-5 mb-3 w-full "+(((r=n[21])==null?void 0:r.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group")},m(r,i){V(r,e,i),s&&s.m(e,null),l=!0},p(r,[i]){var o;r[0].messages[r[3]]?s?(s.p(r,i),i&9&&b(s,1)):(s=on(r),s.c(),b(s,1),s.m(e,null)):s&&(ne(),D(s,1,1,()=>{s=null}),re()),(!l||i&2097152&&t!==(t="flex flex-col justify-between px-5 mb-3 w-full "+(((o=r[21])==null?void 0:o.widescreenMode)??null?"max-w-full":"max-w-5xl")+" mx-auto rounded-lg group"))&&h(e,"class",t)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(e),s&&s.d()}}}const an=n=>n.parentId===null,fn=n=>n.id;function Ya(n,e,t){let l;Ee(n,At,C=>t(21,l=C)),gt(),Fe("i18n");let{chatId:s}=e,{idx:r=0}=e,{history:i}=e,{messageId:o}=e,{user:a}=e,{gotoMessage:f}=e,{showPreviousMessage:u}=e,{showNextMessage:c}=e,{updateChat:m}=e,{editMessage:d}=e,{saveMessage:_}=e,{deleteMessage:k}=e,{rateMessage:v}=e,{actionMessage:N}=e,{submitMessage:y}=e,{regenerateResponse:T}=e,{continueResponse:P}=e,{mergeResponses:R}=e,{addMessages:I}=e,{triggerScroll:B}=e,{readOnly:S=!1}=e;function L(C){i=C,t(0,i)}return n.$$set=C=>{"chatId"in C&&t(1,s=C.chatId),"idx"in C&&t(2,r=C.idx),"history"in C&&t(0,i=C.history),"messageId"in C&&t(3,o=C.messageId),"user"in C&&t(4,a=C.user),"gotoMessage"in C&&t(5,f=C.gotoMessage),"showPreviousMessage"in C&&t(6,u=C.showPreviousMessage),"showNextMessage"in C&&t(7,c=C.showNextMessage),"updateChat"in C&&t(8,m=C.updateChat),"editMessage"in C&&t(9,d=C.editMessage),"saveMessage"in C&&t(10,_=C.saveMessage),"deleteMessage"in C&&t(11,k=C.deleteMessage),"rateMessage"in C&&t(12,v=C.rateMessage),"actionMessage"in C&&t(13,N=C.actionMessage),"submitMessage"in C&&t(14,y=C.submitMessage),"regenerateResponse"in C&&t(15,T=C.regenerateResponse),"continueResponse"in C&&t(16,P=C.continueResponse),"mergeResponses"in C&&t(17,R=C.mergeResponses),"addMessages"in C&&t(18,I=C.addMessages),"triggerScroll"in C&&t(19,B=C.triggerScroll),"readOnly"in C&&t(20,S=C.readOnly)},[i,s,r,o,a,f,u,c,m,d,_,k,v,N,y,T,P,R,I,B,S,l,L]}class Xa extends Le{constructor(e){super(),Pe(this,e,Ya,Qa,Te,{chatId:1,idx:2,history:0,messageId:3,user:4,gotoMessage:5,showPreviousMessage:6,showNextMessage:7,updateChat:8,editMessage:9,saveMessage:10,deleteMessage:11,rateMessage:12,actionMessage:13,submitMessage:14,regenerateResponse:15,continueResponse:16,mergeResponses:17,addMessages:18,triggerScroll:19,readOnly:20})}}function un(n,e,t){const l=n.slice();return l[13]=e[t],l[15]=t,l}function $a(n){let e,t,l,s;return{c(){e=M("div"),t=W(n[3]),l=W("  v"),s=W(hl),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=w(e);t=q(i,n[3]),l=q(i,"  v"),s=q(i,hl),i.forEach(g),this.h()},h(){h(e,"class","flex w-full text-center items-center justify-center self-start text-gray-400 dark:text-gray-600")},m(r,i){V(r,e,i),p(e,t),p(e,l),p(e,s)},p(r,i){i&8&&Z(t,r[3])},i:ve,o:ve,d(r){r&&g(e)}}}function xa(n){let e,t,l=n[2].t("Suggested")+"",s,r;return e=new Vr({}),{c(){$(e.$$.fragment),t=j(),s=W(l)},l(i){x(e.$$.fragment,i),t=A(i),s=q(i,l)},m(i,o){ee(e,i,o),V(i,t,o),V(i,s,o),r=!0},p(i,o){(!r||o&4)&&l!==(l=i[2].t("Suggested")+"")&&Z(s,l)},i(i){r||(b(e.$$.fragment,i),r=!0)},o(i){D(e.$$.fragment,i),r=!1},d(i){i&&(g(t),g(s)),te(e,i)}}}function cn(n){let e=[],t=new Map,l,s=De(n[1]);const r=i=>i[13].id||i[13].content;for(let i=0;i<s.length;i+=1){let o=un(n,s,i),a=r(o);t.set(a,e[i]=dn(a,o))}return{c(){for(let i=0;i<e.length;i+=1)e[i].c();l=ce()},l(i){for(let o=0;o<e.length;o+=1)e[o].l(i);l=ce()},m(i,o){for(let a=0;a<e.length;a+=1)e[a]&&e[a].m(i,o);V(i,l,o)},p(i,o){o&38&&(s=De(i[1]),e=Gt(e,o,r,1,i,s,t,l.parentNode,cr,dn,l,un))},d(i){i&&g(l);for(let o=0;o<e.length;o+=1)e[o].d(i)}}}function ef(n){let e,t=n[13].content+"",l,s,r,i=n[2].t("Prompt")+"",o;return{c(){e=M("div"),l=W(t),s=j(),r=M("div"),o=W(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(g),s=A(a),r=E(a,"DIV",{class:!0});var u=w(r);o=q(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].content+"")&&Z(l,t),f&4&&i!==(i=a[2].t("Prompt")+"")&&Z(o,i)},d(a){a&&(g(e),g(s),g(r))}}}function tf(n){let e,t=n[13].title[0]+"",l,s,r,i=n[13].title[1]+"",o;return{c(){e=M("div"),l=W(t),s=j(),r=M("div"),o=W(i),this.h()},l(a){e=E(a,"DIV",{class:!0});var f=w(e);l=q(f,t),f.forEach(g),s=A(a),r=E(a,"DIV",{class:!0});var u=w(r);o=q(u,i),u.forEach(g),this.h()},h(){h(e,"class","font-medium dark:text-gray-300 dark:group-hover:text-gray-200 transition line-clamp-1"),h(r,"class","text-xs text-gray-500 font-normal line-clamp-1")},m(a,f){V(a,e,f),p(e,l),V(a,s,f),V(a,r,f),p(r,o)},p(a,f){f&2&&t!==(t=a[13].title[0]+"")&&Z(l,t),f&2&&i!==(i=a[13].title[1]+"")&&Z(o,i)},d(a){a&&(g(e),g(s),g(r))}}}function dn(n,e){let t,l,s,r,i;function o(c,m){return c[13].title&&c[13].title[0]!==""?tf:ef}let a=o(e),f=a(e);function u(){return e[9](e[13])}return{key:n,first:null,c(){t=M("button"),l=M("div"),f.c(),s=j(),this.h()},l(c){t=E(c,"BUTTON",{class:!0,style:!0});var m=w(t);l=E(m,"DIV",{class:!0});var d=w(l);f.l(d),d.forEach(g),s=A(m),m.forEach(g),this.h()},h(){h(l,"class","flex flex-col text-left"),h(t,"class","waterfall flex flex-col flex-1 shrink-0 w-full justify-between px-3 py-2 rounded-xl bg-transparent hover:bg-black/5 dark:hover:bg-white/5 transition group svelte-1co34if"),St(t,"animation-delay",e[15]*60+"ms"),this.first=t},m(c,m){V(c,t,m),p(t,l),f.m(l,null),p(t,s),r||(i=ue(t,"click",u),r=!0)},p(c,m){e=c,a===(a=o(e))&&f?f.p(e,m):(f.d(1),f=a(e),f&&(f.c(),f.m(l,null))),m&2&&St(t,"animation-delay",e[15]*60+"ms")},d(c){c&&g(t),f.d(),r=!1,i()}}}function lf(n){let e,t,l,s,r,i,o;const a=[xa,$a],f=[];function u(m,d){return m[1].length>0?0:1}t=u(n),l=f[t]=a[t](n);let c=n[1].length>0&&cn(n);return{c(){e=M("div"),l.c(),s=j(),r=M("div"),c&&c.c(),this.h()},l(m){e=E(m,"DIV",{class:!0});var d=w(e);l.l(d),d.forEach(g),s=A(m),r=E(m,"DIV",{class:!0});var _=w(r);c&&c.l(_),_.forEach(g),this.h()},h(){h(e,"class","mb-1 flex gap-1 text-xs font-medium items-center text-gray-400 dark:text-gray-600"),h(r,"class",i="h-40 overflow-auto scrollbar-none "+n[0]+" items-start svelte-1co34if")},m(m,d){V(m,e,d),f[t].m(e,null),V(m,s,d),V(m,r,d),c&&c.m(r,null),o=!0},p(m,[d]){let _=t;t=u(m),t===_?f[t].p(m,d):(ne(),D(f[_],1,1,()=>{f[_]=null}),re(),l=f[t],l?l.p(m,d):(l=f[t]=a[t](m),l.c()),b(l,1),l.m(e,null)),m[1].length>0?c?c.p(m,d):(c=cn(m),c.c(),c.m(r,null)):c&&(c.d(1),c=null),(!o||d&1&&i!==(i="h-40 overflow-auto scrollbar-none "+m[0]+" items-start svelte-1co34if"))&&h(r,"class",i)},i(m){o||(b(l),o=!0)},o(m){D(l),o=!1},d(m){m&&(g(e),g(s),g(r)),f[t].d(),c&&c.d()}}}function sf(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if((n[t].id??n[t].content)!==(e[t].id??e[t].content))return!1;return!0}function nf(n,e,t){let l,s;Ee(n,gr,v=>t(3,s=v));const r=Fe("i18n");Ee(n,r,v=>t(2,l=v));const i=gt();let{suggestionPrompts:o=[]}=e,{className:a=""}=e,{inputValue:f=""}=e,u=[];const c={keys:["content","title"],threshold:.5};let m,d=[];const _=v=>{if(v.length>500)t(1,d=[]);else{const N=v.trim()&&m?m.search(v.trim()).map(y=>y.item):u;sf(d,N)||t(1,d=N)}},k=v=>i("select",v.content);return n.$$set=v=>{"suggestionPrompts"in v&&t(6,o=v.suggestionPrompts),"className"in v&&t(0,a=v.className),"inputValue"in v&&t(7,f=v.inputValue)},n.$$.update=()=>{n.$$.dirty&192&&o&&(t(8,u=[...o??[]].sort(()=>Math.random()-.5)),_(f)),n.$$.dirty&256&&(m=new Hr(u,c)),n.$$.dirty&128&&_(f)},[a,d,l,s,r,i,o,f,u,k]}class rf extends Le{constructor(e){super(),Pe(this,e,nf,lf,Te,{suggestionPrompts:6,className:0,inputValue:7})}}function hn(n,e,t){const l=n.slice();return l[14]=e[t],l[16]=t,l}function of(n){let e,t;return{c(){e=M("img"),this.h()},l(l){e=E(l,"IMG",{crossorigin:!0,src:!0,class:!0,alt:!0,draggable:!0}),this.h()},h(){var l,s,r;h(e,"crossorigin","anonymous"),Ot(e.src,t=((r=(s=(l=n[14])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.profile_image_url)??(n[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))||h(e,"src",t),h(e,"class","size-[2.7rem] rounded-full border-[1px] border-gray-200 dark:border-none"),h(e,"alt","logo"),h(e,"draggable","false")},m(l,s){V(l,e,s)},p(l,s){var r,i,o;s&33&&!Ot(e.src,t=((o=(i=(r=l[14])==null?void 0:r.info)==null?void 0:i.meta)==null?void 0:o.profile_image_url)??(l[5].language==="dg-DG"?"/doge.png":`${Lt}/static/favicon.png`))&&h(e,"src",t)},d(l){l&&g(e)}}}function mn(n){var a,f,u;let e,t,l,s,r,i;t=new Be({props:{content:Ht.parse(vt(((u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.description)??"")),placement:"right",$$slots:{default:[of]},$$scope:{ctx:n}}});function o(){return n[12](n[16])}return{c(){e=M("button"),$(t.$$.fragment),l=j()},l(c){e=E(c,"BUTTON",{});var m=w(e);x(t.$$.fragment,m),l=A(m),m.forEach(g)},m(c,m){V(c,e,m),ee(t,e,null),p(e,l),s=!0,r||(i=ue(e,"click",o),r=!0)},p(c,m){var _,k,v;n=c;const d={};m&17&&(d.content=Ht.parse(vt(((v=(k=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:k.meta)==null?void 0:v.description)??""))),m&131105&&(d.$$scope={dirty:m,ctx:n}),t.$set(d)},i(c){s||(b(t.$$.fragment,c),s=!0)},o(c){D(t.$$.fragment,c),s=!1},d(c){c&&g(e),te(t),r=!1,i()}}}function gn(n){let e,t;return e=new Be({props:{content:"This chat won't appear in history and your messages will not be saved.",className:"w-fit",placement:"top-start",$$slots:{default:[af]},$$scope:{ctx:n}}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function af(n){let e,t,l,s;return t=new Er({props:{strokeWidth:"2.5",className:"size-5"}}),{c(){e=M("div"),$(t.$$.fragment),l=W(" Temporary Chat"),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=w(e);x(t.$$.fragment,i),l=q(i," Temporary Chat"),i.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-gray-500 font-medium text-lg my-2 w-fit")},m(r,i){V(r,e,i),ee(t,e,null),p(e,l),s=!0},p:ve,i(r){s||(b(t.$$.fragment,r),s=!0)},o(r){D(t.$$.fragment,r),s=!1},d(r){r&&g(e),te(t)}}}function ff(n){let e=n[5].t("Hello, {{name}}",{name:n[7].name})+"",t;return{c(){t=W(e)},l(l){t=q(l,e)},m(l,s){V(l,t,s)},p(l,s){s&160&&e!==(e=l[5].t("Hello, {{name}}",{name:l[7].name})+"")&&Z(t,e)},d(l){l&&g(t)}}}function uf(n){var l;let e=((l=n[0][n[4]])==null?void 0:l.name)+"",t;return{c(){t=W(e)},l(s){t=q(s,e)},m(s,r){V(s,t,r)},p(s,r){var i;r&17&&e!==(e=((i=s[0][s[4]])==null?void 0:i.name)+"")&&Z(t,e)},d(s){s&&g(t)}}}function cf(n){let e,t=n[5].t("How can I help you today?")+"",l;return{c(){e=M("div"),l=W(t),this.h()},l(s){e=E(s,"DIV",{class:!0});var r=w(e);l=q(r,t),r.forEach(g),this.h()},h(){h(e,"class","font-medium text-gray-400 dark:text-gray-500 line-clamp-1 font-p")},m(s,r){V(s,e,r),p(e,l)},p(s,r){r&32&&t!==(t=s[5].t("How can I help you today?")+"")&&Z(l,t)},d(s){s&&g(e)}}}function df(n){var o,a,f,u,c,m;let e,t,l=Ht.parse(vt((f=(a=(o=n[0][n[4]])==null?void 0:o.info)==null?void 0:a.meta)==null?void 0:f.description))+"",s,r,i=((m=(c=(u=n[0][n[4]])==null?void 0:u.info)==null?void 0:c.meta)==null?void 0:m.user)&&_n(n);return{c(){e=M("div"),t=new fr(!1),s=j(),i&&i.c(),r=ce(),this.h()},l(d){e=E(d,"DIV",{class:!0});var _=w(e);t=ur(_,!1),_.forEach(g),s=A(d),i&&i.l(d),r=ce(),this.h()},h(){t.a=null,h(e,"class","mt-0.5 text-base font-normal text-gray-500 dark:text-gray-400 line-clamp-3 markdown")},m(d,_){V(d,e,_),t.m(l,e),V(d,s,_),i&&i.m(d,_),V(d,r,_)},p(d,_){var k,v,N,y,T,P;_&17&&l!==(l=Ht.parse(vt((N=(v=(k=d[0][d[4]])==null?void 0:k.info)==null?void 0:v.meta)==null?void 0:N.description))+"")&&t.p(l),(P=(T=(y=d[0][d[4]])==null?void 0:y.info)==null?void 0:T.meta)!=null&&P.user?i?i.p(d,_):(i=_n(d),i.c(),i.m(r.parentNode,r)):i&&(i.d(1),i=null)},d(d){d&&(g(e),g(s),g(r)),i&&i.d(d)}}}function _n(n){let e,t;function l(i,o){var a,f,u;return(u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)!=null&&u.user.community?mf:hf}let s=l(n),r=s(n);return{c(){e=M("div"),t=W(`By
								`),r.c(),this.h()},l(i){e=E(i,"DIV",{class:!0});var o=w(e);t=q(o,`By
								`),r.l(o),o.forEach(g),this.h()},h(){h(e,"class","mt-0.5 text-sm font-normal text-gray-400 dark:text-gray-500")},m(i,o){V(i,e,o),p(e,t),r.m(e,null)},p(i,o){s===(s=l(i))&&r?r.p(i,o):(r.d(1),r=s(i),r&&(r.c(),r.m(e,null)))},d(i){i&&g(e),r.d()}}}function hf(n){var l,s,r;let e=((r=(s=(l=n[0][n[4]])==null?void 0:l.info)==null?void 0:s.meta)==null?void 0:r.user.name)+"",t;return{c(){t=W(e)},l(i){t=q(i,e)},m(i,o){V(i,t,o)},p(i,o){var a,f,u;o&17&&e!==(e=((u=(f=(a=i[0][i[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name)+"")&&Z(t,e)},d(i){i&&g(t)}}}function mf(n){var r,i,o,a,f,u,c,m,d;let e,t=((o=(i=(r=n[0][n[4]])==null?void 0:r.info)==null?void 0:i.meta)!=null&&o.user.name?(u=(f=(a=n[0][n[4]])==null?void 0:a.info)==null?void 0:f.meta)==null?void 0:u.user.name:`@${(d=(m=(c=n[0][n[4]])==null?void 0:c.info)==null?void 0:m.meta)==null?void 0:d.user.username}`)+"",l,s;return{c(){e=M("a"),l=W(t),this.h()},l(_){e=E(_,"A",{href:!0});var k=w(e);l=q(k,t),k.forEach(g),this.h()},h(){var _,k,v;h(e,"href",s="https://openwebui.com/m/"+((v=(k=(_=n[0][n[4]])==null?void 0:_.info)==null?void 0:k.meta)==null?void 0:v.user.username))},m(_,k){V(_,e,k),p(e,l)},p(_,k){var v,N,y,T,P,R,I,B,S,L,C,O;k&17&&t!==(t=((y=(N=(v=_[0][_[4]])==null?void 0:v.info)==null?void 0:N.meta)!=null&&y.user.name?(R=(P=(T=_[0][_[4]])==null?void 0:T.info)==null?void 0:P.meta)==null?void 0:R.user.name:`@${(S=(B=(I=_[0][_[4]])==null?void 0:I.info)==null?void 0:B.meta)==null?void 0:S.user.username}`)+"")&&Z(l,t),k&17&&s!==(s="https://openwebui.com/m/"+((O=(C=(L=_[0][_[4]])==null?void 0:L.info)==null?void 0:C.meta)==null?void 0:O.user.username))&&h(e,"href",s)},d(_){_&&g(e)}}}function pn(n){var le,me,ie,se,_e,ge,Ie;let e,t,l,s,r,i,o,a,f,u,c,m,d,_,k,v,N,y,T=De(n[0]),P=[];for(let Q=0;Q<T.length;Q+=1)P[Q]=mn(hn(n,T,Q));const R=Q=>D(P[Q],1,1,()=>{P[Q]=null});let I=n[6]&&gn(n);function B(Q,J){var oe;return(oe=Q[0][Q[4]])!=null&&oe.name?uf:ff}let S=B(n),L=S(n);function C(Q,J){var oe,ye,U;return((U=(ye=(oe=Q[0][Q[4]])==null?void 0:oe.info)==null?void 0:ye.meta)==null?void 0:U.description)??null?df:cf}let O=C(n),z=O(n);return v=new rf({props:{className:"grid grid-cols-2",suggestionPrompts:((ie=(me=(le=n[1])==null?void 0:le.info)==null?void 0:me.meta)==null?void 0:ie.suggestion_prompts)??((ge=(_e=(se=n[0][n[4]])==null?void 0:se.info)==null?void 0:_e.meta)==null?void 0:ge.suggestion_prompts)??((Ie=n[8])==null?void 0:Ie.default_prompt_suggestions)??[]}}),v.$on("select",n[13]),{c(){e=M("div"),t=M("div"),l=M("div");for(let Q=0;Q<P.length;Q+=1)P[Q].c();r=j(),I&&I.c(),i=j(),o=M("div"),a=M("div"),f=M("div"),L.c(),c=j(),m=M("div"),z.c(),_=j(),k=M("div"),$(v.$$.fragment),this.h()},l(Q){e=E(Q,"DIV",{class:!0});var J=w(e);t=E(J,"DIV",{class:!0});var oe=w(t);l=E(oe,"DIV",{class:!0});var ye=w(l);for(let H=0;H<P.length;H+=1)P[H].l(ye);ye.forEach(g),oe.forEach(g),r=A(J),I&&I.l(J),i=A(J),o=E(J,"DIV",{class:!0});var U=w(o);a=E(U,"DIV",{});var fe=w(a);f=E(fe,"DIV",{class:!0});var de=w(f);L.l(de),de.forEach(g),c=A(fe),m=E(fe,"DIV",{});var he=w(m);z.l(he),he.forEach(g),fe.forEach(g),U.forEach(g),_=A(J),k=E(J,"DIV",{class:!0});var be=w(k);x(v.$$.fragment,be),be.forEach(g),J.forEach(g),this.h()},h(){h(l,"class","flex -space-x-4 mb-0.5"),h(t,"class","flex justify-start"),h(f,"class","capitalize line-clamp-1"),h(o,"class","mt-2 mb-4 text-3xl text-gray-800 dark:text-gray-100 font-medium text-left flex items-center gap-4 font-primary"),h(k,"class","w-full font-primary"),h(e,"class","m-auto w-full max-w-6xl px-8 lg:px-20")},m(Q,J){V(Q,e,J),p(e,t),p(t,l);for(let oe=0;oe<P.length;oe+=1)P[oe]&&P[oe].m(l,null);p(e,r),I&&I.m(e,null),p(e,i),p(e,o),p(o,a),p(a,f),L.m(f,null),p(a,c),p(a,m),z.m(m,null),p(e,_),p(e,k),ee(v,k,null),y=!0},p(Q,J){var ye,U,fe,de,he,be,H;if(J&49){T=De(Q[0]);let K;for(K=0;K<T.length;K+=1){const Y=hn(Q,T,K);P[K]?(P[K].p(Y,J),b(P[K],1)):(P[K]=mn(Y),P[K].c(),b(P[K],1),P[K].m(l,null))}for(ne(),K=T.length;K<P.length;K+=1)R(K);re()}Q[6]?I?J&64&&b(I,1):(I=gn(Q),I.c(),b(I,1),I.m(e,i)):I&&(ne(),D(I,1,1,()=>{I=null}),re()),S===(S=B(Q))&&L?L.p(Q,J):(L.d(1),L=S(Q),L&&(L.c(),L.m(f,null))),O===(O=C(Q))&&z?z.p(Q,J):(z.d(1),z=O(Q),z&&(z.c(),z.m(m,null)));const oe={};J&275&&(oe.suggestionPrompts=((fe=(U=(ye=Q[1])==null?void 0:ye.info)==null?void 0:U.meta)==null?void 0:fe.suggestion_prompts)??((be=(he=(de=Q[0][Q[4]])==null?void 0:de.info)==null?void 0:he.meta)==null?void 0:be.suggestion_prompts)??((H=Q[8])==null?void 0:H.default_prompt_suggestions)??[]),v.$set(oe)},i(Q){if(!y){for(let J=0;J<T.length;J+=1)b(P[J]);Q&&(s||Tt(()=>{s=Bt(l,Rt,{duration:200}),s.start()})),b(I),Q&&(u||Tt(()=>{u=Bt(f,Rt,{duration:200}),u.start()})),Q&&(d||Tt(()=>{d=Bt(m,Rt,{duration:200,delay:200}),d.start()})),b(v.$$.fragment,Q),Q&&(N||Tt(()=>{N=Bt(k,Rt,{duration:200,delay:300}),N.start()})),y=!0}},o(Q){P=P.filter(Boolean);for(let J=0;J<P.length;J+=1)D(P[J]);D(I),D(v.$$.fragment,Q),y=!1},d(Q){Q&&g(e),qe(P,Q),I&&I.d(),L.d(),z.d(),te(v)}}}function gf(n){let e=n[3],t,l,s=pn(n);return{c(){s.c(),t=ce()},l(r){s.l(r),t=ce()},m(r,i){s.m(r,i),V(r,t,i),l=!0},p(r,[i]){i&8&&Te(e,e=r[3])?(ne(),D(s,1,1,ve),re(),s=pn(r),s.c(),b(s,1),s.m(t.parentNode,t)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(t),s.d(r)}}}function _f(n,e,t){let l,s,r,i,o;Ee(n,jt,N=>t(11,l=N)),Ee(n,Zt,N=>t(6,r=N)),Ee(n,zt,N=>t(7,i=N)),Ee(n,En,N=>t(8,o=N));const a=Fe("i18n");Ee(n,a,N=>t(5,s=N));let{modelIds:f=[]}=e,{models:u=[]}=e,{atSelectedModel:c}=e,{submitPrompt:m}=e,d=!1,_=0;bt(()=>{t(3,d=!0)});const k=N=>{t(4,_=N)},v=N=>{m(N.detail)};return n.$$set=N=>{"modelIds"in N&&t(10,f=N.modelIds),"models"in N&&t(0,u=N.models),"atSelectedModel"in N&&t(1,c=N.atSelectedModel),"submitPrompt"in N&&t(2,m=N.submitPrompt)},n.$$.update=()=>{n.$$.dirty&3072&&t(0,u=f.map(N=>l.find(y=>y.id===N))),n.$$.dirty&1025&&f.length>0&&t(4,_=u.length-1)},[u,c,m,d,_,s,r,i,o,a,f,l,k,v]}class pf extends Le{constructor(e){super(),Pe(this,e,_f,gf,Te,{modelIds:10,models:0,atSelectedModel:1,submitPrompt:2})}}function vn(n,e,t){const l=n.slice();return l[43]=e[t],l[45]=t,l}function vf(n){let e,t=n[3],l,s=yn(n);return{c(){e=M("div"),s.c(),this.h()},l(r){e=E(r,"DIV",{class:!0});var i=w(e);s.l(i),i.forEach(g),this.h()},h(){h(e,"class","w-full pt-2")},m(r,i){V(r,e,i),s.m(e,null),l=!0},p(r,i){i[0]&8&&Te(t,t=r[3])?(ne(),D(s,1,1,ve),re(),s=yn(r),s.c(),b(s,1),s.m(e,null)):s.p(r,i)},i(r){l||(b(s),l=!0)},o(r){D(s),l=!1},d(r){r&&g(e),s.d(r)}}}function bf(n){let e,t;return e=new pf({props:{modelIds:n[5],atSelectedModel:n[6],submitPrompt:n[34]}}),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[0]&32&&(r.modelIds=l[5]),s[0]&64&&(r.atSelectedModel=l[6]),s[0]&65538&&(r.submitPrompt=l[34]),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function bn(n){let e,t;return e=new Pr({props:{$$slots:{default:[kf]},$$scope:{ctx:n}}}),e.$on("visible",n[35]),{c(){$(e.$$.fragment)},l(l){x(e.$$.fragment,l)},m(l,s){ee(e,l,s),t=!0},p(l,s){const r={};s[1]&32768&&(r.$$scope={dirty:s,ctx:l}),e.$set(r)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){D(e.$$.fragment,l),t=!1},d(l){te(e,l)}}}function kf(n){let e,t,l,s,r="Loading...",i;return t=new Ut({props:{className:" size-4"}}),{c(){e=M("div"),$(t.$$.fragment),l=j(),s=M("div"),s.textContent=r,this.h()},l(o){e=E(o,"DIV",{class:!0});var a=w(e);x(t.$$.fragment,a),l=A(a),s=E(a,"DIV",{class:!0,"data-svelte-h":!0}),Ue(s)!=="svelte-17uns3n"&&(s.textContent=r),a.forEach(g),this.h()},h(){h(s,"class",""),h(e,"class","w-full flex justify-center py-1 text-xs animate-pulse items-center gap-2")},m(o,a){V(o,e,a),ee(t,e,null),p(e,l),p(e,s),i=!0},p:ve,i(o){i||(b(t.$$.fragment,o),i=!0)},o(o){D(t.$$.fragment,o),i=!1},d(o){o&&g(e),te(t)}}}function kn(n,e){let t,l,s,r;function i(a){e[36](a)}let o={chatId:e[3],messageId:e[43].id,idx:e[45],user:e[4],gotoMessage:e[20],showPreviousMessage:e[21],showNextMessage:e[22],updateChat:e[19],editMessage:e[24],deleteMessage:e[27],rateMessage:e[23],actionMessage:e[25],saveMessage:e[26],submitMessage:e[10],regenerateResponse:e[8],continueResponse:e[7],mergeResponses:e[9],addMessages:e[11],triggerScroll:e[28],readOnly:e[12]};return e[0]!==void 0&&(o.history=e[0]),l=new Xa({props:o}),Ae.push(()=>Ke(l,"history",i)),{key:n,first:null,c(){t=ce(),$(l.$$.fragment),this.h()},l(a){t=ce(),x(l.$$.fragment,a),this.h()},h(){this.first=t},m(a,f){V(a,t,f),ee(l,a,f),r=!0},p(a,f){e=a;const u={};f[0]&8&&(u.chatId=e[3]),f[0]&16384&&(u.messageId=e[43].id),f[0]&16384&&(u.idx=e[45]),f[0]&16&&(u.user=e[4]),f[0]&1024&&(u.submitMessage=e[10]),f[0]&256&&(u.regenerateResponse=e[8]),f[0]&128&&(u.continueResponse=e[7]),f[0]&512&&(u.mergeResponses=e[9]),f[0]&2048&&(u.addMessages=e[11]),f[0]&4096&&(u.readOnly=e[12]),!s&&f[0]&1&&(s=!0,u.history=e[0],Ze(()=>s=!1)),l.$set(u)},i(a){r||(b(l.$$.fragment,a),r=!0)},o(a){D(l.$$.fragment,a),r=!1},d(a){a&&g(t),te(l,a)}}}function wn(n){let e;return{c(){e=M("div"),this.h()},l(t){e=E(t,"DIV",{class:!0}),w(e).forEach(g),this.h()},h(){h(e,"class","pb-6")},m(t,l){V(t,e,l)},d(t){t&&g(e)}}}function yn(n){var k;let e,t=((k=n[14].at(0))==null?void 0:k.parentId)!==null,l,s=[],r=new Map,i,o,a,f,u,c=t&&bn(n),m=De(n[14]);const d=v=>v[43].id;for(let v=0;v<m.length;v+=1){let N=vn(n,m,v),y=d(N);r.set(y,s[v]=kn(y,N))}let _=n[13]&&wn();return{c(){e=M("div"),c&&c.c(),l=j();for(let v=0;v<s.length;v+=1)s[v].c();i=j(),o=M("div"),a=j(),_&&_.c(),f=ce(),this.h()},l(v){e=E(v,"DIV",{class:!0});var N=w(e);c&&c.l(N),l=A(N);for(let y=0;y<s.length;y+=1)s[y].l(N);N.forEach(g),i=A(v),o=E(v,"DIV",{class:!0}),w(o).forEach(g),a=A(v),_&&_.l(v),f=ce(),this.h()},h(){h(e,"class","w-full"),h(o,"class","pb-12")},m(v,N){V(v,e,N),c&&c.m(e,null),p(e,l);for(let y=0;y<s.length;y+=1)s[y]&&s[y].m(e,null);V(v,i,N),V(v,o,N),V(v,a,N),_&&_.m(v,N),V(v,f,N),u=!0},p(v,N){var y;N[0]&16384&&(t=((y=v[14].at(0))==null?void 0:y.parentId)!==null),t?c?(c.p(v,N),N[0]&16384&&b(c,1)):(c=bn(v),c.c(),b(c,1),c.m(e,l)):c&&(ne(),D(c,1,1,()=>{c=null}),re()),N[0]&536371097&&(m=De(v[14]),ne(),s=Gt(s,N,d,1,v,m,r,e,In,kn,null,vn),re()),v[13]?_||(_=wn(),_.c(),_.m(f.parentNode,f)):_&&(_.d(1),_=null)},i(v){if(!u){b(c);for(let N=0;N<m.length;N+=1)b(s[N]);u=!0}},o(v){D(c);for(let N=0;N<s.length;N+=1)D(s[N]);u=!1},d(v){v&&(g(e),g(i),g(o),g(a),g(f)),c&&c.d();for(let N=0;N<s.length;N+=1)s[N].d();_&&_.d(v)}}}function wf(n){let e,t,l,s,r;const i=[bf,vf],o=[];function a(f,u){var c;return u[0]&1&&(t=null),t==null&&(t=Object.keys(((c=f[0])==null?void 0:c.messages)??{}).length==0),t?0:1}return l=a(n,[-1,-1]),s=o[l]=i[l](n),{c(){e=M("div"),s.c(),this.h()},l(f){e=E(f,"DIV",{class:!0});var u=w(e);s.l(u),u.forEach(g),this.h()},h(){h(e,"class",n[2])},m(f,u){V(f,e,u),o[l].m(e,null),r=!0},p(f,u){let c=l;l=a(f,u),l===c?o[l].p(f,u):(ne(),D(o[c],1,1,()=>{o[c]=null}),re(),s=o[l],s?s.p(f,u):(s=o[l]=i[l](f),s.c()),b(s,1),s.m(e,null)),(!r||u[0]&4)&&h(e,"class",f[2])},i(f){r||(b(s),r=!0)},o(f){D(s),r=!1},d(f){f&&g(e),o[l].d()}}}function yf(n,e,t){let l,s,r,i,o;Ee(n,At,H=>t(37,l=H)),Ee(n,ml,H=>t(38,s=H)),Ee(n,Zt,H=>t(39,r=H)),Ee(n,zt,H=>t(40,i=H)),gt();const a=Fe("i18n");Ee(n,a,H=>t(16,o=H));let{className:f="h-full flex pt-8"}=e,{chatId:u=""}=e,{user:c=i}=e,{prompt:m}=e,{history:d={}}=e,{selectedModels:_}=e,{atSelectedModel:k}=e,v=[],{sendPrompt:N}=e,{continueResponse:y}=e,{regenerateResponse:T}=e,{mergeResponses:P}=e,{chatActionHandler:R}=e,{showMessage:I=()=>{}}=e,{submitMessage:B=()=>{}}=e,{addMessages:S=()=>{}}=e,{readOnly:L=!1}=e,{bottomPadding:C=!1}=e,{autoScroll:O}=e,z=20,le=!1;const me=async()=>{const H=document.getElementById("messages-container");H.scrollTop=H.scrollTop+100,t(15,le=!0),t(33,z+=20),await Ne(),t(15,le=!1)},ie=()=>{const H=document.getElementById("messages-container");H.scrollTop=H.scrollHeight},se=async()=>{r||(t(0,d),await Ne(),await vr(localStorage.token,u,{history:d,messages:v}),ml.set(1),await _r.set(await br(localStorage.token,s)))},_e=async(H,K)=>{let Y;H.parentId!==null?Y=d.messages[H.parentId].childrenIds:Y=Object.values(d.messages).filter(ae=>ae.parentId===null).map(ae=>ae.id),K=Math.max(0,Math.min(K,Y.length-1));let G=Y[K];if(H.id!==G){let ae=d.messages[G].childrenIds;for(;ae.length!==0;)G=ae.at(-1),ae=d.messages[G].childrenIds;t(0,d.currentId=G,d)}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const ae=document.getElementById("messages-container");t(29,O=ae.scrollHeight-ae.scrollTop<=ae.clientHeight+50),setTimeout(()=>{ie()},100)}},ge=async H=>{if(H.parentId!==null){let K=d.messages[H.parentId].childrenIds[Math.max(d.messages[H.parentId].childrenIds.indexOf(H.id)-1,0)];if(H.id!==K){let Y=d.messages[K].childrenIds;for(;Y.length!==0;)K=Y.at(-1),Y=d.messages[K].childrenIds;t(0,d.currentId=K,d)}}else{let K=Object.values(d.messages).filter(G=>G.parentId===null).map(G=>G.id),Y=K[Math.max(K.indexOf(H.id)-1,0)];if(H.id!==Y){let G=d.messages[Y].childrenIds;for(;G.length!==0;)Y=G.at(-1),G=d.messages[Y].childrenIds;t(0,d.currentId=Y,d)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(29,O=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ie()},100)}},Ie=async H=>{if(H.parentId!==null){let K=d.messages[H.parentId].childrenIds[Math.min(d.messages[H.parentId].childrenIds.indexOf(H.id)+1,d.messages[H.parentId].childrenIds.length-1)];if(H.id!==K){let Y=d.messages[K].childrenIds;for(;Y.length!==0;)K=Y.at(-1),Y=d.messages[K].childrenIds;t(0,d.currentId=K,d)}}else{let K=Object.values(d.messages).filter(G=>G.parentId===null).map(G=>G.id),Y=K[Math.min(K.indexOf(H.id)+1,K.length-1)];if(H.id!==Y){let G=d.messages[Y].childrenIds;for(;G.length!==0;)Y=G.at(-1),G=d.messages[Y].childrenIds;t(0,d.currentId=Y,d)}}if(await Ne(),(l==null?void 0:l.scrollOnBranchChange)??!0){const K=document.getElementById("messages-container");t(29,O=K.scrollHeight-K.scrollTop<=K.clientHeight+50),setTimeout(()=>{ie()},100)}},Q=async(H,K)=>{t(0,d.messages[H].annotation={...d.messages[H].annotation,rating:K},d),await se()},J=async(H,K,Y=!0)=>{if(d.messages[H].role==="user")if(Y){let G=K,ae=gl(),pe={id:ae,parentId:d.messages[H].parentId,childrenIds:[],role:"user",content:G,...d.messages[H].files&&{files:d.messages[H].files},models:_,timestamp:Math.floor(Date.now()/1e3)},Ce=d.messages[H].parentId;Ce!==null&&t(0,d.messages[Ce].childrenIds=[...d.messages[Ce].childrenIds,ae],d),t(0,d.messages[ae]=pe,d),t(0,d.currentId=ae,d),await Ne(),await N(d,G,ae)}else t(0,d.messages[H].content=K,d),await se();else if(Y){const G=gl(),ae=d.messages[H],pe=ae.parentId,Ce={...ae,id:G,parentId:pe,childrenIds:[],files:void 0,content:K,timestamp:Math.floor(Date.now()/1e3)};t(0,d.messages[G]=Ce,d),t(0,d.currentId=G,d),pe!==null&&t(0,d.messages[pe].childrenIds=[...d.messages[pe].childrenIds,G],d),await se()}else t(0,d.messages[H].originalContent=d.messages[H].content,d),t(0,d.messages[H].content=K,d),await se()},oe=async(H,K,Y=null)=>{await R(u,H,K.model,K.id,Y)},ye=async(H,K)=>{t(0,d.messages[H]=K,d),await se()},U=async H=>{const K=d.messages[H],Y=K.parentId,G=K.childrenIds??[],ae=G.flatMap(pe=>{var Ce;return((Ce=d.messages[pe])==null?void 0:Ce.childrenIds)??[]});Y&&d.messages[Y]&&t(0,d.messages[Y].childrenIds=[...d.messages[Y].childrenIds.filter(pe=>pe!==H),...ae],d),ae.forEach(pe=>{d.messages[pe]&&t(0,d.messages[pe].parentId=Y,d)}),[H,...G].forEach(pe=>{delete d.messages[pe]}),await Ne(),I({id:Y}),await se()},fe=()=>{if(O){const H=document.getElementById("messages-container");t(29,O=H.scrollHeight-H.scrollTop<=H.clientHeight+50),setTimeout(()=>{ie()},100)}},de=async H=>{let K=H;if(H.includes("{{CLIPBOARD}}")){const G=await navigator.clipboard.readText().catch(ae=>(je.error(o.t("Failed to read clipboard contents")),"{{CLIPBOARD}}"));K=H.replaceAll("{{CLIPBOARD}}",G)}t(1,m=K),await Ne();const Y=document.getElementById("chat-input-container");Y&&(t(1,m=H),Y.style.height="",Y.style.height=Math.min(Y.scrollHeight,200)+"px",Y.focus()),await Ne()},he=H=>{console.log("visible"),le||me()};function be(H){d=H,t(0,d)}return n.$$set=H=>{"className"in H&&t(2,f=H.className),"chatId"in H&&t(3,u=H.chatId),"user"in H&&t(4,c=H.user),"prompt"in H&&t(1,m=H.prompt),"history"in H&&t(0,d=H.history),"selectedModels"in H&&t(5,_=H.selectedModels),"atSelectedModel"in H&&t(6,k=H.atSelectedModel),"sendPrompt"in H&&t(30,N=H.sendPrompt),"continueResponse"in H&&t(7,y=H.continueResponse),"regenerateResponse"in H&&t(8,T=H.regenerateResponse),"mergeResponses"in H&&t(9,P=H.mergeResponses),"chatActionHandler"in H&&t(31,R=H.chatActionHandler),"showMessage"in H&&t(32,I=H.showMessage),"submitMessage"in H&&t(10,B=H.submitMessage),"addMessages"in H&&t(11,S=H.addMessages),"readOnly"in H&&t(12,L=H.readOnly),"bottomPadding"in H&&t(13,C=H.bottomPadding),"autoScroll"in H&&t(29,O=H.autoScroll)},n.$$.update=()=>{if(n.$$.dirty[0]&1|n.$$.dirty[1]&4)if(d.currentId){let H=[],K=d.messages[d.currentId];for(;K&&H.length<=z;)H.unshift({...K}),K=K.parentId!==null?d.messages[K.parentId]:null;t(14,v=H)}else t(14,v=[]);n.$$.dirty[0]&536879104&&O&&C&&(async()=>(await Ne(),ie()))()},[d,m,f,u,c,_,k,y,T,P,B,S,L,C,v,le,o,a,me,se,_e,ge,Ie,Q,J,oe,ye,U,fe,O,N,R,I,z,de,he,be]}class nu extends Le{constructor(e){super(),Pe(this,e,yf,wf,Te,{className:2,chatId:3,user:4,prompt:1,history:0,selectedModels:5,atSelectedModel:6,sendPrompt:30,continueResponse:7,regenerateResponse:8,mergeResponses:9,chatActionHandler:31,showMessage:32,submitMessage:10,addMessages:11,readOnly:12,bottomPadding:13,autoScroll:29},null,[-1,-1])}}export{Ar as K,nu as M,rf as S};
//# sourceMappingURL=B7Y7zPCh.js.map
